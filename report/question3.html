<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>question3</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="question3_files/libs/clipboard/clipboard.min.js"></script>
<script src="question3_files/libs/quarto-html/quarto.js"></script>
<script src="question3_files/libs/quarto-html/popper.min.js"></script>
<script src="question3_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="question3_files/libs/quarto-html/anchor.min.js"></script>
<link href="question3_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="question3_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="question3_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="question3_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="question3_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">



<section id="exploratory-data-analysis" class="level1">
<h1>Exploratory data analysis</h1>
<section id="focus-on-the-influence-of-events-over-the-sdg-scores" class="level2">
<h2 class="anchored" data-anchor-id="focus-on-the-influence-of-events-over-the-sdg-scores">Focus on the influence of events over the SDG scores</h2>
<p>In order to have an overview of the relationship between the different events variables and the SDG overall score, we make several graphs containing the Pearson correlation coefficient between the variable, the scatter plots describing the relationship between the variables, as well as the distribution of each variable.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>lower.panel <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, ...){</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>   <span class="fu">points</span>(x, y, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">col =</span> <span class="st">"darkgreen"</span>, <span class="at">cex =</span> <span class="fl">0.2</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a> panel.hist <span class="ot">&lt;-</span> <span class="cf">function</span>(x, ...){</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>   usr <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="st">"usr"</span>); <span class="fu">on.exit</span>(<span class="fu">par</span>(usr))</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>   <span class="fu">par</span>(<span class="at">usr =</span> <span class="fu">c</span>(usr[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="dv">0</span>, <span class="fl">1.5</span>) )</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>   h <span class="ot">&lt;-</span> <span class="fu">hist</span>(x, <span class="at">plot =</span> <span class="cn">FALSE</span>)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>   breaks <span class="ot">&lt;-</span> h<span class="sc">$</span>breaks; nB <span class="ot">&lt;-</span> <span class="fu">length</span>(breaks)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>   y <span class="ot">&lt;-</span> h<span class="sc">$</span>counts; y <span class="ot">&lt;-</span> y<span class="sc">/</span><span class="fu">max</span>(y)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>   <span class="fu">rect</span>(breaks[<span class="sc">-</span>nB], <span class="dv">0</span>, breaks[<span class="sc">-</span><span class="dv">1</span>], y, <span class="at">col =</span> <span class="st">"lightgreen"</span>, ...)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a> }</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a> <span class="co"># panel.cor_stars function with stars alongside correlation coefficients</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a> panel.cor_stars <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, <span class="at">digits =</span> <span class="dv">2</span>, <span class="at">prefix =</span> <span class="st">""</span>, cex.cor, ...) {</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>   usr <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="st">"usr"</span>); <span class="fu">on.exit</span>(<span class="fu">par</span>(usr))</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>   <span class="fu">par</span>(<span class="at">usr =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>   r <span class="ot">&lt;-</span> <span class="fu">cor</span>(x, y)</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>   p_value <span class="ot">&lt;-</span> <span class="fu">cor.test</span> (x,y)<span class="sc">$</span>p.value</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>   <span class="cf">if</span> (p_value <span class="sc">&lt;</span> <span class="fl">0.001</span>){</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>     stars <span class="ot">&lt;-</span> <span class="st">"***"</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>   } <span class="cf">else</span> <span class="cf">if</span> (p_value <span class="sc">&lt;</span> <span class="fl">0.01</span>) {</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>     stars <span class="ot">&lt;-</span> <span class="st">"**"</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>   } <span class="cf">else</span> <span class="cf">if</span> (p_value <span class="sc">&lt;</span> <span class="fl">0.05</span>) {</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>     stars <span class="ot">&lt;-</span> <span class="st">"*"</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>   } <span class="cf">else</span> {</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>     stars <span class="ot">&lt;-</span> <span class="st">""</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>   }</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>   txt <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="fu">format</span>(<span class="fu">c</span>(r, <span class="fl">0.123456789</span>), <span class="at">digits =</span> digits)[<span class="dv">1</span>], <span class="st">" "</span>, stars)</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>   <span class="cf">if</span>(<span class="fu">missing</span>(cex.cor)) cex.cor <span class="ot">&lt;-</span> <span class="fl">0.5</span><span class="sc">/</span><span class="fu">strwidth</span>(txt)</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>   <span class="fu">text</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>, txt, <span class="at">cex =</span> cex.cor)</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a> }</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(data_question3_1[, <span class="fu">c</span>(<span class="st">"overallscore"</span>, <span class="st">"total_affected"</span>, <span class="st">"total_deaths"</span>)], <span class="at">upper.panel =</span> panel.cor_stars,<span class="at">diag.panel =</span> panel.hist,<span class="at">lower.panel =</span> lower.panel, <span class="at">main =</span> <span class="st">"Correlation table and distribution of Disaster variables"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="question3_files/figure-html/unnamed-chunk-1-1.png" style="width:100.0%;height:100.0%" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Meaning of the stars: *** : p_value &lt; 0.001; ** : p_value &lt; 0.01; *: p_value &lt;0.05; no star if p_value is higher.</p>
<p>The different variables used to materialize the impact of climate disasters do not seem to have important influence on the overall score. Indeed, the overallscore and total_affected have a correlation coefficient that suggests a very weak negative linear relationship between this variables and which is not statistically significant (p ≥ 0.05), and the overallscore and total_deaths have a correlation that also indicates a weak negative linear relationship that is statistically significant at p &lt; 0.05. But we will further explore for the different SDGs, since we believe that such disasters have a specific influence on some SDGs.</p>
<div class="cell" data-layout-align="center" data-hash="question3_cache/html/unnamed-chunk-2_2d7a811a8d18613ee4a0535242fd965a">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(data_question3_2[,<span class="fu">c</span>(<span class="st">"overallscore"</span>, <span class="st">"cases_per_million"</span>, <span class="st">"deaths_per_million"</span>, <span class="st">"stringency"</span>)], <span class="at">upper.panel =</span> panel.cor_stars, <span class="at">diag.panel=</span>panel.hist, <span class="at">lower.panel =</span> lower.panel,<span class="at">main=</span><span class="st">"Correlation table and distribution of COVID variables"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="question3_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>Meaning of the stars: *** : p_value &lt; 0.001; ** : p_value &lt; 0.01; *: p_value &lt;0.05; no star if p_value is higher.</p>
<p>The different variables used to materialize the impact of COVID19 do not seem to have important influence on the overall score, we can see that Overallscore and cases_per_million/deaths_per_million/stringency have a correlation coefficient indicating a weak positive linear relationship that is highly statistically significant at p &lt; 0.001. But we will further explore for the different SDGs, since we believe that COVID19 had a specific influence on some SDGs, for instance “good health and well-being” or “decent work and economic growth”.</p>
<p>Concerning the correlation effect between the COVID19 variables, we could have no surprises, Cases_per_million and deaths_per_million have a moderate to strong positive correlation suggesting a stronger relationship where an increase in the number of COVID-19 cases per million is associated with a substantial increase in the number of deaths per million. This indicates a significant correlation between case prevalence and mortality rate. Cases_per_million and stringency have a moderate positive correlation indicates that higher levels of cases per million are associated with slightly higher severity of health measures. This could mean that in regions where cases are more numerous, stricter sanitary measures can be put in place to control the spread of the virus. Finally, Deaths_per_million and stringency have a strong positive correlation indicating a robust relationship where higher mortality rates are associated with higher severity of sanitary measures. This suggest that in areas where deaths are higher, stricter sanitary measures are applied in an attempt to reduce the spread of the virus and mortality.</p>
<div class="cell" data-layout-align="center" data-hash="question3_cache/html/unnamed-chunk-3_b09e589d088d798b23ef886c38206b11">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(data_question3_3[,<span class="fu">c</span>(<span class="st">"overallscore"</span>, <span class="st">"ongoing"</span>, <span class="st">"sum_deaths"</span>, <span class="st">"pop_affected"</span>, <span class="st">"area_affected"</span>, <span class="st">"maxintensity"</span>)], <span class="at">upper.panel =</span> panel.cor_stars, <span class="at">diag.panel=</span>panel.hist, <span class="at">lower.panel =</span> lower.panel, <span class="at">main=</span><span class="st">"Correlation table and distribution of conflicts variables"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="question3_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>Meaning of the stars: *** : p_value &lt; 0.001; ** : p_value &lt; 0.01; *: p_value &lt;0.05; no star if p_value is higher.</p>
<p>Negative values (ranging from -0.17 to -0.28) with three stars (***) indicate a strong and statistically significant negative correlation between the overall index (Overallscore) and the various conflict-related variables (Ongoing, sum_deaths, pop_affected, area_affected, maxintensity). A strong negative correlation means that an increase in the Overallscore is associated with a decrease in the values of the other variables. But we have to take into account that correlation does not necessarily imply direct causation. Further analysis may be required to understand in depth the nature of the relationships between these variables.</p>
<p>To explore our data on events such as disasters, covid-19 and conflicts we have to first see which countries are the most touched by these. To do so, we made time-series analysis on this three events each time depending on different variables.</p>
<div class="cell" data-layout-align="center" data-hash="question3_cache/html/unnamed-chunk-4_6141bd243ec7b0a085f85244e354021f">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Converted 'year' column to date format</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>Q3<span class="fl">.1</span><span class="sc">$</span>year <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="fu">as.character</span>(Q3<span class="fl">.1</span><span class="sc">$</span>year), <span class="at">format =</span> <span class="st">"%Y"</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>Q3<span class="fl">.2</span><span class="sc">$</span>year <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="fu">as.character</span>(Q3<span class="fl">.2</span><span class="sc">$</span>year), <span class="at">format =</span> <span class="st">"%Y"</span>)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>Q3<span class="fl">.3</span><span class="sc">$</span>year <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="fu">as.character</span>(Q3<span class="fl">.3</span><span class="sc">$</span>year), <span class="at">format =</span> <span class="st">"%Y"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>These is our time-analysis concerning the COVID-19 cases per million by region between end 2018 and 2022.</p>
<div class="cell" data-layout-align="center" data-hash="question3_cache/html/unnamed-chunk-5_75d1f5b4af19fa13ac9a44a705154fd8">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>covid_filtered <span class="ot">&lt;-</span> Q3<span class="fl">.2</span>[Q3<span class="fl">.2</span><span class="sc">$</span>year <span class="sc">&gt;=</span> <span class="fu">as.Date</span>(<span class="st">"2018-12-12"</span>), ]</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> covid_filtered, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> cases_per_million, <span class="at">group =</span> region, <span class="at">color =</span> region)) <span class="sc">+</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"loess"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">span =</span> <span class="fl">0.8</span>, <span class="at">size =</span> <span class="fl">0.6</span>) <span class="sc">+</span> </span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Year"</span>, <span class="at">y =</span> <span class="st">"Cases per Million"</span>) <span class="sc">+</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> region, <span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">strip.position =</span> <span class="st">"top"</span>) <span class="sc">+</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> <span class="cf">function</span>(x) <span class="fu">format</span>(x, <span class="at">scientific =</span> <span class="cn">FALSE</span>)) <span class="sc">+</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">size =</span> <span class="dv">8</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">8</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.spacing =</span> <span class="fu">unit</span>(<span class="dv">1</span>, <span class="st">"lines"</span>),</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"none"</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Trend of COVID-19 Cases per Million Over Time"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="question3_files/figure-html/unnamed-chunk-5-1.png" style="width:100.0%;height:100.0%" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>These is our time-analysis concerning the COVID-19 deaths per million per region between end 2018 and 2022</p>
<div class="cell" data-layout-align="center" data-hash="question3_cache/html/unnamed-chunk-6_6fc6b24f9bb3222c209dc3cf3096f8fc">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> covid_filtered, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> deaths_per_million, <span class="at">group =</span> region, <span class="at">color =</span> region)) <span class="sc">+</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"loess"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">span =</span> <span class="fl">0.8</span>, <span class="at">size =</span> <span class="fl">0.6</span>) <span class="sc">+</span> </span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Year"</span>, <span class="at">y =</span> <span class="st">"Deaths per Million"</span>) <span class="sc">+</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> region, <span class="at">nrow =</span> <span class="dv">5</span>, <span class="at">strip.position =</span> <span class="st">"top"</span>) <span class="sc">+</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">size =</span> <span class="dv">8</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">8</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.spacing =</span> <span class="fu">unit</span>(<span class="fl">0.5</span>, <span class="st">"lines"</span>),</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"none"</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Trend of COVID-19 Deaths per Million Over Time"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="question3_files/figure-html/unnamed-chunk-6-1.png" style="width:100.0%;height:100.0%" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>These is our time-analysis concerning the COVID-19 stringency per region between end 2018 and 2022</p>
<div class="cell" data-layout-align="center" data-hash="question3_cache/html/unnamed-chunk-7_a61fdcb01fdf457bc030c5c6cdcfd40f">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> covid_filtered, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> stringency, <span class="at">group =</span> region, <span class="at">color =</span> region)) <span class="sc">+</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"loess"</span>,  <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">span =</span> <span class="fl">0.7</span>, <span class="at">size =</span> <span class="fl">0.6</span>) <span class="sc">+</span> </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Year"</span>, <span class="at">y =</span> <span class="st">"Stringency"</span>) <span class="sc">+</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> region, <span class="at">nrow =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">size =</span> <span class="dv">8</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">8</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.spacing =</span> <span class="fu">unit</span>(<span class="fl">0.5</span>, <span class="st">"lines"</span>),</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"none"</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Trend of COVID-19 Stringency Over Time"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="question3_files/figure-html/unnamed-chunk-7-1.png" style="width:100.0%;height:100.0%" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>These is our time-analysis concerning climatic disasters with total affected per region</p>
<div class="cell" data-layout-align="center" data-hash="question3_cache/html/unnamed-chunk-8_d8ca3352aac38a376311a49bbbe525d8">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>Q3<span class="fl">.1</span>[<span class="fu">is.na</span>(Q3<span class="fl">.1</span>)] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> Q3<span class="fl">.1</span>, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> total_affected, <span class="at">group =</span> region, <span class="at">color =</span> region)) <span class="sc">+</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"loess"</span>,  <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">span =</span> <span class="fl">0.7</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Year"</span>, <span class="at">y =</span> <span class="st">"Total Affected"</span>) <span class="sc">+</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> region, <span class="at">nrow =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> <span class="cf">function</span>(x) <span class="fu">format</span>(x, <span class="at">scientific =</span> <span class="cn">FALSE</span>)) <span class="sc">+</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">size =</span> <span class="dv">8</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">8</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.spacing =</span> <span class="fu">unit</span>(<span class="fl">0.5</span>, <span class="st">"lines"</span>),</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"none"</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Trend of Total Affected from Climatic Disasters Over Time"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="question3_files/figure-html/unnamed-chunk-8-1.png" style="width:100.0%;height:100.0%" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>These is our time-analysis concerning conflicts deaths per region between 2000 and 2016</p>
<div class="cell" data-layout-align="center" data-hash="question3_cache/html/unnamed-chunk-9_a2b05808ca3492f355f3d38fcb260d14">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>conflicts_filtered <span class="ot">&lt;-</span> Q3<span class="fl">.3</span>[Q3<span class="fl">.3</span><span class="sc">$</span>year <span class="sc">&gt;=</span> <span class="fu">as.Date</span>(<span class="st">"2000-01-01"</span>) <span class="sc">&amp;</span> Q3<span class="fl">.3</span><span class="sc">$</span>year <span class="sc">&lt;=</span> <span class="fu">as.Date</span>(<span class="st">"2016-12-31"</span>), ]</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> conflicts_filtered, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> sum_deaths, <span class="at">group =</span> region, <span class="at">color =</span> region)) <span class="sc">+</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"loess"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">span =</span> <span class="fl">0.3</span>, <span class="at">size =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Year"</span>, <span class="at">y =</span> <span class="st">"Sum 0f Deaths"</span>) <span class="sc">+</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> region, <span class="at">nrow =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">size =</span> <span class="dv">8</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">8</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.spacing =</span> <span class="fu">unit</span>(<span class="fl">0.5</span>, <span class="st">"lines"</span>),</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"none"</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Trend of Deaths by Conflicts Over Time"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="question3_files/figure-html/unnamed-chunk-9-1.png" style="width:100.0%;height:100.0%" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>We can see that the regions’ the most affected by the conflicts are : Middle east and north Africa, Sub-Saharan Africa, South Asia, then less America &amp; the Caribbean and Eastern Europe</p>
<p>These is our time-analysis concerning conflicts affected population per region between 2000 and 2016</p>
<div class="cell" data-layout-align="center" data-hash="question3_cache/html/unnamed-chunk-10_f1f80851bebd6199f59fc951d12a1fa5">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> conflicts_filtered, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> pop_affected, <span class="at">group =</span> region, <span class="at">color =</span> region)) <span class="sc">+</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"loess"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">span =</span> <span class="fl">0.3</span>, <span class="at">size =</span> <span class="fl">0.6</span>) <span class="sc">+</span> </span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Year"</span>, <span class="at">y =</span> <span class="st">"Population affected"</span>) <span class="sc">+</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> region, <span class="at">nrow =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">size =</span> <span class="dv">8</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">8</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.spacing =</span> <span class="fu">unit</span>(<span class="fl">0.5</span>, <span class="st">"lines"</span>),</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"none"</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Trend of Population Affected by Conflicts Over Time"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="question3_files/figure-html/unnamed-chunk-10-1.png" style="width:100.0%;height:100.0%" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>We can see that the regions’ the most affected by the conflicts are : Middle east and north Africa, Sub-Saharan Africa, South Asia, America &amp; the Caribbean, Eastern Europe and sometimes Caucasus and Central Asia</p>
<p>Now that we could visualize which regions are the most impacted by these three events we can do correlations analysis per region to see if this events have indeed an impact on the evolution of SDG goals.</p>
<p>Here we want to analyse the correlation between the climate disasters and the SDG goals in South and East Asia.</p>
<div class="cell" data-layout-align="center" data-hash="question3_cache/html/unnamed-chunk-11_30e4a97e1f52c6cb9aac419f6e6d6f9e">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>Q3<span class="fl">.1</span>[<span class="fu">is.na</span>(Q3<span class="fl">.1</span>)] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>selected_regions <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"South Asia"</span>, <span class="st">"East Asia"</span>, <span class="st">"North America"</span>)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>disaster_selected <span class="ot">&lt;-</span> Q3<span class="fl">.1</span>[Q3<span class="fl">.3</span><span class="sc">$</span>region <span class="sc">%in%</span> selected_regions, ]</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>relevant_columns <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"goal1"</span>, <span class="st">"goal2"</span>, <span class="st">"goal3"</span>, <span class="st">"goal4"</span>, <span class="st">"goal5"</span>, <span class="st">"goal6"</span>, <span class="st">"goal7"</span>, <span class="st">"goal8"</span>, <span class="st">"goal9"</span>, <span class="st">"goal10"</span>, <span class="st">"goal11"</span>, <span class="st">"goal12"</span>, <span class="st">"goal13"</span>, <span class="st">"goal15"</span>, <span class="st">"goal16"</span>, <span class="st">"total_affected"</span>, <span class="st">"no_homeless"</span>)</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>correlation_matrix_disaster <span class="ot">&lt;-</span> <span class="fu">cor</span>(disaster_selected[, relevant_columns], <span class="at">use =</span> <span class="st">"complete.obs"</span>)</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(correlation_matrix_disaster)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">goal1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">goal2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">goal3</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">goal4</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">goal5</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">goal6</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">goal7</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">goal8</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">goal9</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">goal10</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">goal11</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">goal12</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">goal13</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">goal15</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">goal16</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">total_affected</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">no_homeless</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">goal1</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.658</td>
<td style="text-align: right;">0.737</td>
<td style="text-align: right;">0.741</td>
<td style="text-align: right;">0.622</td>
<td style="text-align: right;">0.810</td>
<td style="text-align: right;">0.698</td>
<td style="text-align: right;">0.472</td>
<td style="text-align: right;">0.645</td>
<td style="text-align: right;">0.613</td>
<td style="text-align: right;">0.721</td>
<td style="text-align: right;">-0.556</td>
<td style="text-align: right;">-0.403</td>
<td style="text-align: right;">0.323</td>
<td style="text-align: right;">0.546</td>
<td style="text-align: right;">-0.011</td>
<td style="text-align: right;">-0.044</td>
</tr>
<tr class="even">
<td style="text-align: left;">goal2</td>
<td style="text-align: right;">0.658</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.757</td>
<td style="text-align: right;">0.799</td>
<td style="text-align: right;">0.592</td>
<td style="text-align: right;">0.742</td>
<td style="text-align: right;">0.746</td>
<td style="text-align: right;">0.615</td>
<td style="text-align: right;">0.720</td>
<td style="text-align: right;">0.386</td>
<td style="text-align: right;">0.767</td>
<td style="text-align: right;">-0.608</td>
<td style="text-align: right;">-0.435</td>
<td style="text-align: right;">0.137</td>
<td style="text-align: right;">0.657</td>
<td style="text-align: right;">-0.027</td>
<td style="text-align: right;">-0.042</td>
</tr>
<tr class="odd">
<td style="text-align: left;">goal3</td>
<td style="text-align: right;">0.737</td>
<td style="text-align: right;">0.757</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.855</td>
<td style="text-align: right;">0.642</td>
<td style="text-align: right;">0.879</td>
<td style="text-align: right;">0.902</td>
<td style="text-align: right;">0.742</td>
<td style="text-align: right;">0.851</td>
<td style="text-align: right;">0.587</td>
<td style="text-align: right;">0.815</td>
<td style="text-align: right;">-0.797</td>
<td style="text-align: right;">-0.627</td>
<td style="text-align: right;">0.134</td>
<td style="text-align: right;">0.803</td>
<td style="text-align: right;">-0.027</td>
<td style="text-align: right;">-0.056</td>
</tr>
<tr class="even">
<td style="text-align: left;">goal4</td>
<td style="text-align: right;">0.741</td>
<td style="text-align: right;">0.799</td>
<td style="text-align: right;">0.855</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.686</td>
<td style="text-align: right;">0.793</td>
<td style="text-align: right;">0.817</td>
<td style="text-align: right;">0.690</td>
<td style="text-align: right;">0.699</td>
<td style="text-align: right;">0.545</td>
<td style="text-align: right;">0.875</td>
<td style="text-align: right;">-0.640</td>
<td style="text-align: right;">-0.567</td>
<td style="text-align: right;">0.143</td>
<td style="text-align: right;">0.705</td>
<td style="text-align: right;">0.007</td>
<td style="text-align: right;">-0.008</td>
</tr>
<tr class="odd">
<td style="text-align: left;">goal5</td>
<td style="text-align: right;">0.622</td>
<td style="text-align: right;">0.592</td>
<td style="text-align: right;">0.642</td>
<td style="text-align: right;">0.686</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.642</td>
<td style="text-align: right;">0.570</td>
<td style="text-align: right;">0.460</td>
<td style="text-align: right;">0.661</td>
<td style="text-align: right;">0.468</td>
<td style="text-align: right;">0.709</td>
<td style="text-align: right;">-0.605</td>
<td style="text-align: right;">-0.535</td>
<td style="text-align: right;">0.396</td>
<td style="text-align: right;">0.636</td>
<td style="text-align: right;">-0.091</td>
<td style="text-align: right;">-0.147</td>
</tr>
<tr class="even">
<td style="text-align: left;">goal6</td>
<td style="text-align: right;">0.810</td>
<td style="text-align: right;">0.742</td>
<td style="text-align: right;">0.879</td>
<td style="text-align: right;">0.793</td>
<td style="text-align: right;">0.642</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.867</td>
<td style="text-align: right;">0.625</td>
<td style="text-align: right;">0.756</td>
<td style="text-align: right;">0.648</td>
<td style="text-align: right;">0.779</td>
<td style="text-align: right;">-0.642</td>
<td style="text-align: right;">-0.435</td>
<td style="text-align: right;">0.312</td>
<td style="text-align: right;">0.634</td>
<td style="text-align: right;">-0.061</td>
<td style="text-align: right;">-0.093</td>
</tr>
<tr class="odd">
<td style="text-align: left;">goal7</td>
<td style="text-align: right;">0.698</td>
<td style="text-align: right;">0.746</td>
<td style="text-align: right;">0.902</td>
<td style="text-align: right;">0.817</td>
<td style="text-align: right;">0.570</td>
<td style="text-align: right;">0.867</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.664</td>
<td style="text-align: right;">0.720</td>
<td style="text-align: right;">0.511</td>
<td style="text-align: right;">0.760</td>
<td style="text-align: right;">-0.650</td>
<td style="text-align: right;">-0.496</td>
<td style="text-align: right;">0.129</td>
<td style="text-align: right;">0.710</td>
<td style="text-align: right;">-0.012</td>
<td style="text-align: right;">-0.034</td>
</tr>
<tr class="even">
<td style="text-align: left;">goal8</td>
<td style="text-align: right;">0.472</td>
<td style="text-align: right;">0.615</td>
<td style="text-align: right;">0.742</td>
<td style="text-align: right;">0.690</td>
<td style="text-align: right;">0.460</td>
<td style="text-align: right;">0.625</td>
<td style="text-align: right;">0.664</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.653</td>
<td style="text-align: right;">0.482</td>
<td style="text-align: right;">0.683</td>
<td style="text-align: right;">-0.643</td>
<td style="text-align: right;">-0.510</td>
<td style="text-align: right;">0.061</td>
<td style="text-align: right;">0.648</td>
<td style="text-align: right;">-0.018</td>
<td style="text-align: right;">-0.035</td>
</tr>
<tr class="odd">
<td style="text-align: left;">goal9</td>
<td style="text-align: right;">0.645</td>
<td style="text-align: right;">0.720</td>
<td style="text-align: right;">0.851</td>
<td style="text-align: right;">0.699</td>
<td style="text-align: right;">0.661</td>
<td style="text-align: right;">0.756</td>
<td style="text-align: right;">0.720</td>
<td style="text-align: right;">0.653</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.624</td>
<td style="text-align: right;">0.662</td>
<td style="text-align: right;">-0.789</td>
<td style="text-align: right;">-0.604</td>
<td style="text-align: right;">0.190</td>
<td style="text-align: right;">0.743</td>
<td style="text-align: right;">-0.032</td>
<td style="text-align: right;">-0.044</td>
</tr>
<tr class="even">
<td style="text-align: left;">goal10</td>
<td style="text-align: right;">0.613</td>
<td style="text-align: right;">0.386</td>
<td style="text-align: right;">0.587</td>
<td style="text-align: right;">0.545</td>
<td style="text-align: right;">0.468</td>
<td style="text-align: right;">0.648</td>
<td style="text-align: right;">0.511</td>
<td style="text-align: right;">0.482</td>
<td style="text-align: right;">0.624</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.525</td>
<td style="text-align: right;">-0.508</td>
<td style="text-align: right;">-0.367</td>
<td style="text-align: right;">0.503</td>
<td style="text-align: right;">0.491</td>
<td style="text-align: right;">-0.043</td>
<td style="text-align: right;">-0.044</td>
</tr>
<tr class="odd">
<td style="text-align: left;">goal11</td>
<td style="text-align: right;">0.721</td>
<td style="text-align: right;">0.767</td>
<td style="text-align: right;">0.815</td>
<td style="text-align: right;">0.875</td>
<td style="text-align: right;">0.709</td>
<td style="text-align: right;">0.779</td>
<td style="text-align: right;">0.760</td>
<td style="text-align: right;">0.683</td>
<td style="text-align: right;">0.662</td>
<td style="text-align: right;">0.525</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">-0.622</td>
<td style="text-align: right;">-0.530</td>
<td style="text-align: right;">0.193</td>
<td style="text-align: right;">0.760</td>
<td style="text-align: right;">-0.092</td>
<td style="text-align: right;">-0.109</td>
</tr>
<tr class="even">
<td style="text-align: left;">goal12</td>
<td style="text-align: right;">-0.556</td>
<td style="text-align: right;">-0.608</td>
<td style="text-align: right;">-0.797</td>
<td style="text-align: right;">-0.640</td>
<td style="text-align: right;">-0.605</td>
<td style="text-align: right;">-0.642</td>
<td style="text-align: right;">-0.650</td>
<td style="text-align: right;">-0.643</td>
<td style="text-align: right;">-0.789</td>
<td style="text-align: right;">-0.508</td>
<td style="text-align: right;">-0.622</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.852</td>
<td style="text-align: right;">-0.209</td>
<td style="text-align: right;">-0.813</td>
<td style="text-align: right;">0.091</td>
<td style="text-align: right;">0.103</td>
</tr>
<tr class="odd">
<td style="text-align: left;">goal13</td>
<td style="text-align: right;">-0.403</td>
<td style="text-align: right;">-0.435</td>
<td style="text-align: right;">-0.627</td>
<td style="text-align: right;">-0.567</td>
<td style="text-align: right;">-0.535</td>
<td style="text-align: right;">-0.435</td>
<td style="text-align: right;">-0.496</td>
<td style="text-align: right;">-0.510</td>
<td style="text-align: right;">-0.604</td>
<td style="text-align: right;">-0.367</td>
<td style="text-align: right;">-0.530</td>
<td style="text-align: right;">0.852</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">-0.092</td>
<td style="text-align: right;">-0.671</td>
<td style="text-align: right;">0.069</td>
<td style="text-align: right;">0.076</td>
</tr>
<tr class="even">
<td style="text-align: left;">goal15</td>
<td style="text-align: right;">0.323</td>
<td style="text-align: right;">0.137</td>
<td style="text-align: right;">0.134</td>
<td style="text-align: right;">0.143</td>
<td style="text-align: right;">0.396</td>
<td style="text-align: right;">0.312</td>
<td style="text-align: right;">0.129</td>
<td style="text-align: right;">0.061</td>
<td style="text-align: right;">0.190</td>
<td style="text-align: right;">0.503</td>
<td style="text-align: right;">0.193</td>
<td style="text-align: right;">-0.209</td>
<td style="text-align: right;">-0.092</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.154</td>
<td style="text-align: right;">-0.133</td>
<td style="text-align: right;">-0.161</td>
</tr>
<tr class="odd">
<td style="text-align: left;">goal16</td>
<td style="text-align: right;">0.546</td>
<td style="text-align: right;">0.657</td>
<td style="text-align: right;">0.803</td>
<td style="text-align: right;">0.705</td>
<td style="text-align: right;">0.636</td>
<td style="text-align: right;">0.634</td>
<td style="text-align: right;">0.710</td>
<td style="text-align: right;">0.648</td>
<td style="text-align: right;">0.743</td>
<td style="text-align: right;">0.491</td>
<td style="text-align: right;">0.760</td>
<td style="text-align: right;">-0.813</td>
<td style="text-align: right;">-0.671</td>
<td style="text-align: right;">0.154</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">-0.058</td>
<td style="text-align: right;">-0.069</td>
</tr>
<tr class="even">
<td style="text-align: left;">total_affected</td>
<td style="text-align: right;">-0.011</td>
<td style="text-align: right;">-0.027</td>
<td style="text-align: right;">-0.027</td>
<td style="text-align: right;">0.007</td>
<td style="text-align: right;">-0.091</td>
<td style="text-align: right;">-0.061</td>
<td style="text-align: right;">-0.012</td>
<td style="text-align: right;">-0.018</td>
<td style="text-align: right;">-0.032</td>
<td style="text-align: right;">-0.043</td>
<td style="text-align: right;">-0.092</td>
<td style="text-align: right;">0.091</td>
<td style="text-align: right;">0.069</td>
<td style="text-align: right;">-0.133</td>
<td style="text-align: right;">-0.058</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.057</td>
</tr>
<tr class="odd">
<td style="text-align: left;">no_homeless</td>
<td style="text-align: right;">-0.044</td>
<td style="text-align: right;">-0.042</td>
<td style="text-align: right;">-0.056</td>
<td style="text-align: right;">-0.008</td>
<td style="text-align: right;">-0.147</td>
<td style="text-align: right;">-0.093</td>
<td style="text-align: right;">-0.034</td>
<td style="text-align: right;">-0.035</td>
<td style="text-align: right;">-0.044</td>
<td style="text-align: right;">-0.044</td>
<td style="text-align: right;">-0.109</td>
<td style="text-align: right;">0.103</td>
<td style="text-align: right;">0.076</td>
<td style="text-align: right;">-0.161</td>
<td style="text-align: right;">-0.069</td>
<td style="text-align: right;">0.057</td>
<td style="text-align: right;">1.000</td>
</tr>
</tbody>
</table>


</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>cor_melted <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">as.table</span>(correlation_matrix_disaster))</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(cor_melted) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Variable1"</span>, <span class="st">"Variable2"</span>, <span class="st">"Correlation"</span>)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> cor_melted, <span class="fu">aes</span>(Variable1, Variable2, <span class="at">fill =</span> Correlation)) <span class="sc">+</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient2</span>(<span class="at">low =</span> <span class="st">"blue"</span>, <span class="at">high =</span> <span class="st">"red"</span>, <span class="at">mid =</span> <span class="st">"white"</span>,</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>                       <span class="at">midpoint =</span> <span class="dv">0</span>, <span class="at">limit =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>), <span class="at">space =</span> <span class="st">"Lab"</span>,</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>                       <span class="at">name =</span> <span class="st">"Correlation"</span>) <span class="sc">+</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">8</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>)) <span class="sc">+</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>() <span class="sc">+</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">''</span>, <span class="at">y =</span> <span class="st">''</span>,</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">'Correlation between the climate disasters and the SDG goals in South and East Asia'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="question3_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>We conclude that climate disasters do not really have a big impact on SDG goals.</p>
<p>Here we want to analyse the correlation between the Covid-19 and the SDG goals only during Covid time.</p>
<div class="cell" data-layout-align="center" data-hash="question3_cache/html/unnamed-chunk-12_83f3e17461203c46377a9b0dfd01e66d">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>covid_filtered <span class="ot">&lt;-</span> Q3<span class="fl">.2</span>[Q3<span class="fl">.2</span><span class="sc">$</span>year <span class="sc">&gt;=</span> <span class="fu">as.Date</span>(<span class="st">"2019-01-01"</span>), ]</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>relevant_columns <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"goal1"</span>, <span class="st">"goal2"</span>, <span class="st">"goal3"</span>, <span class="st">"goal4"</span>, <span class="st">"goal5"</span>, <span class="st">"goal6"</span>, <span class="st">"goal7"</span>, <span class="st">"goal8"</span>, <span class="st">"goal9"</span>, <span class="st">"goal10"</span>, <span class="st">"goal11"</span>, <span class="st">"goal12"</span>, <span class="st">"goal13"</span>, <span class="st">"goal15"</span>, <span class="st">"goal16"</span>, <span class="st">"stringency"</span>, <span class="st">"cases_per_million"</span>, <span class="st">"deaths_per_million"</span>)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>relevant_data <span class="ot">&lt;-</span> covid_filtered[, relevant_columns]</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>correlation_matrix_Covid <span class="ot">&lt;-</span> <span class="fu">cor</span>(relevant_data, <span class="at">use =</span> <span class="st">"complete.obs"</span>)</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(correlation_matrix_Covid)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">goal1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">goal2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">goal3</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">goal4</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">goal5</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">goal6</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">goal7</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">goal8</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">goal9</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">goal10</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">goal11</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">goal12</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">goal13</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">goal15</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">goal16</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">stringency</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">cases_per_million</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">deaths_per_million</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">goal1</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.565</td>
<td style="text-align: right;">0.870</td>
<td style="text-align: right;">0.792</td>
<td style="text-align: right;">0.442</td>
<td style="text-align: right;">0.761</td>
<td style="text-align: right;">0.802</td>
<td style="text-align: right;">0.612</td>
<td style="text-align: right;">0.790</td>
<td style="text-align: right;">0.504</td>
<td style="text-align: right;">0.739</td>
<td style="text-align: right;">-0.651</td>
<td style="text-align: right;">-0.565</td>
<td style="text-align: right;">0.109</td>
<td style="text-align: right;">0.714</td>
<td style="text-align: right;">0.066</td>
<td style="text-align: right;">0.339</td>
<td style="text-align: right;">0.360</td>
</tr>
<tr class="even">
<td style="text-align: left;">goal2</td>
<td style="text-align: right;">0.565</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.587</td>
<td style="text-align: right;">0.578</td>
<td style="text-align: right;">0.453</td>
<td style="text-align: right;">0.597</td>
<td style="text-align: right;">0.504</td>
<td style="text-align: right;">0.642</td>
<td style="text-align: right;">0.579</td>
<td style="text-align: right;">0.265</td>
<td style="text-align: right;">0.512</td>
<td style="text-align: right;">-0.348</td>
<td style="text-align: right;">-0.283</td>
<td style="text-align: right;">0.105</td>
<td style="text-align: right;">0.476</td>
<td style="text-align: right;">0.061</td>
<td style="text-align: right;">0.208</td>
<td style="text-align: right;">0.257</td>
</tr>
<tr class="odd">
<td style="text-align: left;">goal3</td>
<td style="text-align: right;">0.870</td>
<td style="text-align: right;">0.587</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.840</td>
<td style="text-align: right;">0.641</td>
<td style="text-align: right;">0.822</td>
<td style="text-align: right;">0.850</td>
<td style="text-align: right;">0.717</td>
<td style="text-align: right;">0.883</td>
<td style="text-align: right;">0.470</td>
<td style="text-align: right;">0.835</td>
<td style="text-align: right;">-0.786</td>
<td style="text-align: right;">-0.672</td>
<td style="text-align: right;">0.159</td>
<td style="text-align: right;">0.825</td>
<td style="text-align: right;">0.042</td>
<td style="text-align: right;">0.408</td>
<td style="text-align: right;">0.377</td>
</tr>
<tr class="even">
<td style="text-align: left;">goal4</td>
<td style="text-align: right;">0.792</td>
<td style="text-align: right;">0.578</td>
<td style="text-align: right;">0.840</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.639</td>
<td style="text-align: right;">0.752</td>
<td style="text-align: right;">0.814</td>
<td style="text-align: right;">0.609</td>
<td style="text-align: right;">0.774</td>
<td style="text-align: right;">0.331</td>
<td style="text-align: right;">0.777</td>
<td style="text-align: right;">-0.643</td>
<td style="text-align: right;">-0.556</td>
<td style="text-align: right;">0.070</td>
<td style="text-align: right;">0.684</td>
<td style="text-align: right;">0.094</td>
<td style="text-align: right;">0.342</td>
<td style="text-align: right;">0.351</td>
</tr>
<tr class="odd">
<td style="text-align: left;">goal5</td>
<td style="text-align: right;">0.442</td>
<td style="text-align: right;">0.453</td>
<td style="text-align: right;">0.641</td>
<td style="text-align: right;">0.639</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.647</td>
<td style="text-align: right;">0.603</td>
<td style="text-align: right;">0.556</td>
<td style="text-align: right;">0.633</td>
<td style="text-align: right;">0.098</td>
<td style="text-align: right;">0.678</td>
<td style="text-align: right;">-0.640</td>
<td style="text-align: right;">-0.558</td>
<td style="text-align: right;">0.215</td>
<td style="text-align: right;">0.635</td>
<td style="text-align: right;">0.033</td>
<td style="text-align: right;">0.326</td>
<td style="text-align: right;">0.268</td>
</tr>
<tr class="even">
<td style="text-align: left;">goal6</td>
<td style="text-align: right;">0.761</td>
<td style="text-align: right;">0.597</td>
<td style="text-align: right;">0.822</td>
<td style="text-align: right;">0.752</td>
<td style="text-align: right;">0.647</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.762</td>
<td style="text-align: right;">0.689</td>
<td style="text-align: right;">0.799</td>
<td style="text-align: right;">0.365</td>
<td style="text-align: right;">0.750</td>
<td style="text-align: right;">-0.703</td>
<td style="text-align: right;">-0.581</td>
<td style="text-align: right;">0.253</td>
<td style="text-align: right;">0.732</td>
<td style="text-align: right;">0.054</td>
<td style="text-align: right;">0.385</td>
<td style="text-align: right;">0.410</td>
</tr>
<tr class="odd">
<td style="text-align: left;">goal7</td>
<td style="text-align: right;">0.802</td>
<td style="text-align: right;">0.504</td>
<td style="text-align: right;">0.850</td>
<td style="text-align: right;">0.814</td>
<td style="text-align: right;">0.603</td>
<td style="text-align: right;">0.762</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.579</td>
<td style="text-align: right;">0.748</td>
<td style="text-align: right;">0.329</td>
<td style="text-align: right;">0.802</td>
<td style="text-align: right;">-0.650</td>
<td style="text-align: right;">-0.504</td>
<td style="text-align: right;">0.128</td>
<td style="text-align: right;">0.699</td>
<td style="text-align: right;">0.062</td>
<td style="text-align: right;">0.337</td>
<td style="text-align: right;">0.374</td>
</tr>
<tr class="even">
<td style="text-align: left;">goal8</td>
<td style="text-align: right;">0.612</td>
<td style="text-align: right;">0.642</td>
<td style="text-align: right;">0.717</td>
<td style="text-align: right;">0.609</td>
<td style="text-align: right;">0.556</td>
<td style="text-align: right;">0.689</td>
<td style="text-align: right;">0.579</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.711</td>
<td style="text-align: right;">0.389</td>
<td style="text-align: right;">0.608</td>
<td style="text-align: right;">-0.646</td>
<td style="text-align: right;">-0.552</td>
<td style="text-align: right;">0.281</td>
<td style="text-align: right;">0.659</td>
<td style="text-align: right;">-0.013</td>
<td style="text-align: right;">0.366</td>
<td style="text-align: right;">0.306</td>
</tr>
<tr class="odd">
<td style="text-align: left;">goal9</td>
<td style="text-align: right;">0.790</td>
<td style="text-align: right;">0.579</td>
<td style="text-align: right;">0.883</td>
<td style="text-align: right;">0.774</td>
<td style="text-align: right;">0.633</td>
<td style="text-align: right;">0.799</td>
<td style="text-align: right;">0.748</td>
<td style="text-align: right;">0.711</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.471</td>
<td style="text-align: right;">0.753</td>
<td style="text-align: right;">-0.852</td>
<td style="text-align: right;">-0.759</td>
<td style="text-align: right;">0.192</td>
<td style="text-align: right;">0.830</td>
<td style="text-align: right;">0.065</td>
<td style="text-align: right;">0.460</td>
<td style="text-align: right;">0.370</td>
</tr>
<tr class="even">
<td style="text-align: left;">goal10</td>
<td style="text-align: right;">0.504</td>
<td style="text-align: right;">0.265</td>
<td style="text-align: right;">0.470</td>
<td style="text-align: right;">0.331</td>
<td style="text-align: right;">0.098</td>
<td style="text-align: right;">0.365</td>
<td style="text-align: right;">0.329</td>
<td style="text-align: right;">0.389</td>
<td style="text-align: right;">0.471</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.304</td>
<td style="text-align: right;">-0.506</td>
<td style="text-align: right;">-0.483</td>
<td style="text-align: right;">0.236</td>
<td style="text-align: right;">0.517</td>
<td style="text-align: right;">-0.029</td>
<td style="text-align: right;">0.259</td>
<td style="text-align: right;">0.127</td>
</tr>
<tr class="odd">
<td style="text-align: left;">goal11</td>
<td style="text-align: right;">0.739</td>
<td style="text-align: right;">0.512</td>
<td style="text-align: right;">0.835</td>
<td style="text-align: right;">0.777</td>
<td style="text-align: right;">0.678</td>
<td style="text-align: right;">0.750</td>
<td style="text-align: right;">0.802</td>
<td style="text-align: right;">0.608</td>
<td style="text-align: right;">0.753</td>
<td style="text-align: right;">0.304</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">-0.681</td>
<td style="text-align: right;">-0.569</td>
<td style="text-align: right;">0.093</td>
<td style="text-align: right;">0.764</td>
<td style="text-align: right;">0.028</td>
<td style="text-align: right;">0.338</td>
<td style="text-align: right;">0.336</td>
</tr>
<tr class="even">
<td style="text-align: left;">goal12</td>
<td style="text-align: right;">-0.651</td>
<td style="text-align: right;">-0.348</td>
<td style="text-align: right;">-0.786</td>
<td style="text-align: right;">-0.643</td>
<td style="text-align: right;">-0.640</td>
<td style="text-align: right;">-0.703</td>
<td style="text-align: right;">-0.650</td>
<td style="text-align: right;">-0.646</td>
<td style="text-align: right;">-0.852</td>
<td style="text-align: right;">-0.506</td>
<td style="text-align: right;">-0.681</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.876</td>
<td style="text-align: right;">-0.334</td>
<td style="text-align: right;">-0.827</td>
<td style="text-align: right;">0.023</td>
<td style="text-align: right;">-0.463</td>
<td style="text-align: right;">-0.302</td>
</tr>
<tr class="odd">
<td style="text-align: left;">goal13</td>
<td style="text-align: right;">-0.565</td>
<td style="text-align: right;">-0.283</td>
<td style="text-align: right;">-0.672</td>
<td style="text-align: right;">-0.556</td>
<td style="text-align: right;">-0.558</td>
<td style="text-align: right;">-0.581</td>
<td style="text-align: right;">-0.504</td>
<td style="text-align: right;">-0.552</td>
<td style="text-align: right;">-0.759</td>
<td style="text-align: right;">-0.483</td>
<td style="text-align: right;">-0.569</td>
<td style="text-align: right;">0.876</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">-0.215</td>
<td style="text-align: right;">-0.696</td>
<td style="text-align: right;">0.004</td>
<td style="text-align: right;">-0.368</td>
<td style="text-align: right;">-0.185</td>
</tr>
<tr class="even">
<td style="text-align: left;">goal15</td>
<td style="text-align: right;">0.109</td>
<td style="text-align: right;">0.105</td>
<td style="text-align: right;">0.159</td>
<td style="text-align: right;">0.070</td>
<td style="text-align: right;">0.215</td>
<td style="text-align: right;">0.253</td>
<td style="text-align: right;">0.128</td>
<td style="text-align: right;">0.281</td>
<td style="text-align: right;">0.192</td>
<td style="text-align: right;">0.236</td>
<td style="text-align: right;">0.093</td>
<td style="text-align: right;">-0.334</td>
<td style="text-align: right;">-0.215</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.303</td>
<td style="text-align: right;">-0.077</td>
<td style="text-align: right;">0.171</td>
<td style="text-align: right;">0.228</td>
</tr>
<tr class="odd">
<td style="text-align: left;">goal16</td>
<td style="text-align: right;">0.714</td>
<td style="text-align: right;">0.476</td>
<td style="text-align: right;">0.825</td>
<td style="text-align: right;">0.684</td>
<td style="text-align: right;">0.635</td>
<td style="text-align: right;">0.732</td>
<td style="text-align: right;">0.699</td>
<td style="text-align: right;">0.659</td>
<td style="text-align: right;">0.830</td>
<td style="text-align: right;">0.517</td>
<td style="text-align: right;">0.764</td>
<td style="text-align: right;">-0.827</td>
<td style="text-align: right;">-0.696</td>
<td style="text-align: right;">0.303</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">-0.001</td>
<td style="text-align: right;">0.425</td>
<td style="text-align: right;">0.314</td>
</tr>
<tr class="even">
<td style="text-align: left;">stringency</td>
<td style="text-align: right;">0.066</td>
<td style="text-align: right;">0.061</td>
<td style="text-align: right;">0.042</td>
<td style="text-align: right;">0.094</td>
<td style="text-align: right;">0.033</td>
<td style="text-align: right;">0.054</td>
<td style="text-align: right;">0.062</td>
<td style="text-align: right;">-0.013</td>
<td style="text-align: right;">0.065</td>
<td style="text-align: right;">-0.029</td>
<td style="text-align: right;">0.028</td>
<td style="text-align: right;">0.023</td>
<td style="text-align: right;">0.004</td>
<td style="text-align: right;">-0.077</td>
<td style="text-align: right;">-0.001</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.048</td>
<td style="text-align: right;">0.392</td>
</tr>
<tr class="odd">
<td style="text-align: left;">cases_per_million</td>
<td style="text-align: right;">0.339</td>
<td style="text-align: right;">0.208</td>
<td style="text-align: right;">0.408</td>
<td style="text-align: right;">0.342</td>
<td style="text-align: right;">0.326</td>
<td style="text-align: right;">0.385</td>
<td style="text-align: right;">0.337</td>
<td style="text-align: right;">0.366</td>
<td style="text-align: right;">0.460</td>
<td style="text-align: right;">0.259</td>
<td style="text-align: right;">0.338</td>
<td style="text-align: right;">-0.463</td>
<td style="text-align: right;">-0.368</td>
<td style="text-align: right;">0.171</td>
<td style="text-align: right;">0.425</td>
<td style="text-align: right;">0.048</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.417</td>
</tr>
<tr class="even">
<td style="text-align: left;">deaths_per_million</td>
<td style="text-align: right;">0.360</td>
<td style="text-align: right;">0.257</td>
<td style="text-align: right;">0.377</td>
<td style="text-align: right;">0.351</td>
<td style="text-align: right;">0.268</td>
<td style="text-align: right;">0.410</td>
<td style="text-align: right;">0.374</td>
<td style="text-align: right;">0.306</td>
<td style="text-align: right;">0.370</td>
<td style="text-align: right;">0.127</td>
<td style="text-align: right;">0.336</td>
<td style="text-align: right;">-0.302</td>
<td style="text-align: right;">-0.185</td>
<td style="text-align: right;">0.228</td>
<td style="text-align: right;">0.314</td>
<td style="text-align: right;">0.392</td>
<td style="text-align: right;">0.417</td>
<td style="text-align: right;">1.000</td>
</tr>
</tbody>
</table>


</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>cor_melted <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">as.table</span>(correlation_matrix_Covid))</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(cor_melted) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Variable1"</span>, <span class="st">"Variable2"</span>, <span class="st">"Correlation"</span>)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> cor_melted, <span class="fu">aes</span>(Variable1, Variable2, <span class="at">fill =</span> Correlation)) <span class="sc">+</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient2</span>(<span class="at">low =</span> <span class="st">"blue"</span>, <span class="at">high =</span> <span class="st">"red"</span>, <span class="at">mid =</span> <span class="st">"white"</span>,</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>                       <span class="at">midpoint =</span> <span class="dv">0</span>, <span class="at">limit =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>), <span class="at">space =</span> <span class="st">"Lab"</span>,</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>                       <span class="at">name =</span> <span class="st">"Correlation"</span>) <span class="sc">+</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">8</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>)) <span class="sc">+</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>() <span class="sc">+</span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">''</span>, <span class="at">y =</span> <span class="st">''</span>,</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">'Correlation between COVID and the SDG goals'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="question3_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>Same conclusion, really weird.</p>
<p>Here we want to analyse the correlation between conflicts deaths and the SDG goals only for the Middle East &amp; North Africa, Sub-Saharan Africa, South Asia, Latin America &amp; the Caribbean and Eastern Europe regions.</p>
<div class="cell" data-layout-align="center" data-hash="question3_cache/html/unnamed-chunk-13_affa522a36bbec5b9886f92f41097a32">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>selected_regions <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Middle East &amp; North Africa"</span>, <span class="st">"Sub-Saharan Africa"</span>, <span class="st">"South Asia"</span>, <span class="st">"Latin America &amp; the Caribbean"</span>, <span class="st">"Eastern Europe"</span>)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>conflicts_selected <span class="ot">&lt;-</span> Q3<span class="fl">.3</span>[Q3<span class="fl">.3</span><span class="sc">$</span>region <span class="sc">%in%</span> selected_regions, ]</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>relevant_columns <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"goal1"</span>, <span class="st">"goal2"</span>, <span class="st">"goal3"</span>, <span class="st">"goal4"</span>, <span class="st">"goal5"</span>, <span class="st">"goal6"</span>, <span class="st">"goal7"</span>, <span class="st">"goal8"</span>, <span class="st">"goal9"</span>, <span class="st">"goal10"</span>, <span class="st">"goal11"</span>, <span class="st">"goal12"</span>, <span class="st">"goal13"</span>, <span class="st">"goal15"</span>, <span class="st">"goal16"</span>, <span class="st">"sum_deaths"</span>, <span class="st">"maxintensity"</span>)</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>correlation_matrix_Conflicts_Deaths <span class="ot">&lt;-</span> <span class="fu">cor</span>(conflicts_selected[, relevant_columns], <span class="at">use =</span> <span class="st">"complete.obs"</span>)</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(correlation_matrix_Conflicts_Deaths)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">goal1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">goal2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">goal3</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">goal4</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">goal5</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">goal6</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">goal7</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">goal8</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">goal9</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">goal10</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">goal11</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">goal12</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">goal13</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">goal15</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">goal16</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">sum_deaths</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">maxintensity</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">goal1</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.449</td>
<td style="text-align: right;">0.907</td>
<td style="text-align: right;">0.793</td>
<td style="text-align: right;">0.402</td>
<td style="text-align: right;">0.801</td>
<td style="text-align: right;">0.864</td>
<td style="text-align: right;">0.549</td>
<td style="text-align: right;">0.722</td>
<td style="text-align: right;">0.260</td>
<td style="text-align: right;">0.781</td>
<td style="text-align: right;">-0.733</td>
<td style="text-align: right;">-0.592</td>
<td style="text-align: right;">0.034</td>
<td style="text-align: right;">0.594</td>
<td style="text-align: right;">-0.094</td>
<td style="text-align: right;">-0.150</td>
</tr>
<tr class="even">
<td style="text-align: left;">goal2</td>
<td style="text-align: right;">0.449</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.517</td>
<td style="text-align: right;">0.501</td>
<td style="text-align: right;">0.537</td>
<td style="text-align: right;">0.611</td>
<td style="text-align: right;">0.516</td>
<td style="text-align: right;">0.538</td>
<td style="text-align: right;">0.517</td>
<td style="text-align: right;">0.102</td>
<td style="text-align: right;">0.458</td>
<td style="text-align: right;">-0.351</td>
<td style="text-align: right;">-0.319</td>
<td style="text-align: right;">0.159</td>
<td style="text-align: right;">0.407</td>
<td style="text-align: right;">-0.168</td>
<td style="text-align: right;">-0.228</td>
</tr>
<tr class="odd">
<td style="text-align: left;">goal3</td>
<td style="text-align: right;">0.907</td>
<td style="text-align: right;">0.517</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.815</td>
<td style="text-align: right;">0.497</td>
<td style="text-align: right;">0.827</td>
<td style="text-align: right;">0.870</td>
<td style="text-align: right;">0.582</td>
<td style="text-align: right;">0.765</td>
<td style="text-align: right;">0.223</td>
<td style="text-align: right;">0.829</td>
<td style="text-align: right;">-0.743</td>
<td style="text-align: right;">-0.580</td>
<td style="text-align: right;">0.010</td>
<td style="text-align: right;">0.661</td>
<td style="text-align: right;">-0.119</td>
<td style="text-align: right;">-0.172</td>
</tr>
<tr class="even">
<td style="text-align: left;">goal4</td>
<td style="text-align: right;">0.793</td>
<td style="text-align: right;">0.501</td>
<td style="text-align: right;">0.815</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.635</td>
<td style="text-align: right;">0.747</td>
<td style="text-align: right;">0.805</td>
<td style="text-align: right;">0.532</td>
<td style="text-align: right;">0.694</td>
<td style="text-align: right;">0.085</td>
<td style="text-align: right;">0.768</td>
<td style="text-align: right;">-0.669</td>
<td style="text-align: right;">-0.528</td>
<td style="text-align: right;">0.002</td>
<td style="text-align: right;">0.489</td>
<td style="text-align: right;">-0.101</td>
<td style="text-align: right;">-0.151</td>
</tr>
<tr class="odd">
<td style="text-align: left;">goal5</td>
<td style="text-align: right;">0.402</td>
<td style="text-align: right;">0.537</td>
<td style="text-align: right;">0.497</td>
<td style="text-align: right;">0.635</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.584</td>
<td style="text-align: right;">0.539</td>
<td style="text-align: right;">0.454</td>
<td style="text-align: right;">0.515</td>
<td style="text-align: right;">-0.185</td>
<td style="text-align: right;">0.612</td>
<td style="text-align: right;">-0.459</td>
<td style="text-align: right;">-0.355</td>
<td style="text-align: right;">0.194</td>
<td style="text-align: right;">0.361</td>
<td style="text-align: right;">-0.159</td>
<td style="text-align: right;">-0.242</td>
</tr>
<tr class="even">
<td style="text-align: left;">goal6</td>
<td style="text-align: right;">0.801</td>
<td style="text-align: right;">0.611</td>
<td style="text-align: right;">0.827</td>
<td style="text-align: right;">0.747</td>
<td style="text-align: right;">0.584</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.813</td>
<td style="text-align: right;">0.674</td>
<td style="text-align: right;">0.733</td>
<td style="text-align: right;">0.123</td>
<td style="text-align: right;">0.783</td>
<td style="text-align: right;">-0.715</td>
<td style="text-align: right;">-0.530</td>
<td style="text-align: right;">0.182</td>
<td style="text-align: right;">0.574</td>
<td style="text-align: right;">-0.163</td>
<td style="text-align: right;">-0.255</td>
</tr>
<tr class="odd">
<td style="text-align: left;">goal7</td>
<td style="text-align: right;">0.864</td>
<td style="text-align: right;">0.516</td>
<td style="text-align: right;">0.870</td>
<td style="text-align: right;">0.805</td>
<td style="text-align: right;">0.539</td>
<td style="text-align: right;">0.813</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.541</td>
<td style="text-align: right;">0.721</td>
<td style="text-align: right;">0.140</td>
<td style="text-align: right;">0.837</td>
<td style="text-align: right;">-0.705</td>
<td style="text-align: right;">-0.533</td>
<td style="text-align: right;">0.038</td>
<td style="text-align: right;">0.544</td>
<td style="text-align: right;">-0.092</td>
<td style="text-align: right;">-0.158</td>
</tr>
<tr class="even">
<td style="text-align: left;">goal8</td>
<td style="text-align: right;">0.549</td>
<td style="text-align: right;">0.538</td>
<td style="text-align: right;">0.582</td>
<td style="text-align: right;">0.532</td>
<td style="text-align: right;">0.454</td>
<td style="text-align: right;">0.674</td>
<td style="text-align: right;">0.541</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.605</td>
<td style="text-align: right;">0.178</td>
<td style="text-align: right;">0.530</td>
<td style="text-align: right;">-0.523</td>
<td style="text-align: right;">-0.392</td>
<td style="text-align: right;">0.175</td>
<td style="text-align: right;">0.419</td>
<td style="text-align: right;">-0.097</td>
<td style="text-align: right;">-0.164</td>
</tr>
<tr class="odd">
<td style="text-align: left;">goal9</td>
<td style="text-align: right;">0.722</td>
<td style="text-align: right;">0.517</td>
<td style="text-align: right;">0.765</td>
<td style="text-align: right;">0.694</td>
<td style="text-align: right;">0.515</td>
<td style="text-align: right;">0.733</td>
<td style="text-align: right;">0.721</td>
<td style="text-align: right;">0.605</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.292</td>
<td style="text-align: right;">0.697</td>
<td style="text-align: right;">-0.757</td>
<td style="text-align: right;">-0.689</td>
<td style="text-align: right;">0.135</td>
<td style="text-align: right;">0.575</td>
<td style="text-align: right;">-0.077</td>
<td style="text-align: right;">-0.114</td>
</tr>
<tr class="even">
<td style="text-align: left;">goal10</td>
<td style="text-align: right;">0.260</td>
<td style="text-align: right;">0.102</td>
<td style="text-align: right;">0.223</td>
<td style="text-align: right;">0.085</td>
<td style="text-align: right;">-0.185</td>
<td style="text-align: right;">0.123</td>
<td style="text-align: right;">0.140</td>
<td style="text-align: right;">0.178</td>
<td style="text-align: right;">0.292</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.037</td>
<td style="text-align: right;">-0.283</td>
<td style="text-align: right;">-0.287</td>
<td style="text-align: right;">0.115</td>
<td style="text-align: right;">0.289</td>
<td style="text-align: right;">0.075</td>
<td style="text-align: right;">0.104</td>
</tr>
<tr class="odd">
<td style="text-align: left;">goal11</td>
<td style="text-align: right;">0.781</td>
<td style="text-align: right;">0.458</td>
<td style="text-align: right;">0.829</td>
<td style="text-align: right;">0.768</td>
<td style="text-align: right;">0.612</td>
<td style="text-align: right;">0.783</td>
<td style="text-align: right;">0.837</td>
<td style="text-align: right;">0.530</td>
<td style="text-align: right;">0.697</td>
<td style="text-align: right;">0.037</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">-0.727</td>
<td style="text-align: right;">-0.565</td>
<td style="text-align: right;">0.029</td>
<td style="text-align: right;">0.650</td>
<td style="text-align: right;">-0.155</td>
<td style="text-align: right;">-0.253</td>
</tr>
<tr class="even">
<td style="text-align: left;">goal12</td>
<td style="text-align: right;">-0.733</td>
<td style="text-align: right;">-0.351</td>
<td style="text-align: right;">-0.743</td>
<td style="text-align: right;">-0.669</td>
<td style="text-align: right;">-0.459</td>
<td style="text-align: right;">-0.715</td>
<td style="text-align: right;">-0.705</td>
<td style="text-align: right;">-0.523</td>
<td style="text-align: right;">-0.757</td>
<td style="text-align: right;">-0.283</td>
<td style="text-align: right;">-0.727</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.860</td>
<td style="text-align: right;">-0.162</td>
<td style="text-align: right;">-0.645</td>
<td style="text-align: right;">0.121</td>
<td style="text-align: right;">0.227</td>
</tr>
<tr class="odd">
<td style="text-align: left;">goal13</td>
<td style="text-align: right;">-0.592</td>
<td style="text-align: right;">-0.319</td>
<td style="text-align: right;">-0.580</td>
<td style="text-align: right;">-0.528</td>
<td style="text-align: right;">-0.355</td>
<td style="text-align: right;">-0.530</td>
<td style="text-align: right;">-0.533</td>
<td style="text-align: right;">-0.392</td>
<td style="text-align: right;">-0.689</td>
<td style="text-align: right;">-0.287</td>
<td style="text-align: right;">-0.565</td>
<td style="text-align: right;">0.860</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">-0.150</td>
<td style="text-align: right;">-0.472</td>
<td style="text-align: right;">0.077</td>
<td style="text-align: right;">0.113</td>
</tr>
<tr class="even">
<td style="text-align: left;">goal15</td>
<td style="text-align: right;">0.034</td>
<td style="text-align: right;">0.159</td>
<td style="text-align: right;">0.010</td>
<td style="text-align: right;">0.002</td>
<td style="text-align: right;">0.194</td>
<td style="text-align: right;">0.182</td>
<td style="text-align: right;">0.038</td>
<td style="text-align: right;">0.175</td>
<td style="text-align: right;">0.135</td>
<td style="text-align: right;">0.115</td>
<td style="text-align: right;">0.029</td>
<td style="text-align: right;">-0.162</td>
<td style="text-align: right;">-0.150</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.183</td>
<td style="text-align: right;">-0.061</td>
<td style="text-align: right;">-0.135</td>
</tr>
<tr class="odd">
<td style="text-align: left;">goal16</td>
<td style="text-align: right;">0.594</td>
<td style="text-align: right;">0.407</td>
<td style="text-align: right;">0.661</td>
<td style="text-align: right;">0.489</td>
<td style="text-align: right;">0.361</td>
<td style="text-align: right;">0.574</td>
<td style="text-align: right;">0.544</td>
<td style="text-align: right;">0.419</td>
<td style="text-align: right;">0.575</td>
<td style="text-align: right;">0.289</td>
<td style="text-align: right;">0.650</td>
<td style="text-align: right;">-0.645</td>
<td style="text-align: right;">-0.472</td>
<td style="text-align: right;">0.183</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">-0.163</td>
<td style="text-align: right;">-0.255</td>
</tr>
<tr class="even">
<td style="text-align: left;">sum_deaths</td>
<td style="text-align: right;">-0.094</td>
<td style="text-align: right;">-0.168</td>
<td style="text-align: right;">-0.119</td>
<td style="text-align: right;">-0.101</td>
<td style="text-align: right;">-0.159</td>
<td style="text-align: right;">-0.163</td>
<td style="text-align: right;">-0.092</td>
<td style="text-align: right;">-0.097</td>
<td style="text-align: right;">-0.077</td>
<td style="text-align: right;">0.075</td>
<td style="text-align: right;">-0.155</td>
<td style="text-align: right;">0.121</td>
<td style="text-align: right;">0.077</td>
<td style="text-align: right;">-0.061</td>
<td style="text-align: right;">-0.163</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.398</td>
</tr>
<tr class="odd">
<td style="text-align: left;">maxintensity</td>
<td style="text-align: right;">-0.150</td>
<td style="text-align: right;">-0.228</td>
<td style="text-align: right;">-0.172</td>
<td style="text-align: right;">-0.151</td>
<td style="text-align: right;">-0.242</td>
<td style="text-align: right;">-0.255</td>
<td style="text-align: right;">-0.158</td>
<td style="text-align: right;">-0.164</td>
<td style="text-align: right;">-0.114</td>
<td style="text-align: right;">0.104</td>
<td style="text-align: right;">-0.253</td>
<td style="text-align: right;">0.227</td>
<td style="text-align: right;">0.113</td>
<td style="text-align: right;">-0.135</td>
<td style="text-align: right;">-0.255</td>
<td style="text-align: right;">0.398</td>
<td style="text-align: right;">1.000</td>
</tr>
</tbody>
</table>


</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>cor_melted <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">as.table</span>(correlation_matrix_Conflicts_Deaths))</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(cor_melted) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Variable1"</span>, <span class="st">"Variable2"</span>, <span class="st">"Correlation"</span>)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> cor_melted, <span class="fu">aes</span>(Variable1, Variable2, <span class="at">fill =</span> Correlation)) <span class="sc">+</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient2</span>(<span class="at">low =</span> <span class="st">"blue"</span>, <span class="at">high =</span> <span class="st">"red"</span>, <span class="at">mid =</span> <span class="st">"white"</span>,</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>                       <span class="at">midpoint =</span> <span class="dv">0</span>, <span class="at">limit =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>), <span class="at">space =</span> <span class="st">"Lab"</span>,</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>                       <span class="at">name =</span> <span class="st">"Correlation"</span>) <span class="sc">+</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">8</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>)) <span class="sc">+</span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>() <span class="sc">+</span></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">''</span>, <span class="at">y =</span> <span class="st">''</span>,</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">'Correlation between Conflicts deaths and the SDG goals'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="question3_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>Finally, we want to analyse the correlation between conflicts affected population and the SDG goals only for the Middle East &amp; North Africa, Sub-Saharan Africa, South Asia, Latin America &amp; the Caribbean, Eastern Europe regions and Caucasus and Central Asia.</p>
<div class="cell" data-layout-align="center" data-hash="question3_cache/html/unnamed-chunk-14_7297d39c4f88948d01073498fa17220a">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter data for specific regions (pop_affected)</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>selected_regions <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Middle East &amp; North Africa"</span>, <span class="st">"Sub-Saharan Africa"</span>, <span class="st">"South Asia"</span>, <span class="st">"Latin America &amp; the Caribbean"</span>, <span class="st">"Eastern Europe"</span>,<span class="st">"Caucasus and Central Asia"</span>)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>conflicts_selected <span class="ot">&lt;-</span> Q3<span class="fl">.3</span>[Q3<span class="fl">.3</span><span class="sc">$</span>region <span class="sc">%in%</span> selected_regions, ]</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>relevant_columns <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"goal1"</span>, <span class="st">"goal2"</span>, <span class="st">"goal3"</span>, <span class="st">"goal4"</span>, <span class="st">"goal5"</span>, <span class="st">"goal6"</span>, <span class="st">"goal7"</span>, <span class="st">"goal8"</span>, <span class="st">"goal9"</span>, <span class="st">"goal10"</span>, <span class="st">"goal11"</span>, <span class="st">"goal12"</span>, <span class="st">"goal13"</span>, <span class="st">"goal15"</span>, <span class="st">"goal16"</span>, <span class="st">"pop_affected"</span>)</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>correlation_matrix_Conflicts_Pop_Affected <span class="ot">&lt;-</span> <span class="fu">cor</span>(conflicts_selected[, relevant_columns], <span class="at">use =</span> <span class="st">"complete.obs"</span>)</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(correlation_matrix_Conflicts_Pop_Affected)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">goal1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">goal2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">goal3</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">goal4</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">goal5</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">goal6</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">goal7</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">goal8</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">goal9</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">goal10</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">goal11</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">goal12</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">goal13</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">goal15</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">goal16</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">pop_affected</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">goal1</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.449</td>
<td style="text-align: right;">0.907</td>
<td style="text-align: right;">0.793</td>
<td style="text-align: right;">0.402</td>
<td style="text-align: right;">0.801</td>
<td style="text-align: right;">0.864</td>
<td style="text-align: right;">0.549</td>
<td style="text-align: right;">0.722</td>
<td style="text-align: right;">0.260</td>
<td style="text-align: right;">0.781</td>
<td style="text-align: right;">-0.733</td>
<td style="text-align: right;">-0.592</td>
<td style="text-align: right;">0.034</td>
<td style="text-align: right;">0.594</td>
<td style="text-align: right;">-0.066</td>
</tr>
<tr class="even">
<td style="text-align: left;">goal2</td>
<td style="text-align: right;">0.449</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.517</td>
<td style="text-align: right;">0.501</td>
<td style="text-align: right;">0.537</td>
<td style="text-align: right;">0.611</td>
<td style="text-align: right;">0.516</td>
<td style="text-align: right;">0.538</td>
<td style="text-align: right;">0.517</td>
<td style="text-align: right;">0.102</td>
<td style="text-align: right;">0.458</td>
<td style="text-align: right;">-0.351</td>
<td style="text-align: right;">-0.319</td>
<td style="text-align: right;">0.159</td>
<td style="text-align: right;">0.407</td>
<td style="text-align: right;">-0.078</td>
</tr>
<tr class="odd">
<td style="text-align: left;">goal3</td>
<td style="text-align: right;">0.907</td>
<td style="text-align: right;">0.517</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.815</td>
<td style="text-align: right;">0.497</td>
<td style="text-align: right;">0.827</td>
<td style="text-align: right;">0.870</td>
<td style="text-align: right;">0.582</td>
<td style="text-align: right;">0.765</td>
<td style="text-align: right;">0.223</td>
<td style="text-align: right;">0.829</td>
<td style="text-align: right;">-0.743</td>
<td style="text-align: right;">-0.580</td>
<td style="text-align: right;">0.010</td>
<td style="text-align: right;">0.661</td>
<td style="text-align: right;">-0.061</td>
</tr>
<tr class="even">
<td style="text-align: left;">goal4</td>
<td style="text-align: right;">0.793</td>
<td style="text-align: right;">0.501</td>
<td style="text-align: right;">0.815</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.635</td>
<td style="text-align: right;">0.747</td>
<td style="text-align: right;">0.805</td>
<td style="text-align: right;">0.532</td>
<td style="text-align: right;">0.694</td>
<td style="text-align: right;">0.085</td>
<td style="text-align: right;">0.768</td>
<td style="text-align: right;">-0.669</td>
<td style="text-align: right;">-0.528</td>
<td style="text-align: right;">0.002</td>
<td style="text-align: right;">0.489</td>
<td style="text-align: right;">-0.032</td>
</tr>
<tr class="odd">
<td style="text-align: left;">goal5</td>
<td style="text-align: right;">0.402</td>
<td style="text-align: right;">0.537</td>
<td style="text-align: right;">0.497</td>
<td style="text-align: right;">0.635</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.584</td>
<td style="text-align: right;">0.539</td>
<td style="text-align: right;">0.454</td>
<td style="text-align: right;">0.515</td>
<td style="text-align: right;">-0.185</td>
<td style="text-align: right;">0.612</td>
<td style="text-align: right;">-0.459</td>
<td style="text-align: right;">-0.355</td>
<td style="text-align: right;">0.194</td>
<td style="text-align: right;">0.361</td>
<td style="text-align: right;">-0.146</td>
</tr>
<tr class="even">
<td style="text-align: left;">goal6</td>
<td style="text-align: right;">0.801</td>
<td style="text-align: right;">0.611</td>
<td style="text-align: right;">0.827</td>
<td style="text-align: right;">0.747</td>
<td style="text-align: right;">0.584</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.813</td>
<td style="text-align: right;">0.674</td>
<td style="text-align: right;">0.733</td>
<td style="text-align: right;">0.123</td>
<td style="text-align: right;">0.783</td>
<td style="text-align: right;">-0.715</td>
<td style="text-align: right;">-0.530</td>
<td style="text-align: right;">0.182</td>
<td style="text-align: right;">0.574</td>
<td style="text-align: right;">-0.104</td>
</tr>
<tr class="odd">
<td style="text-align: left;">goal7</td>
<td style="text-align: right;">0.864</td>
<td style="text-align: right;">0.516</td>
<td style="text-align: right;">0.870</td>
<td style="text-align: right;">0.805</td>
<td style="text-align: right;">0.539</td>
<td style="text-align: right;">0.813</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.541</td>
<td style="text-align: right;">0.721</td>
<td style="text-align: right;">0.140</td>
<td style="text-align: right;">0.837</td>
<td style="text-align: right;">-0.705</td>
<td style="text-align: right;">-0.533</td>
<td style="text-align: right;">0.038</td>
<td style="text-align: right;">0.544</td>
<td style="text-align: right;">-0.068</td>
</tr>
<tr class="even">
<td style="text-align: left;">goal8</td>
<td style="text-align: right;">0.549</td>
<td style="text-align: right;">0.538</td>
<td style="text-align: right;">0.582</td>
<td style="text-align: right;">0.532</td>
<td style="text-align: right;">0.454</td>
<td style="text-align: right;">0.674</td>
<td style="text-align: right;">0.541</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.605</td>
<td style="text-align: right;">0.178</td>
<td style="text-align: right;">0.530</td>
<td style="text-align: right;">-0.523</td>
<td style="text-align: right;">-0.392</td>
<td style="text-align: right;">0.175</td>
<td style="text-align: right;">0.419</td>
<td style="text-align: right;">-0.092</td>
</tr>
<tr class="odd">
<td style="text-align: left;">goal9</td>
<td style="text-align: right;">0.722</td>
<td style="text-align: right;">0.517</td>
<td style="text-align: right;">0.765</td>
<td style="text-align: right;">0.694</td>
<td style="text-align: right;">0.515</td>
<td style="text-align: right;">0.733</td>
<td style="text-align: right;">0.721</td>
<td style="text-align: right;">0.605</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.292</td>
<td style="text-align: right;">0.697</td>
<td style="text-align: right;">-0.757</td>
<td style="text-align: right;">-0.689</td>
<td style="text-align: right;">0.135</td>
<td style="text-align: right;">0.575</td>
<td style="text-align: right;">0.001</td>
</tr>
<tr class="even">
<td style="text-align: left;">goal10</td>
<td style="text-align: right;">0.260</td>
<td style="text-align: right;">0.102</td>
<td style="text-align: right;">0.223</td>
<td style="text-align: right;">0.085</td>
<td style="text-align: right;">-0.185</td>
<td style="text-align: right;">0.123</td>
<td style="text-align: right;">0.140</td>
<td style="text-align: right;">0.178</td>
<td style="text-align: right;">0.292</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.037</td>
<td style="text-align: right;">-0.283</td>
<td style="text-align: right;">-0.287</td>
<td style="text-align: right;">0.115</td>
<td style="text-align: right;">0.289</td>
<td style="text-align: right;">0.068</td>
</tr>
<tr class="odd">
<td style="text-align: left;">goal11</td>
<td style="text-align: right;">0.781</td>
<td style="text-align: right;">0.458</td>
<td style="text-align: right;">0.829</td>
<td style="text-align: right;">0.768</td>
<td style="text-align: right;">0.612</td>
<td style="text-align: right;">0.783</td>
<td style="text-align: right;">0.837</td>
<td style="text-align: right;">0.530</td>
<td style="text-align: right;">0.697</td>
<td style="text-align: right;">0.037</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">-0.727</td>
<td style="text-align: right;">-0.565</td>
<td style="text-align: right;">0.029</td>
<td style="text-align: right;">0.650</td>
<td style="text-align: right;">-0.104</td>
</tr>
<tr class="even">
<td style="text-align: left;">goal12</td>
<td style="text-align: right;">-0.733</td>
<td style="text-align: right;">-0.351</td>
<td style="text-align: right;">-0.743</td>
<td style="text-align: right;">-0.669</td>
<td style="text-align: right;">-0.459</td>
<td style="text-align: right;">-0.715</td>
<td style="text-align: right;">-0.705</td>
<td style="text-align: right;">-0.523</td>
<td style="text-align: right;">-0.757</td>
<td style="text-align: right;">-0.283</td>
<td style="text-align: right;">-0.727</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.860</td>
<td style="text-align: right;">-0.162</td>
<td style="text-align: right;">-0.645</td>
<td style="text-align: right;">0.106</td>
</tr>
<tr class="odd">
<td style="text-align: left;">goal13</td>
<td style="text-align: right;">-0.592</td>
<td style="text-align: right;">-0.319</td>
<td style="text-align: right;">-0.580</td>
<td style="text-align: right;">-0.528</td>
<td style="text-align: right;">-0.355</td>
<td style="text-align: right;">-0.530</td>
<td style="text-align: right;">-0.533</td>
<td style="text-align: right;">-0.392</td>
<td style="text-align: right;">-0.689</td>
<td style="text-align: right;">-0.287</td>
<td style="text-align: right;">-0.565</td>
<td style="text-align: right;">0.860</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">-0.150</td>
<td style="text-align: right;">-0.472</td>
<td style="text-align: right;">0.018</td>
</tr>
<tr class="even">
<td style="text-align: left;">goal15</td>
<td style="text-align: right;">0.034</td>
<td style="text-align: right;">0.159</td>
<td style="text-align: right;">0.010</td>
<td style="text-align: right;">0.002</td>
<td style="text-align: right;">0.194</td>
<td style="text-align: right;">0.182</td>
<td style="text-align: right;">0.038</td>
<td style="text-align: right;">0.175</td>
<td style="text-align: right;">0.135</td>
<td style="text-align: right;">0.115</td>
<td style="text-align: right;">0.029</td>
<td style="text-align: right;">-0.162</td>
<td style="text-align: right;">-0.150</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.183</td>
<td style="text-align: right;">-0.105</td>
</tr>
<tr class="odd">
<td style="text-align: left;">goal16</td>
<td style="text-align: right;">0.594</td>
<td style="text-align: right;">0.407</td>
<td style="text-align: right;">0.661</td>
<td style="text-align: right;">0.489</td>
<td style="text-align: right;">0.361</td>
<td style="text-align: right;">0.574</td>
<td style="text-align: right;">0.544</td>
<td style="text-align: right;">0.419</td>
<td style="text-align: right;">0.575</td>
<td style="text-align: right;">0.289</td>
<td style="text-align: right;">0.650</td>
<td style="text-align: right;">-0.645</td>
<td style="text-align: right;">-0.472</td>
<td style="text-align: right;">0.183</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">-0.106</td>
</tr>
<tr class="even">
<td style="text-align: left;">pop_affected</td>
<td style="text-align: right;">-0.066</td>
<td style="text-align: right;">-0.078</td>
<td style="text-align: right;">-0.061</td>
<td style="text-align: right;">-0.032</td>
<td style="text-align: right;">-0.146</td>
<td style="text-align: right;">-0.104</td>
<td style="text-align: right;">-0.068</td>
<td style="text-align: right;">-0.092</td>
<td style="text-align: right;">0.001</td>
<td style="text-align: right;">0.068</td>
<td style="text-align: right;">-0.104</td>
<td style="text-align: right;">0.106</td>
<td style="text-align: right;">0.018</td>
<td style="text-align: right;">-0.105</td>
<td style="text-align: right;">-0.106</td>
<td style="text-align: right;">1.000</td>
</tr>
</tbody>
</table>


</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>cor_melted <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">as.table</span>(correlation_matrix_Conflicts_Pop_Affected))</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(cor_melted) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Variable1"</span>, <span class="st">"Variable2"</span>, <span class="st">"Correlation"</span>)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> cor_melted, <span class="fu">aes</span>(Variable1, Variable2, <span class="at">fill =</span> Correlation)) <span class="sc">+</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient2</span>(<span class="at">low =</span> <span class="st">"blue"</span>, <span class="at">high =</span> <span class="st">"red"</span>, <span class="at">mid =</span> <span class="st">"white"</span>,</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>                       <span class="at">midpoint =</span> <span class="dv">0</span>, <span class="at">limit =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>), <span class="at">space =</span> <span class="st">"Lab"</span>,</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>                       <span class="at">name =</span> <span class="st">"Correlation"</span>) <span class="sc">+</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">8</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>)) <span class="sc">+</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>() <span class="sc">+</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">''</span>, <span class="at">y =</span> <span class="st">''</span>,</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">'Correlation between Conflicts Affected Population and the SDG goals'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="question3_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="focus-on-the-correlation-between-the-sdg-scores-and-the-different-events." class="level1">
<h1>Focus on the correlation between the SDG scores and the different events.</h1>
<p>Starting from what we saw with our correlation maps, we concluded that they did not have any big impact on the SDG scores per region.</p>
<p>Here you can see an extract of our correlation map between the climate disasters and the SDG goals in South and East Asia as it was the regions that where the most impacted.</p>
<div class="cell" data-layout-align="center" data-hash="question3_cache/html/unnamed-chunk-15_64e0b625eab264c0e3425719939fd0f2">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>disaster_data <span class="ot">&lt;-</span> Q3<span class="fl">.1</span>[Q3<span class="fl">.1</span><span class="sc">$</span>region <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"South Asia"</span>, <span class="st">"East Asia"</span>, <span class="st">"North America"</span>), ]</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>relevant_columns <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"goal1"</span>, <span class="st">"goal2"</span>, <span class="st">"goal3"</span>, <span class="st">"goal4"</span>, <span class="st">"goal5"</span>, <span class="st">"goal6"</span>, <span class="st">"goal7"</span>, <span class="st">"goal8"</span>, <span class="st">"goal9"</span>, <span class="st">"goal10"</span>, <span class="st">"goal11"</span>, <span class="st">"goal12"</span>, <span class="st">"goal13"</span>, <span class="st">"goal15"</span>, <span class="st">"goal16"</span>, <span class="st">"total_affected"</span>, <span class="st">"total_deaths"</span>)</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>subset_data <span class="ot">&lt;-</span> disaster_data[, relevant_columns]</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>correlation_matrix_subset <span class="ot">&lt;-</span> <span class="fu">cor</span>(subset_data[, <span class="fu">c</span>(<span class="st">"total_affected"</span>, <span class="st">"total_deaths"</span>)], subset_data)</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>cor_melted <span class="ot">&lt;-</span> reshape2<span class="sc">::</span><span class="fu">melt</span>(correlation_matrix_subset)</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(cor_melted) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Variable2"</span>, <span class="st">"Variable1"</span>, <span class="st">"Correlation"</span>)</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> cor_melted, <span class="fu">aes</span>(Variable1, Variable2, <span class="at">fill =</span> Correlation)) <span class="sc">+</span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient2</span>(<span class="at">low =</span> <span class="st">"blue"</span>, <span class="at">high =</span> <span class="st">"red"</span>, <span class="at">mid =</span> <span class="st">"white"</span>,</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>                       <span class="at">midpoint =</span> <span class="dv">0</span>, <span class="at">limit =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>), <span class="at">space =</span> <span class="st">"Lab"</span>,</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>                       <span class="at">name =</span> <span class="st">"Correlation"</span>) <span class="sc">+</span></span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>( <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">size =</span> <span class="dv">8</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>         <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">8</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>         <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">b =</span> <span class="dv">20</span>), <span class="at">hjust =</span> <span class="fl">0.5</span>, </span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">vjust =</span> <span class="dv">8</span>, <span class="at">lineheight =</span> <span class="fl">1.5</span>)</span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>() <span class="sc">+</span></span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">''</span>, <span class="at">y =</span> <span class="st">''</span>,</span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">'Correlation between the climate disasters and the SDG goals in South and East Asia and North America'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="question3_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>Here you can see an extract of our correlation map between the COVID-19 and the SDG goals.</p>
<div class="cell" data-layout-align="center" data-hash="question3_cache/html/unnamed-chunk-16_d9d84fa3afdf656438f77dc5abb88be4">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>covid_filtered <span class="ot">&lt;-</span> Q3<span class="fl">.2</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>relevant_columns <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"goal1"</span>, <span class="st">"goal2"</span>, <span class="st">"goal3"</span>, <span class="st">"goal4"</span>, <span class="st">"goal5"</span>, <span class="st">"goal6"</span>, <span class="st">"goal7"</span>, <span class="st">"goal8"</span>, <span class="st">"goal9"</span>, <span class="st">"goal10"</span>, <span class="st">"goal11"</span>, <span class="st">"goal12"</span>, <span class="st">"goal13"</span>, <span class="st">"goal15"</span>, <span class="st">"goal16"</span>, <span class="st">"stringency"</span>, <span class="st">"cases_per_million"</span>, <span class="st">"deaths_per_million"</span>)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>subset_data <span class="ot">&lt;-</span> covid_filtered[, relevant_columns]</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>correlation_matrix_Covid <span class="ot">&lt;-</span> <span class="fu">cor</span>(subset_data, subset_data[, <span class="fu">c</span>(<span class="st">"stringency"</span>, <span class="st">"cases_per_million"</span>, <span class="st">"deaths_per_million"</span>)])</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>cor_melted <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">as.table</span>(correlation_matrix_Covid))</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(cor_melted) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Variable1"</span>, <span class="st">"Variable2"</span>, <span class="st">"Correlation"</span>)</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the heatmap</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> cor_melted, <span class="fu">aes</span>(Variable1, Variable2, <span class="at">fill =</span> Correlation)) <span class="sc">+</span></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient2</span>(<span class="at">low =</span> <span class="st">"blue"</span>, <span class="at">high =</span> <span class="st">"red"</span>, <span class="at">mid =</span> <span class="st">"white"</span>,</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>                       <span class="at">midpoint =</span> <span class="dv">0</span>, <span class="at">limit =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>), <span class="at">space =</span> <span class="st">"Lab"</span>,</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>                       <span class="at">name =</span> <span class="st">"Correlation"</span>) <span class="sc">+</span></span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>( <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">size =</span> <span class="dv">8</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>         <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">8</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>         <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">b =</span> <span class="dv">20</span>), <span class="at">hjust =</span> <span class="fl">0.5</span>, </span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">vjust =</span> <span class="dv">5</span>, <span class="at">lineheight =</span> <span class="fl">1.5</span>)</span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>() <span class="sc">+</span></span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">''</span>, <span class="at">y =</span> <span class="st">''</span>,</span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">'Correlation between COVID and the SDG goals'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="question3_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" style="width:65.0%"></p>
</figure>
</div>
</div>
</div>
<p>Here you can see an extract of our correlation map between the conflicts and the SDG goals in Middle East &amp; North Africa, Sub-Saharan Africa, South Asia, Latin America &amp; the Caribbean, Eastern Europe, Caucasus and Central Asia as it was the regions that where the most impacted. We analysed this regions also for sum_deaths because it has the same touched regions than affected population.</p>
<div class="cell" data-layout-align="center" data-hash="question3_cache/html/unnamed-chunk-17_7992ade912a99be8a8b5db206171a155">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>conflicts_filtered <span class="ot">&lt;-</span> Q3<span class="fl">.3</span>[Q3<span class="fl">.3</span><span class="sc">$</span>region <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Middle East &amp; North Africa"</span>, <span class="st">"Sub-Saharan Africa"</span>, <span class="st">"South Asia"</span>, <span class="st">"Latin America &amp; the Caribbean"</span>, <span class="st">"Eastern Europe"</span>, <span class="st">"Caucasus and Central Asia"</span>), ]</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>relevant_columns <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"goal1"</span>, <span class="st">"goal2"</span>, <span class="st">"goal3"</span>, <span class="st">"goal4"</span>, <span class="st">"goal5"</span>, <span class="st">"goal6"</span>, <span class="st">"goal7"</span>, <span class="st">"goal8"</span>, <span class="st">"goal9"</span>, <span class="st">"goal10"</span>, <span class="st">"goal11"</span>, <span class="st">"goal12"</span>, <span class="st">"goal13"</span>, <span class="st">"goal15"</span>, <span class="st">"goal16"</span>, <span class="st">"pop_affected"</span>, <span class="st">"sum_deaths"</span>, <span class="st">"maxintensity"</span>)</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>subset_data <span class="ot">&lt;-</span> conflicts_filtered[, relevant_columns]</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>correlation_matrix_Conflicts_Pop_Aff <span class="ot">&lt;-</span> <span class="fu">cor</span>(subset_data, subset_data[, <span class="fu">c</span>(<span class="st">"pop_affected"</span>, <span class="st">"sum_deaths"</span>, <span class="st">"maxintensity"</span>)])</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>cor_melted <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">as.table</span>(correlation_matrix_Conflicts_Pop_Aff))</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(cor_melted) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Variable1"</span>, <span class="st">"Variable2"</span>, <span class="st">"Correlation"</span>)</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> cor_melted, <span class="fu">aes</span>(Variable1, Variable2, <span class="at">fill =</span> Correlation)) <span class="sc">+</span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient2</span>(<span class="at">low =</span> <span class="st">"blue"</span>, <span class="at">high =</span> <span class="st">"red"</span>, <span class="at">mid =</span> <span class="st">"white"</span>,</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>                       <span class="at">midpoint =</span> <span class="dv">0</span>, <span class="at">limit =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>), <span class="at">space =</span> <span class="st">"Lab"</span>,</span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>                       <span class="at">name =</span> <span class="st">"Correlation"</span>) <span class="sc">+</span></span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>( <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">size =</span> <span class="dv">8</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>         <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">8</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>         <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">b =</span> <span class="dv">20</span>), <span class="at">hjust =</span> <span class="fl">0.5</span>, </span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">vjust =</span> <span class="dv">8</span>, <span class="at">lineheight =</span> <span class="dv">2</span>)</span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>() <span class="sc">+</span></span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">''</span>, <span class="at">y =</span> <span class="st">''</span>,</span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">'Correlation between Conflicts Affected Population &amp; Deths and the SDG goals'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="question3_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" style="width:65.0%"></p>
</figure>
</div>
</div>
</div>
<p>After looking at almost the same results, we asked ourselves if the fact that we do not see any correlations is because the consequences of this disasters arrive later on, so we decided to remake the same correlations with 1 year gap.</p>
</section>
<section id="correlations-for-each-event-with-one-year-gap" class="level1">
<h1>Correlations for each event with one year gap</h1>
<p>Here you can see for example our correlation map between the climate disasters and the SDG goals in South and East Asia with one year gap.</p>
<div class="cell" data-layout-align="center" data-hash="question3_cache/html/unnamed-chunk-18_47f10fa50e2889322577440937ddb3d1">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>disaster_data <span class="ot">&lt;-</span> Q3<span class="fl">.1</span>[Q3<span class="fl">.1</span><span class="sc">$</span>region <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"South Asia"</span>, <span class="st">"East Asia"</span>, <span class="st">" North America"</span>), ]</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>relevant_columns <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"goal1"</span>, <span class="st">"goal2"</span>, <span class="st">"goal3"</span>, <span class="st">"goal4"</span>, <span class="st">"goal5"</span>, <span class="st">"goal6"</span>, <span class="st">"goal7"</span>, <span class="st">"goal8"</span>, <span class="st">"goal9"</span>, <span class="st">"goal10"</span>, <span class="st">"goal11"</span>, <span class="st">"goal12"</span>, <span class="st">"goal13"</span>, <span class="st">"goal15"</span>, <span class="st">"goal16"</span>, <span class="st">"total_affected"</span>, <span class="st">"total_deaths"</span>)</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>subset_data <span class="ot">&lt;-</span> disaster_data[, relevant_columns]</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>lagged_subset_data <span class="ot">&lt;-</span> subset_data <span class="sc">%&gt;%</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">lagged_total_affected =</span> <span class="fu">lag</span>(total_affected, <span class="at">default =</span> <span class="cn">NA</span>),</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">lagged_total_deaths =</span> <span class="fu">lag</span>(total_deaths, <span class="at">default =</span> <span class="cn">NA</span>)</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>correlation_matrix_lagged <span class="ot">&lt;-</span> <span class="fu">cor</span>(lagged_subset_data[, <span class="fu">c</span>(<span class="st">"lagged_total_affected"</span>, <span class="st">"lagged_total_deaths"</span>)], subset_data)</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>cor_melted_lagged <span class="ot">&lt;-</span> reshape2<span class="sc">::</span><span class="fu">melt</span>(correlation_matrix_lagged)</span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(cor_melted_lagged) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Variable2"</span>, <span class="st">"Variable1"</span>, <span class="st">"Correlation"</span>)</span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> cor_melted_lagged, <span class="fu">aes</span>(Variable1, Variable2, <span class="at">fill =</span> Correlation)) <span class="sc">+</span></span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient2</span>(<span class="at">low =</span> <span class="st">"blue"</span>, <span class="at">high =</span> <span class="st">"red"</span>, <span class="at">mid =</span> <span class="st">"white"</span>,</span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a>                       <span class="at">midpoint =</span> <span class="dv">0</span>, <span class="at">limit =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>), <span class="at">space =</span> <span class="st">"Lab"</span>,</span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a>                       <span class="at">name =</span> <span class="st">"Correlation"</span>) <span class="sc">+</span></span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>( <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">size =</span> <span class="dv">8</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a>         <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">8</span>, <span class="at">hjust =</span> <span class="dv">2</span>),</span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a>         <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">b =</span> <span class="dv">20</span>), <span class="at">hjust =</span> <span class="fl">0.5</span>, </span>
<span id="cb22-28"><a href="#cb22-28" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">vjust =</span> <span class="dv">6</span>, <span class="at">lineheight =</span> <span class="fl">1.5</span>)</span>
<span id="cb22-29"><a href="#cb22-29" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb22-30"><a href="#cb22-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>() <span class="sc">+</span></span>
<span id="cb22-31"><a href="#cb22-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">''</span>, <span class="at">y =</span> <span class="st">''</span>,</span>
<span id="cb22-32"><a href="#cb22-32" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">'Correlation between the climate disasters and the SDG goals in South and East Asia with 1 year gap'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="question3_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>Even with a year gap it doesn’t seem that climate disaster with such consequences as the population that gets affected and dies has an impact on the SDG scores as we would have though. But we are still a little bit optimistic and though why not look at the correlations with a gap year over the years.</p>
</section>
<section id="interactive-map-of-the-correlation-between-the-different-events-and-the-sdg-goals-with-1-year-gap." class="level1">
<h1>Interactive map of the correlation between the different events and the SDG goals with 1 year gap.</h1>
<p>Here you can see an interactive map of the correlation between the climate disasters and the SDG goals in South and East Asia with 1 year gap. To better understand the results, if we select a specific year (e.g., 2020) in the app, the analysis will show correlations between the SDG scores for the selected year (e.g., 2020) and the disaster-related variables (total_affected and total_deaths) from the previous year (e.g., 2019). results -&gt; nothing?</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(shiny)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>Q3<span class="fl">.1</span> <span class="ot">&lt;-</span> Q3<span class="fl">.1</span> <span class="sc">%&gt;%</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(code,year)<span class="sc">%&gt;%</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(code)</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>disaster_data <span class="ot">&lt;-</span> Q3<span class="fl">.1</span>[Q3<span class="fl">.1</span><span class="sc">$</span>region <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"South Asia"</span>, <span class="st">"East Asia"</span>, <span class="st">"North America"</span>), ]</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>relevant_columns <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"goal1"</span>, <span class="st">"goal2"</span>, <span class="st">"goal3"</span>, <span class="st">"goal4"</span>, <span class="st">"goal5"</span>, <span class="st">"goal6"</span>, <span class="st">"goal7"</span>, <span class="st">"goal8"</span>, <span class="st">"goal9"</span>, <span class="st">"goal10"</span>, <span class="st">"goal11"</span>, <span class="st">"goal12"</span>, <span class="st">"goal13"</span>, <span class="st">"goal15"</span>, <span class="st">"goal16"</span>, <span class="st">"total_affected"</span>, <span class="st">"total_deaths"</span>)</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>subset_data <span class="ot">&lt;-</span> disaster_data[, relevant_columns]</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>lagged_subset_data <span class="ot">&lt;-</span> subset_data <span class="sc">%&gt;%</span></span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">lagged_total_affected =</span> <span class="fu">lag</span>(total_affected, <span class="at">default =</span> <span class="cn">NA</span>),</span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">lagged_total_deaths =</span> <span class="fu">lag</span>(total_deaths, <span class="at">default =</span> <span class="cn">NA</span>)</span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a>correlation_matrix_lagged <span class="ot">&lt;-</span> <span class="fu">cor</span>(lagged_subset_data[, <span class="fu">c</span>(<span class="st">"lagged_total_affected"</span>, <span class="st">"lagged_total_deaths"</span>)], subset_data)</span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a>cor_melted_lagged <span class="ot">&lt;-</span> reshape2<span class="sc">::</span><span class="fu">melt</span>(correlation_matrix_lagged)</span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(cor_melted_lagged) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Variable2"</span>, <span class="st">"Variable1"</span>, <span class="st">"Correlation"</span>)</span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a>ui <span class="ot">&lt;-</span> <span class="fu">fluidPage</span>(</span>
<span id="cb23-27"><a href="#cb23-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">titlePanel</span>(<span class="st">"Interactive Correlation Heatmap between the climate disasters and the SDG goals in South and East Asia with 1 year gap"</span>),</span>
<span id="cb23-28"><a href="#cb23-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plotlyOutput</span>(<span class="st">"heatmap"</span>),</span>
<span id="cb23-29"><a href="#cb23-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sliderInput</span>(<span class="st">"year"</span>, <span class="st">"Select Year"</span>, <span class="at">min =</span> <span class="dv">2000</span>, <span class="at">max =</span> <span class="dv">2021</span>, <span class="at">value =</span> <span class="dv">2012</span>, <span class="at">step =</span> <span class="dv">1</span>),</span>
<span id="cb23-30"><a href="#cb23-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">verbatimTextOutput</span>(<span class="st">"correlation_output"</span>) </span>
<span id="cb23-31"><a href="#cb23-31" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb23-32"><a href="#cb23-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-33"><a href="#cb23-33" aria-hidden="true" tabindex="-1"></a>server <span class="ot">&lt;-</span> <span class="cf">function</span>(input, output) {</span>
<span id="cb23-34"><a href="#cb23-34" aria-hidden="true" tabindex="-1"></a>  selected_data <span class="ot">&lt;-</span> <span class="fu">reactive</span>({</span>
<span id="cb23-35"><a href="#cb23-35" aria-hidden="true" tabindex="-1"></a>    filtered_data <span class="ot">&lt;-</span> disaster_data[disaster_data<span class="sc">$</span>year <span class="sc">==</span> input<span class="sc">$</span>year, ]</span>
<span id="cb23-36"><a href="#cb23-36" aria-hidden="true" tabindex="-1"></a>    subset_data <span class="ot">&lt;-</span> filtered_data[, relevant_columns]</span>
<span id="cb23-37"><a href="#cb23-37" aria-hidden="true" tabindex="-1"></a>    lagged_subset_data <span class="ot">&lt;-</span> subset_data <span class="sc">%&gt;%</span></span>
<span id="cb23-38"><a href="#cb23-38" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(</span>
<span id="cb23-39"><a href="#cb23-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">lagged_total_affected =</span> <span class="fu">lag</span>(total_affected, <span class="at">default =</span> <span class="cn">NA</span>),</span>
<span id="cb23-40"><a href="#cb23-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">lagged_total_deaths =</span> <span class="fu">lag</span>(total_deaths, <span class="at">default =</span> <span class="cn">NA</span>)</span>
<span id="cb23-41"><a href="#cb23-41" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb23-42"><a href="#cb23-42" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb23-43"><a href="#cb23-43" aria-hidden="true" tabindex="-1"></a>    correlation_matrix_lagged <span class="ot">&lt;-</span> <span class="fu">cor</span>(lagged_subset_data[, <span class="fu">c</span>(<span class="st">"lagged_total_affected"</span>, <span class="st">"lagged_total_deaths"</span>)], subset_data)</span>
<span id="cb23-44"><a href="#cb23-44" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb23-45"><a href="#cb23-45" aria-hidden="true" tabindex="-1"></a>    cor_melted_lagged <span class="ot">&lt;-</span> reshape2<span class="sc">::</span><span class="fu">melt</span>(correlation_matrix_lagged)</span>
<span id="cb23-46"><a href="#cb23-46" aria-hidden="true" tabindex="-1"></a>    <span class="fu">names</span>(cor_melted_lagged) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Variable2"</span>, <span class="st">"Variable1"</span>, <span class="st">"Correlation"</span>)</span>
<span id="cb23-47"><a href="#cb23-47" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb23-48"><a href="#cb23-48" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(cor_melted_lagged)</span>
<span id="cb23-49"><a href="#cb23-49" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb23-50"><a href="#cb23-50" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-51"><a href="#cb23-51" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>heatmap <span class="ot">&lt;-</span> <span class="fu">renderPlotly</span>({</span>
<span id="cb23-52"><a href="#cb23-52" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(<span class="at">data =</span> <span class="fu">selected_data</span>(), <span class="at">x =</span> <span class="sc">~</span>Variable1, <span class="at">y =</span> <span class="sc">~</span>Variable2, <span class="at">z =</span> <span class="sc">~</span>Correlation, </span>
<span id="cb23-53"><a href="#cb23-53" aria-hidden="true" tabindex="-1"></a>                 <span class="at">type =</span> <span class="st">"heatmap"</span>, <span class="at">colorscale =</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="st">"blue"</span>), <span class="fu">c</span>(<span class="dv">0</span>, <span class="st">"white"</span>), <span class="fu">c</span>(<span class="dv">1</span>, <span class="st">"red"</span>)),</span>
<span id="cb23-54"><a href="#cb23-54" aria-hidden="true" tabindex="-1"></a>                 <span class="at">zmin =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">zmax =</span> <span class="dv">1</span>)</span>
<span id="cb23-55"><a href="#cb23-55" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb23-56"><a href="#cb23-56" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> p <span class="sc">%&gt;%</span> <span class="fu">layout</span>(</span>
<span id="cb23-57"><a href="#cb23-57" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="st">""</span>,</span>
<span id="cb23-58"><a href="#cb23-58" aria-hidden="true" tabindex="-1"></a>      <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">""</span>),</span>
<span id="cb23-59"><a href="#cb23-59" aria-hidden="true" tabindex="-1"></a>      <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">""</span>),</span>
<span id="cb23-60"><a href="#cb23-60" aria-hidden="true" tabindex="-1"></a>      <span class="at">coloraxis =</span> <span class="fu">list</span>(</span>
<span id="cb23-61"><a href="#cb23-61" aria-hidden="true" tabindex="-1"></a>        <span class="at">colorbar =</span> <span class="fu">list</span>(</span>
<span id="cb23-62"><a href="#cb23-62" aria-hidden="true" tabindex="-1"></a>          <span class="at">title =</span> <span class="st">"Correlation"</span>,  </span>
<span id="cb23-63"><a href="#cb23-63" aria-hidden="true" tabindex="-1"></a>          <span class="at">tickvals =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),  </span>
<span id="cb23-64"><a href="#cb23-64" aria-hidden="true" tabindex="-1"></a>          <span class="at">ticktext =</span> <span class="fu">c</span>(<span class="st">"-1"</span>, <span class="st">"0"</span>, <span class="st">"1"</span>),</span>
<span id="cb23-65"><a href="#cb23-65" aria-hidden="true" tabindex="-1"></a>          <span class="at">len =</span> <span class="dv">5</span>,</span>
<span id="cb23-66"><a href="#cb23-66" aria-hidden="true" tabindex="-1"></a>          <span class="at">thickness =</span> <span class="dv">20</span>,</span>
<span id="cb23-67"><a href="#cb23-67" aria-hidden="true" tabindex="-1"></a>          <span class="at">x =</span> <span class="dv">0</span>,</span>
<span id="cb23-68"><a href="#cb23-68" aria-hidden="true" tabindex="-1"></a>          <span class="at">xanchor =</span> <span class="st">"left"</span>,</span>
<span id="cb23-69"><a href="#cb23-69" aria-hidden="true" tabindex="-1"></a>          <span class="at">ticks =</span> <span class="st">"outside"</span> </span>
<span id="cb23-70"><a href="#cb23-70" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb23-71"><a href="#cb23-71" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb23-72"><a href="#cb23-72" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb23-73"><a href="#cb23-73" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(p)</span>
<span id="cb23-74"><a href="#cb23-74" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb23-75"><a href="#cb23-75" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb23-76"><a href="#cb23-76" aria-hidden="true" tabindex="-1"></a><span class="fu">shinyApp</span>(<span class="at">ui =</span> ui, <span class="at">server =</span> server)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p></p><div style="width: 100% ; height: 400px ; text-align: center; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box;" class="muted well">Shiny applications not supported in static R Markdown documents</div><p></p>
</div>
</div>
<p>here you can see an interactive map of the correlation between COVID-19 and the SDG goals with 1 year gap. And strangely, instead of having a negative correlation, we expected that the more cases and deaths happened because of COVID-19, the scores of the SDG would be negatively affected,but with the gap year we can see that the scores of the Goal3, Goal6, Goal9 and Goal16 are quite positively impacted by the COVID-19.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(shiny)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>Q3<span class="fl">.2</span> <span class="ot">&lt;-</span> Q3<span class="fl">.2</span> <span class="sc">%&gt;%</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(code,year)<span class="sc">%&gt;%</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(code)</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>Q3<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="fu">here</span>(<span class="st">"scripts"</span>, <span class="st">"data"</span>, <span class="st">"data_question3_2.csv"</span>))</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>covid_filtered <span class="ot">&lt;-</span> Q3<span class="fl">.2</span></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>relevant_columns <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"goal1"</span>, <span class="st">"goal2"</span>, <span class="st">"goal3"</span>, <span class="st">"goal4"</span>, <span class="st">"goal5"</span>, <span class="st">"goal6"</span>, <span class="st">"goal7"</span>, <span class="st">"goal8"</span>, <span class="st">"goal9"</span>, <span class="st">"goal10"</span>, <span class="st">"goal11"</span>, <span class="st">"goal12"</span>, <span class="st">"goal13"</span>, <span class="st">"goal15"</span>, <span class="st">"goal16"</span>, <span class="st">"stringency"</span>, <span class="st">"cases_per_million"</span>, <span class="st">"deaths_per_million"</span>)</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>subset_data <span class="ot">&lt;-</span> covid_filtered[, relevant_columns]</span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>correlation_matrix_Covid <span class="ot">&lt;-</span> <span class="fu">cor</span>(subset_data, subset_data[, <span class="fu">c</span>(<span class="st">"stringency"</span>, <span class="st">"cases_per_million"</span>, <span class="st">"deaths_per_million"</span>)])</span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>cor_melted <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">as.table</span>(correlation_matrix_Covid))</span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(cor_melted) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Variable1"</span>, <span class="st">"Variable2"</span>, <span class="st">"Correlation"</span>)</span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a>ui <span class="ot">&lt;-</span> <span class="fu">fluidPage</span>(</span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">titlePanel</span>(<span class="st">"Interactive Correlation Heatmap between COVID and the SDG goal with one year gap"</span>),</span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plotlyOutput</span>(<span class="st">"heatmap"</span>),</span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sliderInput</span>(<span class="st">"year"</span>, <span class="st">"Select Year"</span>, <span class="at">min =</span> <span class="dv">2020</span>, <span class="at">max =</span> <span class="dv">2022</span>, <span class="at">value =</span> <span class="dv">2020</span>, <span class="at">step =</span> <span class="dv">1</span>)</span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a>server <span class="ot">&lt;-</span> <span class="cf">function</span>(input, output) {</span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a>  selected_covid_data <span class="ot">&lt;-</span> <span class="fu">reactive</span>({</span>
<span id="cb24-29"><a href="#cb24-29" aria-hidden="true" tabindex="-1"></a>    filtered_data <span class="ot">&lt;-</span> covid_filtered[covid_filtered<span class="sc">$</span>year <span class="sc">==</span> input<span class="sc">$</span>year, ]</span>
<span id="cb24-30"><a href="#cb24-30" aria-hidden="true" tabindex="-1"></a>    subset_data <span class="ot">&lt;-</span> filtered_data[, relevant_columns]</span>
<span id="cb24-31"><a href="#cb24-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(subset_data)</span>
<span id="cb24-32"><a href="#cb24-32" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb24-33"><a href="#cb24-33" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb24-34"><a href="#cb24-34" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>heatmap <span class="ot">&lt;-</span> <span class="fu">renderPlotly</span>({</span>
<span id="cb24-35"><a href="#cb24-35" aria-hidden="true" tabindex="-1"></a>    correlation_matrix_Covid <span class="ot">&lt;-</span> <span class="fu">cor</span>(<span class="fu">selected_covid_data</span>(), <span class="fu">selected_covid_data</span>()[, <span class="fu">c</span>(<span class="st">"stringency"</span>, <span class="st">"cases_per_million"</span>, <span class="st">"deaths_per_million"</span>)])</span>
<span id="cb24-36"><a href="#cb24-36" aria-hidden="true" tabindex="-1"></a>    cor_melted <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">as.table</span>(correlation_matrix_Covid))</span>
<span id="cb24-37"><a href="#cb24-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">names</span>(cor_melted) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Variable1"</span>, <span class="st">"Variable2"</span>, <span class="st">"Correlation"</span>)</span>
<span id="cb24-38"><a href="#cb24-38" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb24-39"><a href="#cb24-39" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(<span class="at">data =</span> cor_melted, <span class="at">x =</span> <span class="sc">~</span>Variable1, <span class="at">y =</span> <span class="sc">~</span>Variable2, <span class="at">z =</span> <span class="sc">~</span>Correlation,</span>
<span id="cb24-40"><a href="#cb24-40" aria-hidden="true" tabindex="-1"></a>                 <span class="at">type =</span> <span class="st">"heatmap"</span>, <span class="at">colorscale =</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="st">"blue"</span>), <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="st">"white"</span>), <span class="fu">c</span>(<span class="dv">1</span>, <span class="st">"red"</span>)),</span>
<span id="cb24-41"><a href="#cb24-41" aria-hidden="true" tabindex="-1"></a>                 <span class="at">zmin =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">zmax =</span> <span class="dv">1</span>)</span>
<span id="cb24-42"><a href="#cb24-42" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb24-43"><a href="#cb24-43" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> p <span class="sc">%&gt;%</span> <span class="fu">layout</span>(</span>
<span id="cb24-44"><a href="#cb24-44" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="st">""</span>,</span>
<span id="cb24-45"><a href="#cb24-45" aria-hidden="true" tabindex="-1"></a>      <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">""</span>),</span>
<span id="cb24-46"><a href="#cb24-46" aria-hidden="true" tabindex="-1"></a>      <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">""</span>),</span>
<span id="cb24-47"><a href="#cb24-47" aria-hidden="true" tabindex="-1"></a>      <span class="at">coloraxis =</span> <span class="fu">list</span>(</span>
<span id="cb24-48"><a href="#cb24-48" aria-hidden="true" tabindex="-1"></a>        <span class="at">colorbar =</span> <span class="fu">list</span>(</span>
<span id="cb24-49"><a href="#cb24-49" aria-hidden="true" tabindex="-1"></a>          <span class="at">title =</span> <span class="st">"Correlation"</span>,</span>
<span id="cb24-50"><a href="#cb24-50" aria-hidden="true" tabindex="-1"></a>          <span class="at">tickvals =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>), </span>
<span id="cb24-51"><a href="#cb24-51" aria-hidden="true" tabindex="-1"></a>          <span class="at">ticktext =</span> <span class="fu">c</span>(<span class="st">"-1"</span>, <span class="st">"0"</span>, <span class="st">"1"</span>),</span>
<span id="cb24-52"><a href="#cb24-52" aria-hidden="true" tabindex="-1"></a>          <span class="at">len =</span> <span class="dv">5</span>, </span>
<span id="cb24-53"><a href="#cb24-53" aria-hidden="true" tabindex="-1"></a>          <span class="at">thickness =</span> <span class="dv">20</span>, </span>
<span id="cb24-54"><a href="#cb24-54" aria-hidden="true" tabindex="-1"></a>          <span class="at">x =</span> <span class="dv">0</span>,</span>
<span id="cb24-55"><a href="#cb24-55" aria-hidden="true" tabindex="-1"></a>          <span class="at">xanchor =</span> <span class="st">"left"</span>, </span>
<span id="cb24-56"><a href="#cb24-56" aria-hidden="true" tabindex="-1"></a>          <span class="at">ticks =</span> <span class="st">"outside"</span></span>
<span id="cb24-57"><a href="#cb24-57" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb24-58"><a href="#cb24-58" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb24-59"><a href="#cb24-59" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb24-60"><a href="#cb24-60" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(p)</span>
<span id="cb24-61"><a href="#cb24-61" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb24-62"><a href="#cb24-62" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb24-63"><a href="#cb24-63" aria-hidden="true" tabindex="-1"></a><span class="fu">shinyApp</span>(<span class="at">ui =</span> ui, <span class="at">server =</span> server)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p></p><div style="width: 100% ; height: 400px ; text-align: center; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box;" class="muted well">Shiny applications not supported in static R Markdown documents</div><p></p>
</div>
</div>
<p>Finally, here you can see an interactive map of the correlation between Conflict and the SDG goals with 1 year gap. Nothing?</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(shiny)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>Q3<span class="fl">.3</span> <span class="ot">&lt;-</span> Q3<span class="fl">.3</span> <span class="sc">%&gt;%</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(code,year)<span class="sc">%&gt;%</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(code)</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>conflicts_filtered <span class="ot">&lt;-</span> Q3<span class="fl">.3</span>[Q3<span class="fl">.3</span><span class="sc">$</span>region <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Middle East &amp; North Africa"</span>, <span class="st">"Sub-Saharan Africa"</span>, <span class="st">"South Asia"</span>, <span class="st">"Latin America &amp; the Caribbean"</span>, <span class="st">"Eastern Europe"</span>, <span class="st">"Caucasus and Central Asia"</span>), ]</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>relevant_columns <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"goal1"</span>, <span class="st">"goal2"</span>, <span class="st">"goal3"</span>, <span class="st">"goal4"</span>, <span class="st">"goal5"</span>, <span class="st">"goal6"</span>, <span class="st">"goal7"</span>, <span class="st">"goal8"</span>, <span class="st">"goal9"</span>, <span class="st">"goal10"</span>, <span class="st">"goal11"</span>, <span class="st">"goal12"</span>, <span class="st">"goal13"</span>, <span class="st">"goal15"</span>, <span class="st">"goal16"</span>, <span class="st">"pop_affected"</span>, <span class="st">"sum_deaths"</span>, <span class="st">"maxintensity"</span>)</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>subset_data <span class="ot">&lt;-</span> conflicts_filtered[, relevant_columns]</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>correlation_matrix_Conflicts_Pop_Aff <span class="ot">&lt;-</span> <span class="fu">cor</span>(subset_data, subset_data[, <span class="fu">c</span>(<span class="st">"pop_affected"</span>, <span class="st">"sum_deaths"</span>, <span class="st">"maxintensity"</span>)])</span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>cor_melted <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">as.table</span>(correlation_matrix_Conflicts_Pop_Aff))</span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(cor_melted) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Variable1"</span>, <span class="st">"Variable2"</span>, <span class="st">"Correlation"</span>)</span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>ui <span class="ot">&lt;-</span> <span class="fu">fluidPage</span>(</span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">titlePanel</span>(<span class="st">"Interactive Correlation Heatmap between Conflicts in selected regions and the SDG goal with one year gap"</span>),</span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plotlyOutput</span>(<span class="st">"heatmap"</span>),</span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sliderInput</span>(<span class="st">"year"</span>, <span class="st">"Select Year"</span>, <span class="at">min =</span> <span class="dv">2000</span>, <span class="at">max =</span> <span class="dv">2016</span>, <span class="at">value =</span> <span class="dv">2005</span>, <span class="at">step =</span> <span class="dv">1</span>)</span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a>server <span class="ot">&lt;-</span> <span class="cf">function</span>(input, output) {</span>
<span id="cb25-27"><a href="#cb25-27" aria-hidden="true" tabindex="-1"></a>  selected_conflicts_data <span class="ot">&lt;-</span> <span class="fu">reactive</span>({</span>
<span id="cb25-28"><a href="#cb25-28" aria-hidden="true" tabindex="-1"></a>    filtered_data <span class="ot">&lt;-</span> conflicts_filtered[conflicts_filtered<span class="sc">$</span>year <span class="sc">==</span> input<span class="sc">$</span>year, ]</span>
<span id="cb25-29"><a href="#cb25-29" aria-hidden="true" tabindex="-1"></a>    subset_data <span class="ot">&lt;-</span> filtered_data[, relevant_columns]</span>
<span id="cb25-30"><a href="#cb25-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(subset_data)</span>
<span id="cb25-31"><a href="#cb25-31" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb25-32"><a href="#cb25-32" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb25-33"><a href="#cb25-33" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>heatmap <span class="ot">&lt;-</span> <span class="fu">renderPlotly</span>({</span>
<span id="cb25-34"><a href="#cb25-34" aria-hidden="true" tabindex="-1"></a>    correlation_matrix_Conflicts_Pop_Aff <span class="ot">&lt;-</span> <span class="fu">cor</span>(<span class="fu">selected_conflicts_data</span>(), <span class="fu">selected_conflicts_data</span>()[, <span class="fu">c</span>(<span class="st">"pop_affected"</span>, <span class="st">"sum_deaths"</span>, <span class="st">"maxintensity"</span>)])</span>
<span id="cb25-35"><a href="#cb25-35" aria-hidden="true" tabindex="-1"></a>    cor_melted <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">as.table</span>(correlation_matrix_Conflicts_Pop_Aff))</span>
<span id="cb25-36"><a href="#cb25-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">names</span>(cor_melted) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Variable1"</span>, <span class="st">"Variable2"</span>, <span class="st">"Correlation"</span>)</span>
<span id="cb25-37"><a href="#cb25-37" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb25-38"><a href="#cb25-38" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(<span class="at">data =</span> cor_melted, <span class="at">x =</span> <span class="sc">~</span>Variable1, <span class="at">y =</span> <span class="sc">~</span>Variable2, <span class="at">z =</span> <span class="sc">~</span>Correlation,</span>
<span id="cb25-39"><a href="#cb25-39" aria-hidden="true" tabindex="-1"></a>                 <span class="at">type =</span> <span class="st">"heatmap"</span>, <span class="at">colorscale =</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="st">"blue"</span>), <span class="fu">c</span>(<span class="dv">0</span>, <span class="st">"white"</span>), <span class="fu">c</span>(<span class="dv">1</span>, <span class="st">"red"</span>)),</span>
<span id="cb25-40"><a href="#cb25-40" aria-hidden="true" tabindex="-1"></a>                 <span class="at">zmin =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">zmax =</span> <span class="dv">1</span>)</span>
<span id="cb25-41"><a href="#cb25-41" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb25-42"><a href="#cb25-42" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> p <span class="sc">%&gt;%</span> <span class="fu">layout</span>(</span>
<span id="cb25-43"><a href="#cb25-43" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="st">""</span>,</span>
<span id="cb25-44"><a href="#cb25-44" aria-hidden="true" tabindex="-1"></a>      <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">""</span>),</span>
<span id="cb25-45"><a href="#cb25-45" aria-hidden="true" tabindex="-1"></a>      <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">""</span>),</span>
<span id="cb25-46"><a href="#cb25-46" aria-hidden="true" tabindex="-1"></a>      <span class="at">coloraxis =</span> <span class="fu">list</span>(</span>
<span id="cb25-47"><a href="#cb25-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">colorbar =</span> <span class="fu">list</span>(</span>
<span id="cb25-48"><a href="#cb25-48" aria-hidden="true" tabindex="-1"></a>          <span class="at">title =</span> <span class="st">"Correlation"</span>,</span>
<span id="cb25-49"><a href="#cb25-49" aria-hidden="true" tabindex="-1"></a>          <span class="at">tickvals =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>), </span>
<span id="cb25-50"><a href="#cb25-50" aria-hidden="true" tabindex="-1"></a>          <span class="at">ticktext =</span> <span class="fu">c</span>(<span class="st">"-1"</span>, <span class="st">"0"</span>, <span class="st">"1"</span>), </span>
<span id="cb25-51"><a href="#cb25-51" aria-hidden="true" tabindex="-1"></a>          <span class="at">len =</span> <span class="dv">5</span>,  </span>
<span id="cb25-52"><a href="#cb25-52" aria-hidden="true" tabindex="-1"></a>          <span class="at">thickness =</span> <span class="dv">20</span>,  </span>
<span id="cb25-53"><a href="#cb25-53" aria-hidden="true" tabindex="-1"></a>          <span class="at">x =</span> <span class="dv">0</span>,  </span>
<span id="cb25-54"><a href="#cb25-54" aria-hidden="true" tabindex="-1"></a>          <span class="at">xanchor =</span> <span class="st">"left"</span>, </span>
<span id="cb25-55"><a href="#cb25-55" aria-hidden="true" tabindex="-1"></a>          <span class="at">ticks =</span> <span class="st">"outside"</span> </span>
<span id="cb25-56"><a href="#cb25-56" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb25-57"><a href="#cb25-57" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb25-58"><a href="#cb25-58" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb25-59"><a href="#cb25-59" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(p)</span>
<span id="cb25-60"><a href="#cb25-60" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb25-61"><a href="#cb25-61" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb25-62"><a href="#cb25-62" aria-hidden="true" tabindex="-1"></a><span class="fu">shinyApp</span>(<span class="at">ui =</span> ui, <span class="at">server =</span> server)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p></p><div style="width: 100% ; height: 400px ; text-align: center; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box;" class="muted well">Shiny applications not supported in static R Markdown documents</div><p></p>
</div>
</div>
<p>The results seems logic because if the SDG scores continue to go higher and the conflicts remains the same or finishes we get a negative correlation</p>
<p>Our last idea is to see the regressions between the SDG scores and the variables of each event that we thought interesting.</p>
</section>
<section id="regressions-between-the-sdg-scores-and-the-events-variables." class="level1">
<h1>Regressions between the SDG scores and the events variables.</h1>
<p>Let’s see the regressions for each score depending of each variable in the disasters dataset (total_affected and total_deaths)</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(shiny)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>disaster_data <span class="ot">&lt;-</span> Q3<span class="fl">.1</span>[Q3<span class="fl">.1</span><span class="sc">$</span>region <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"South Asia"</span>, <span class="st">"East Asia"</span>, <span class="st">"North America"</span>), ]</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>relevant_columns <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"goal1"</span>, <span class="st">"goal2"</span>, <span class="st">"goal3"</span>, <span class="st">"goal4"</span>, <span class="st">"goal5"</span>, <span class="st">"goal6"</span>, <span class="st">"goal7"</span>, <span class="st">"goal8"</span>, <span class="st">"goal9"</span>, <span class="st">"goal10"</span>, <span class="st">"goal11"</span>, <span class="st">"goal12"</span>, <span class="st">"goal13"</span>, <span class="st">"goal15"</span>, <span class="st">"goal16"</span>, <span class="st">"total_affected"</span>, <span class="st">"total_deaths"</span>)</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>subset_data <span class="ot">&lt;-</span> disaster_data[, relevant_columns]</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>goal_columns <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"goal1"</span>, <span class="st">"goal2"</span>, <span class="st">"goal3"</span>, <span class="st">"goal4"</span>, <span class="st">"goal5"</span>, <span class="st">"goal6"</span>, <span class="st">"goal7"</span>, <span class="st">"goal8"</span>, <span class="st">"goal9"</span>, <span class="st">"goal10"</span>, <span class="st">"goal11"</span>, <span class="st">"goal12"</span>, <span class="st">"goal13"</span>, <span class="st">"goal15"</span>, <span class="st">"goal16"</span>)</span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>ui <span class="ot">&lt;-</span> <span class="fu">fluidPage</span>(</span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">titlePanel</span>(<span class="st">"SDG and Climate Disasters Regression Analysis"</span>),</span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sidebarLayout</span>(</span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sidebarPanel</span>(</span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>      <span class="fu">selectInput</span>(<span class="st">"sdg"</span>, <span class="st">"Select SDG Goal:"</span>,</span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a>                  <span class="at">choices =</span> goal_columns,</span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a>                  <span class="at">selected =</span> goal_columns[<span class="dv">1</span>]),</span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a>      <span class="at">width =</span> <span class="dv">3</span></span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb26-25"><a href="#cb26-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mainPanel</span>(</span>
<span id="cb26-26"><a href="#cb26-26" aria-hidden="true" tabindex="-1"></a>      <span class="at">width =</span> <span class="dv">9</span>,</span>
<span id="cb26-27"><a href="#cb26-27" aria-hidden="true" tabindex="-1"></a>      <span class="fu">plotOutput</span>(<span class="st">"regression_plot_affected"</span>),</span>
<span id="cb26-28"><a href="#cb26-28" aria-hidden="true" tabindex="-1"></a>      <span class="fu">plotOutput</span>(<span class="st">"regression_plot_deaths"</span>)</span>
<span id="cb26-29"><a href="#cb26-29" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb26-30"><a href="#cb26-30" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb26-31"><a href="#cb26-31" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb26-32"><a href="#cb26-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-33"><a href="#cb26-33" aria-hidden="true" tabindex="-1"></a>server <span class="ot">&lt;-</span> <span class="cf">function</span>(input, output) {</span>
<span id="cb26-34"><a href="#cb26-34" aria-hidden="true" tabindex="-1"></a>  generate_regression_plot <span class="ot">&lt;-</span> <span class="cf">function</span>(selected_goal) {</span>
<span id="cb26-35"><a href="#cb26-35" aria-hidden="true" tabindex="-1"></a>    formula_affected <span class="ot">&lt;-</span> <span class="fu">as.formula</span>(<span class="fu">paste</span>(selected_goal, <span class="st">"~ total_affected"</span>))</span>
<span id="cb26-36"><a href="#cb26-36" aria-hidden="true" tabindex="-1"></a>    formula_deaths <span class="ot">&lt;-</span> <span class="fu">as.formula</span>(<span class="fu">paste</span>(selected_goal, <span class="st">"~ total_deaths"</span>))</span>
<span id="cb26-37"><a href="#cb26-37" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb26-38"><a href="#cb26-38" aria-hidden="true" tabindex="-1"></a>    lm_total_affected <span class="ot">&lt;-</span> <span class="fu">lm</span>(formula_affected, <span class="at">data =</span> subset_data)</span>
<span id="cb26-39"><a href="#cb26-39" aria-hidden="true" tabindex="-1"></a>    lm_total_deaths <span class="ot">&lt;-</span> <span class="fu">lm</span>(formula_deaths, <span class="at">data =</span> subset_data)</span>
<span id="cb26-40"><a href="#cb26-40" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb26-41"><a href="#cb26-41" aria-hidden="true" tabindex="-1"></a>    plot_total_affected <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(subset_data, <span class="fu">aes</span>(<span class="at">x =</span> total_affected, <span class="at">y =</span> <span class="sc">!!</span><span class="fu">as.name</span>(selected_goal))) <span class="sc">+</span></span>
<span id="cb26-42"><a href="#cb26-42" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb26-43"><a href="#cb26-43" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb26-44"><a href="#cb26-44" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste</span>(<span class="st">"Regression plot for"</span>, selected_goal, <span class="st">"vs Total Affected"</span>),</span>
<span id="cb26-45"><a href="#cb26-45" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="st">"Total Affected"</span>, <span class="at">y =</span> selected_goal) <span class="sc">+</span></span>
<span id="cb26-46"><a href="#cb26-46" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> <span class="fu">comma_format</span>()) </span>
<span id="cb26-47"><a href="#cb26-47" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb26-48"><a href="#cb26-48" aria-hidden="true" tabindex="-1"></a>    plot_total_deaths <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(subset_data, <span class="fu">aes</span>(<span class="at">x =</span> total_deaths, <span class="at">y =</span> <span class="sc">!!</span><span class="fu">as.name</span>(selected_goal))) <span class="sc">+</span></span>
<span id="cb26-49"><a href="#cb26-49" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb26-50"><a href="#cb26-50" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb26-51"><a href="#cb26-51" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste</span>(<span class="st">"Regression plot for"</span>, selected_goal, <span class="st">"vs Total Deaths"</span>),</span>
<span id="cb26-52"><a href="#cb26-52" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="st">"Total Deaths"</span>, <span class="at">y =</span> selected_goal) <span class="sc">+</span></span>
<span id="cb26-53"><a href="#cb26-53" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> <span class="fu">comma_format</span>()) </span>
<span id="cb26-54"><a href="#cb26-54" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb26-55"><a href="#cb26-55" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb26-56"><a href="#cb26-56" aria-hidden="true" tabindex="-1"></a>    <span class="fu">list</span>(plot_total_affected, plot_total_deaths)</span>
<span id="cb26-57"><a href="#cb26-57" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb26-58"><a href="#cb26-58" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb26-59"><a href="#cb26-59" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>regression_plot_affected <span class="ot">&lt;-</span> <span class="fu">renderPlot</span>({</span>
<span id="cb26-60"><a href="#cb26-60" aria-hidden="true" tabindex="-1"></a>    selected_goal <span class="ot">&lt;-</span> input<span class="sc">$</span>sdg</span>
<span id="cb26-61"><a href="#cb26-61" aria-hidden="true" tabindex="-1"></a>    regression_plots <span class="ot">&lt;-</span> <span class="fu">generate_regression_plot</span>(selected_goal)</span>
<span id="cb26-62"><a href="#cb26-62" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(regression_plots[[<span class="dv">1</span>]])</span>
<span id="cb26-63"><a href="#cb26-63" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb26-64"><a href="#cb26-64" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb26-65"><a href="#cb26-65" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>regression_plot_deaths <span class="ot">&lt;-</span> <span class="fu">renderPlot</span>({</span>
<span id="cb26-66"><a href="#cb26-66" aria-hidden="true" tabindex="-1"></a>    selected_goal <span class="ot">&lt;-</span> input<span class="sc">$</span>sdg</span>
<span id="cb26-67"><a href="#cb26-67" aria-hidden="true" tabindex="-1"></a>    regression_plots <span class="ot">&lt;-</span> <span class="fu">generate_regression_plot</span>(selected_goal)</span>
<span id="cb26-68"><a href="#cb26-68" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(regression_plots[[<span class="dv">2</span>]])</span>
<span id="cb26-69"><a href="#cb26-69" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb26-70"><a href="#cb26-70" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb26-71"><a href="#cb26-71" aria-hidden="true" tabindex="-1"></a><span class="fu">shinyApp</span>(ui, server)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p></p><div style="width: 100% ; height: 400px ; text-align: center; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box;" class="muted well">Shiny applications not supported in static R Markdown documents</div><p></p>
</div>
</div>
<p>Most relationships between the goals and the variables (‘total_affected’ and ‘total_deaths’) are not statistically significant (indicated by p-values &gt; 0.05). More specifically, in several models, the coefficients for ‘total_affected’ and ‘total_deaths’ are small, indicating weak or negligible relationships with the respective goals. Some models have marginally significant p-values (close to 0.05) but still lack statistical significance. Goals 7, 8, 10, 13, 14, and 15 exhibit statistically significant relationships with ‘total_affected,’ indicating small to moderate positive relationships. Goals 7 and 8 also show statistically significant relationships with ‘total_deaths,’ indicating moderate negative relationships.</p>
<p>These findings suggest that, in most cases, the relationships between the specified goals and COVID-19 variables (total affected and total deaths) are not statistically significant. However, some goals do indicate small to moderate associations with these variables.</p>
<p>Let’s see the regressions for each score depending of each variable in the COVID-19 dataset (stringency, cases_per_million and deaths_per_million).</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>covid_filtered <span class="ot">&lt;-</span> Q3<span class="fl">.2</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>relevant_columns <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">"goal1"</span>, <span class="st">"goal2"</span>, <span class="st">"goal3"</span>, <span class="st">"goal4"</span>, <span class="st">"goal5"</span>, <span class="st">"goal6"</span>, <span class="st">"goal7"</span>, <span class="st">"goal8"</span>, <span class="st">"goal9"</span>, <span class="st">"goal10"</span>, <span class="st">"goal11"</span>, <span class="st">"goal12"</span>, <span class="st">"goal13"</span>, <span class="st">"goal15"</span>, <span class="st">"goal16"</span>, <span class="st">"stringency"</span>, <span class="st">"cases_per_million"</span>, <span class="st">"deaths_per_million"</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>subset_data <span class="ot">&lt;-</span> covid_filtered[, relevant_columns]</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>goal_columns <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>  <span class="st">"goal1"</span>, <span class="st">"goal2"</span>, <span class="st">"goal3"</span>, <span class="st">"goal4"</span>, <span class="st">"goal5"</span>, <span class="st">"goal6"</span>, <span class="st">"goal7"</span>, <span class="st">"goal8"</span>, <span class="st">"goal9"</span>, <span class="st">"goal10"</span>, <span class="st">"goal11"</span>, <span class="st">"goal12"</span>, <span class="st">"goal13"</span>, <span class="st">"goal15"</span>, <span class="st">"goal16"</span></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>ui <span class="ot">&lt;-</span> <span class="fu">fluidPage</span>(</span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">titlePanel</span>(<span class="st">"SDG - COVID Regression Analysis"</span>),</span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sidebarLayout</span>(</span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sidebarPanel</span>(</span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>      <span class="fu">selectInput</span>(<span class="st">"sdg"</span>, <span class="st">"Select SDG Goal:"</span>,</span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>                  <span class="at">choices =</span> goal_columns,</span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a>                  <span class="at">selected =</span> goal_columns[<span class="dv">1</span>]),</span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">width =</span> <span class="dv">3</span></span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mainPanel</span>(</span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a>      <span class="at">width =</span> <span class="dv">9</span>,</span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a>      <span class="fu">plotOutput</span>(<span class="st">"regression_plot_stringency"</span>),</span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a>      <span class="fu">plotOutput</span>(<span class="st">"regression_plot_cases"</span>),</span>
<span id="cb27-26"><a href="#cb27-26" aria-hidden="true" tabindex="-1"></a>      <span class="fu">plotOutput</span>(<span class="st">"regression_plot_deaths"</span>)</span>
<span id="cb27-27"><a href="#cb27-27" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb27-28"><a href="#cb27-28" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb27-29"><a href="#cb27-29" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb27-30"><a href="#cb27-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-31"><a href="#cb27-31" aria-hidden="true" tabindex="-1"></a>server <span class="ot">&lt;-</span> <span class="cf">function</span>(input, output) {</span>
<span id="cb27-32"><a href="#cb27-32" aria-hidden="true" tabindex="-1"></a>  generate_regression_plot <span class="ot">&lt;-</span> <span class="cf">function</span>(selected_goal) {</span>
<span id="cb27-33"><a href="#cb27-33" aria-hidden="true" tabindex="-1"></a>    formula_stringency <span class="ot">&lt;-</span> <span class="fu">as.formula</span>(<span class="fu">paste</span>(selected_goal, <span class="st">"~ stringency"</span>))</span>
<span id="cb27-34"><a href="#cb27-34" aria-hidden="true" tabindex="-1"></a>    formula_cases <span class="ot">&lt;-</span> <span class="fu">as.formula</span>(<span class="fu">paste</span>(selected_goal, <span class="st">"~ cases_per_million"</span>))</span>
<span id="cb27-35"><a href="#cb27-35" aria-hidden="true" tabindex="-1"></a>    formula_deaths <span class="ot">&lt;-</span> <span class="fu">as.formula</span>(<span class="fu">paste</span>(selected_goal, <span class="st">"~ deaths_per_million"</span>))</span>
<span id="cb27-36"><a href="#cb27-36" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb27-37"><a href="#cb27-37" aria-hidden="true" tabindex="-1"></a>    lm_stringency <span class="ot">&lt;-</span> <span class="fu">lm</span>(formula_stringency, <span class="at">data =</span> subset_data)</span>
<span id="cb27-38"><a href="#cb27-38" aria-hidden="true" tabindex="-1"></a>    lm_cases <span class="ot">&lt;-</span> <span class="fu">lm</span>(formula_cases, <span class="at">data =</span> subset_data)</span>
<span id="cb27-39"><a href="#cb27-39" aria-hidden="true" tabindex="-1"></a>    lm_deaths <span class="ot">&lt;-</span> <span class="fu">lm</span>(formula_deaths, <span class="at">data =</span> subset_data)</span>
<span id="cb27-40"><a href="#cb27-40" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb27-41"><a href="#cb27-41" aria-hidden="true" tabindex="-1"></a>    plot_stringency <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(subset_data, <span class="fu">aes</span>(<span class="at">x =</span> stringency, <span class="at">y =</span> <span class="sc">!!</span><span class="fu">as.name</span>(selected_goal))) <span class="sc">+</span></span>
<span id="cb27-42"><a href="#cb27-42" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb27-43"><a href="#cb27-43" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb27-44"><a href="#cb27-44" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste</span>(<span class="st">"Regression plot for"</span>, selected_goal, <span class="st">"vs Stringency"</span>),</span>
<span id="cb27-45"><a href="#cb27-45" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="st">"Stringency"</span>, <span class="at">y =</span> selected_goal) <span class="sc">+</span></span>
<span id="cb27-46"><a href="#cb27-46" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> <span class="fu">comma_format</span>())</span>
<span id="cb27-47"><a href="#cb27-47" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb27-48"><a href="#cb27-48" aria-hidden="true" tabindex="-1"></a>    plot_cases <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(subset_data, <span class="fu">aes</span>(<span class="at">x =</span> cases_per_million, <span class="at">y =</span> <span class="sc">!!</span><span class="fu">as.name</span>(selected_goal))) <span class="sc">+</span></span>
<span id="cb27-49"><a href="#cb27-49" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb27-50"><a href="#cb27-50" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb27-51"><a href="#cb27-51" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste</span>(<span class="st">"Regression plot for"</span>, selected_goal, <span class="st">"vs Cases per Million"</span>),</span>
<span id="cb27-52"><a href="#cb27-52" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="st">"Cases per Million"</span>, <span class="at">y =</span> selected_goal) <span class="sc">+</span></span>
<span id="cb27-53"><a href="#cb27-53" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> <span class="fu">comma_format</span>()) </span>
<span id="cb27-54"><a href="#cb27-54" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb27-55"><a href="#cb27-55" aria-hidden="true" tabindex="-1"></a>    plot_deaths <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(subset_data, <span class="fu">aes</span>(<span class="at">x =</span> deaths_per_million, <span class="at">y =</span> <span class="sc">!!</span><span class="fu">as.name</span>(selected_goal))) <span class="sc">+</span></span>
<span id="cb27-56"><a href="#cb27-56" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb27-57"><a href="#cb27-57" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb27-58"><a href="#cb27-58" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste</span>(<span class="st">"Regression plot for"</span>, selected_goal, <span class="st">"vs Deaths per Million"</span>),</span>
<span id="cb27-59"><a href="#cb27-59" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="st">"Deaths per Million"</span>, <span class="at">y =</span> selected_goal) <span class="sc">+</span></span>
<span id="cb27-60"><a href="#cb27-60" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> <span class="fu">comma_format</span>()) </span>
<span id="cb27-61"><a href="#cb27-61" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb27-62"><a href="#cb27-62" aria-hidden="true" tabindex="-1"></a>    <span class="fu">list</span>(plot_stringency, plot_cases, plot_deaths)</span>
<span id="cb27-63"><a href="#cb27-63" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb27-64"><a href="#cb27-64" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-65"><a href="#cb27-65" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>regression_plot_stringency <span class="ot">&lt;-</span> <span class="fu">renderPlot</span>({</span>
<span id="cb27-66"><a href="#cb27-66" aria-hidden="true" tabindex="-1"></a>    selected_goal <span class="ot">&lt;-</span> input<span class="sc">$</span>sdg</span>
<span id="cb27-67"><a href="#cb27-67" aria-hidden="true" tabindex="-1"></a>    regression_plots <span class="ot">&lt;-</span> <span class="fu">generate_regression_plot</span>(selected_goal)</span>
<span id="cb27-68"><a href="#cb27-68" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(regression_plots[[<span class="dv">1</span>]])  <span class="co"># Display plot for stringency vs selected_goal</span></span>
<span id="cb27-69"><a href="#cb27-69" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb27-70"><a href="#cb27-70" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-71"><a href="#cb27-71" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>regression_plot_cases <span class="ot">&lt;-</span> <span class="fu">renderPlot</span>({</span>
<span id="cb27-72"><a href="#cb27-72" aria-hidden="true" tabindex="-1"></a>    selected_goal <span class="ot">&lt;-</span> input<span class="sc">$</span>sdg</span>
<span id="cb27-73"><a href="#cb27-73" aria-hidden="true" tabindex="-1"></a>    regression_plots <span class="ot">&lt;-</span> <span class="fu">generate_regression_plot</span>(selected_goal)</span>
<span id="cb27-74"><a href="#cb27-74" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(regression_plots[[<span class="dv">2</span>]])  <span class="co"># Display plot for cases_per_million vs selected_goal</span></span>
<span id="cb27-75"><a href="#cb27-75" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb27-76"><a href="#cb27-76" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-77"><a href="#cb27-77" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>regression_plot_deaths <span class="ot">&lt;-</span> <span class="fu">renderPlot</span>({</span>
<span id="cb27-78"><a href="#cb27-78" aria-hidden="true" tabindex="-1"></a>    selected_goal <span class="ot">&lt;-</span> input<span class="sc">$</span>sdg</span>
<span id="cb27-79"><a href="#cb27-79" aria-hidden="true" tabindex="-1"></a>    regression_plots <span class="ot">&lt;-</span> <span class="fu">generate_regression_plot</span>(selected_goal)</span>
<span id="cb27-80"><a href="#cb27-80" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(regression_plots[[<span class="dv">3</span>]])  <span class="co"># Display plot for deaths_per_million vs selected_goal</span></span>
<span id="cb27-81"><a href="#cb27-81" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb27-82"><a href="#cb27-82" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb27-83"><a href="#cb27-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-84"><a href="#cb27-84" aria-hidden="true" tabindex="-1"></a><span class="fu">shinyApp</span>(ui, server)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p></p><div style="width: 100% ; height: 400px ; text-align: center; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box;" class="muted well">Shiny applications not supported in static R Markdown documents</div><p></p>
</div>
</div>
<p>For all objectives (from objective 1 to objective 16), the predictor variables (stringency, number of cases per million and number of deaths per million) show statistically significant relationships. However, when assessed individually, these predictors explain only a marginal fraction of the variance of the respective objectives, with explanatory percentages ranging from around 0.141% to 6.99%. Adjusted R-squared values consistently indicate limited explanatory power for these relationships, implying the influence of other factors not accounted for in the variations observed for each objective. Relying solely on rigor, cases per million and deaths per million results in modest predictive capabilities for each objective.</p>
<p>In summary, the statistical significance of stringency, cases per million and deaths per million in relation to each objective is clear. However, these predictive variables individually fail to explain the variations observed, highlighting the need to explore additional variables or unexplored factors in order to significantly improve predictive ability for each respective objective.</p>
<p>Now, let’s see the regressions for each SDG score depending of each variable in the Conflicts dataset (pop_affected and sum_deaths).</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>conflicts_filtered <span class="ot">&lt;-</span> Q3<span class="fl">.3</span>[Q3<span class="fl">.3</span><span class="sc">$</span>region <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Middle East &amp; North Africa"</span>, <span class="st">"Sub-Saharan Africa"</span>, <span class="st">"South Asia"</span>, <span class="st">"Latin America &amp; the Caribbean"</span>, <span class="st">"Eastern Europe"</span>, <span class="st">"Caucasus and Central Asia"</span>), ]</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>relevant_columns <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"goal1"</span>, <span class="st">"goal2"</span>, <span class="st">"goal3"</span>, <span class="st">"goal4"</span>, <span class="st">"goal5"</span>, <span class="st">"goal6"</span>, <span class="st">"goal7"</span>, <span class="st">"goal8"</span>, <span class="st">"goal9"</span>, <span class="st">"goal10"</span>, <span class="st">"goal11"</span>, <span class="st">"goal12"</span>, <span class="st">"goal13"</span>, <span class="st">"goal15"</span>, <span class="st">"goal16"</span>, <span class="st">"pop_affected"</span>, <span class="st">"sum_deaths"</span>, <span class="st">"maxintensity"</span>)</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>subset_data <span class="ot">&lt;-</span> conflicts_filtered[, relevant_columns]</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>goal_columns <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"goal1"</span>, <span class="st">"goal2"</span>, <span class="st">"goal3"</span>, <span class="st">"goal4"</span>, <span class="st">"goal5"</span>, <span class="st">"goal6"</span>, <span class="st">"goal7"</span>, <span class="st">"goal8"</span>, <span class="st">"goal9"</span>, <span class="st">"goal10"</span>, <span class="st">"goal11"</span>, <span class="st">"goal12"</span>, <span class="st">"goal13"</span>, <span class="st">"goal15"</span>, <span class="st">"goal16"</span></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>ui <span class="ot">&lt;-</span> <span class="fu">fluidPage</span>(</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">titlePanel</span>(<span class="st">"SDG - Conflicts Regression Analysis"</span>),</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sidebarLayout</span>(</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sidebarPanel</span>(</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>      <span class="fu">selectInput</span>(<span class="st">"sdg"</span>, <span class="st">"Select SDG Goal:"</span>,</span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>                  <span class="at">choices =</span> goal_columns,</span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>                  <span class="at">selected =</span> goal_columns[<span class="dv">1</span>]),</span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">width =</span> <span class="dv">3</span></span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mainPanel</span>(</span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a>      <span class="at">width =</span> <span class="dv">9</span>,</span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a>      <span class="fu">plotOutput</span>(<span class="st">"regression_plot_pop_affected"</span>),</span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a>      <span class="fu">plotOutput</span>(<span class="st">"regression_plot_sum_deaths"</span>),</span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a>      <span class="fu">plotOutput</span>(<span class="st">"regression_plot_maxintensity"</span>)</span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb28-27"><a href="#cb28-27" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb28-28"><a href="#cb28-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-29"><a href="#cb28-29" aria-hidden="true" tabindex="-1"></a>server <span class="ot">&lt;-</span> <span class="cf">function</span>(input, output) {</span>
<span id="cb28-30"><a href="#cb28-30" aria-hidden="true" tabindex="-1"></a>  generate_regression_plot <span class="ot">&lt;-</span> <span class="cf">function</span>(selected_goal) {</span>
<span id="cb28-31"><a href="#cb28-31" aria-hidden="true" tabindex="-1"></a>    formula_pop_affected <span class="ot">&lt;-</span> <span class="fu">as.formula</span>(<span class="fu">paste</span>(selected_goal, <span class="st">"~ pop_affected"</span>))</span>
<span id="cb28-32"><a href="#cb28-32" aria-hidden="true" tabindex="-1"></a>    formula_sum_deaths <span class="ot">&lt;-</span> <span class="fu">as.formula</span>(<span class="fu">paste</span>(selected_goal, <span class="st">"~ sum_deaths"</span>))</span>
<span id="cb28-33"><a href="#cb28-33" aria-hidden="true" tabindex="-1"></a>    formula_maxintensity <span class="ot">&lt;-</span> <span class="fu">as.formula</span>(<span class="fu">paste</span>(selected_goal, <span class="st">"~maxintensity"</span>))</span>
<span id="cb28-34"><a href="#cb28-34" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb28-35"><a href="#cb28-35" aria-hidden="true" tabindex="-1"></a>    lm_pop_affected <span class="ot">&lt;-</span> <span class="fu">lm</span>(formula_pop_affected, <span class="at">data =</span> subset_data)</span>
<span id="cb28-36"><a href="#cb28-36" aria-hidden="true" tabindex="-1"></a>    lm_sum_deaths <span class="ot">&lt;-</span> <span class="fu">lm</span>(formula_sum_deaths, <span class="at">data =</span> subset_data)</span>
<span id="cb28-37"><a href="#cb28-37" aria-hidden="true" tabindex="-1"></a>    lm_maxintensity <span class="ot">&lt;-</span> <span class="fu">lm</span>(formula_maxintensity, <span class="at">data =</span> subset_data)</span>
<span id="cb28-38"><a href="#cb28-38" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb28-39"><a href="#cb28-39" aria-hidden="true" tabindex="-1"></a>    plot_pop_affected <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(subset_data, <span class="fu">aes</span>(<span class="at">x =</span> pop_affected, <span class="at">y =</span> <span class="sc">!!</span><span class="fu">as.name</span>(selected_goal))) <span class="sc">+</span></span>
<span id="cb28-40"><a href="#cb28-40" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb28-41"><a href="#cb28-41" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb28-42"><a href="#cb28-42" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste</span>(<span class="st">"Regression plot for"</span>, selected_goal, <span class="st">"vs Population Affected"</span>),</span>
<span id="cb28-43"><a href="#cb28-43" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="st">"Population Affected"</span>, <span class="at">y =</span> selected_goal) <span class="sc">+</span></span>
<span id="cb28-44"><a href="#cb28-44" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> <span class="fu">comma_format</span>()) </span>
<span id="cb28-45"><a href="#cb28-45" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb28-46"><a href="#cb28-46" aria-hidden="true" tabindex="-1"></a>    plot_sum_deaths <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(subset_data, <span class="fu">aes</span>(<span class="at">x =</span> sum_deaths, <span class="at">y =</span> <span class="sc">!!</span><span class="fu">as.name</span>(selected_goal))) <span class="sc">+</span></span>
<span id="cb28-47"><a href="#cb28-47" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb28-48"><a href="#cb28-48" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb28-49"><a href="#cb28-49" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste</span>(<span class="st">"Regression plot for"</span>, selected_goal, <span class="st">"vs Sum of Deaths"</span>),</span>
<span id="cb28-50"><a href="#cb28-50" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="st">"Sum of Deaths"</span>, <span class="at">y =</span> selected_goal) <span class="sc">+</span></span>
<span id="cb28-51"><a href="#cb28-51" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> <span class="fu">comma_format</span>()) </span>
<span id="cb28-52"><a href="#cb28-52" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb28-53"><a href="#cb28-53" aria-hidden="true" tabindex="-1"></a>    plot_maxintensity <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(subset_data, <span class="fu">aes</span>(<span class="at">x =</span> sum_deaths, <span class="at">y =</span> <span class="sc">!!</span><span class="fu">as.name</span>(selected_goal))) <span class="sc">+</span></span>
<span id="cb28-54"><a href="#cb28-54" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb28-55"><a href="#cb28-55" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb28-56"><a href="#cb28-56" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste</span>(<span class="st">"Regression plot for"</span>, selected_goal, <span class="st">"vs Maxintensity"</span>),</span>
<span id="cb28-57"><a href="#cb28-57" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="st">"Maxintensity"</span>, <span class="at">y =</span> selected_goal) <span class="sc">+</span></span>
<span id="cb28-58"><a href="#cb28-58" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> <span class="fu">comma_format</span>()) </span>
<span id="cb28-59"><a href="#cb28-59" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb28-60"><a href="#cb28-60" aria-hidden="true" tabindex="-1"></a>    <span class="fu">list</span>(plot_pop_affected, plot_sum_deaths, plot_maxintensity)</span>
<span id="cb28-61"><a href="#cb28-61" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb28-62"><a href="#cb28-62" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb28-63"><a href="#cb28-63" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>regression_plot_pop_affected <span class="ot">&lt;-</span> <span class="fu">renderPlot</span>({</span>
<span id="cb28-64"><a href="#cb28-64" aria-hidden="true" tabindex="-1"></a>    selected_goal <span class="ot">&lt;-</span> input<span class="sc">$</span>sdg</span>
<span id="cb28-65"><a href="#cb28-65" aria-hidden="true" tabindex="-1"></a>    regression_plots <span class="ot">&lt;-</span> <span class="fu">generate_regression_plot</span>(selected_goal)</span>
<span id="cb28-66"><a href="#cb28-66" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(regression_plots[[<span class="dv">1</span>]])  </span>
<span id="cb28-67"><a href="#cb28-67" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb28-68"><a href="#cb28-68" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb28-69"><a href="#cb28-69" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>regression_plot_sum_deaths <span class="ot">&lt;-</span> <span class="fu">renderPlot</span>({</span>
<span id="cb28-70"><a href="#cb28-70" aria-hidden="true" tabindex="-1"></a>    selected_goal <span class="ot">&lt;-</span> input<span class="sc">$</span>sdg</span>
<span id="cb28-71"><a href="#cb28-71" aria-hidden="true" tabindex="-1"></a>    regression_plots <span class="ot">&lt;-</span> <span class="fu">generate_regression_plot</span>(selected_goal)</span>
<span id="cb28-72"><a href="#cb28-72" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(regression_plots[[<span class="dv">2</span>]])  </span>
<span id="cb28-73"><a href="#cb28-73" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb28-74"><a href="#cb28-74" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb28-75"><a href="#cb28-75" aria-hidden="true" tabindex="-1"></a>    output<span class="sc">$</span>regression_plot_maxintensity <span class="ot">&lt;-</span> <span class="fu">renderPlot</span>({</span>
<span id="cb28-76"><a href="#cb28-76" aria-hidden="true" tabindex="-1"></a>    selected_goal <span class="ot">&lt;-</span> input<span class="sc">$</span>sdg</span>
<span id="cb28-77"><a href="#cb28-77" aria-hidden="true" tabindex="-1"></a>    regression_plots <span class="ot">&lt;-</span> <span class="fu">generate_regression_plot</span>(selected_goal)</span>
<span id="cb28-78"><a href="#cb28-78" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(regression_plots[[<span class="dv">3</span>]])  </span>
<span id="cb28-79"><a href="#cb28-79" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb28-80"><a href="#cb28-80" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb28-81"><a href="#cb28-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-82"><a href="#cb28-82" aria-hidden="true" tabindex="-1"></a><span class="fu">shinyApp</span>(ui, server)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p></p><div style="width: 100% ; height: 400px ; text-align: center; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box;" class="muted well">Shiny applications not supported in static R Markdown documents</div><p></p>
</div>
</div>
<p>All three predictors exhibited statistically significant relationships with the respective goals across the board. ‘Maxintensity’ generally demonstrated a relatively stronger association compared to ‘Population Affected’ and ‘Deaths’ in most analyses. But collectively, these predictors explained only a small to moderate portion of the variability observed in the different goals (adjusted R-squared ranging from approximately 1% to 9.48%). This suggests that there are other unaccounted factors not included in the analysis that significantly influence the outcomes of these goals. To conclude, while ‘Population Affected,’ ‘Deaths,’ and ‘Maxintensity’ consistently showed significant associations with the various goals analyzed, their combined effect explained only a fraction of the variance observed in these goals. Therefore, there are likely additional crucial factors beyond these predictors that play substantial roles in influencing the outcomes of the respective goals.</p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>