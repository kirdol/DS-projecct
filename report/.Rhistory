list(
args = list("y", list(
~fitted(lm(goal3 ~ year, data = data_after_2015)),
~fitted(lm(goal3 ~ year, data = data_before_2016))
)),
label = "Goal 3",
method = "restyle"
),
list(
args = list("y", list(
~fitted(lm(goal4 ~ year, data = data_after_2015)),
~fitted(lm(goal4 ~ year, data = data_before_2016))
)),
label = "Goal 4",
method = "restyle"
),
list(
args = list("y", list(
~fitted(lm(goal5 ~ year, data = data_after_2015)),
~fitted(lm(goal5 ~ year, data = data_before_2016))
)),
label = "Goal 5",
method = "restyle"
),
list(
args = list("y", list(
~fitted(lm(goal6 ~ year, data = data_after_2015)),
~fitted(lm(goal6 ~ year, data = data_before_2016))
)),
label = "Goal 6",
method = "restyle"
),
list(
args = list("y", list(
~fitted(lm(goal7 ~ year, data = data_after_2015)),
~fitted(lm(goal7 ~ year, data = data_before_2016))
)),
label = "Goal 7",
method = "restyle"
),
list(
args = list("y", list(
~fitted(lm(goal8 ~ year, data = data_after_2015)),
~fitted(lm(goal8 ~ year, data = data_before_2016))
)),
label = "Goal 8",
method = "restyle"
),
list(
args = list("y", list(
~fitted(lm(goal9 ~ year, data = data_after_2015)),
~fitted(lm(goal9 ~ year, data = data_before_2016))
)),
label = "Goal 9",
method = "restyle"
),
list(
args = list("y", list(
~fitted(lm(goal10 ~ year, data = data_after_2015)),
~fitted(lm(goal10 ~ year, data = data_before_2016))
)),
label = "Goal 10",
method = "restyle"
),
list(
args = list("y", list(
~fitted(lm(goal11 ~ year, data = data_after_2015)),
~fitted(lm(goal11 ~ year, data = data_before_2016))
)),
label = "Goal 11",
method = "restyle"
),
list(
args = list("y", list(
~fitted(lm(goal12 ~ year, data = data_after_2015)),
~fitted(lm(goal12 ~ year, data = data_before_2016))
)),
label = "Goal 12",
method = "restyle"
),
list(
args = list("y", list(
~fitted(lm(goal13 ~ year, data = data_after_2015)),
~fitted(lm(goal13 ~ year, data = data_before_2016))
)),
label = "Goal 13",
method = "restyle"
),
list(
args = list("y", list(
~fitted(lm(goal15 ~ year, data = data_after_2015)),
~fitted(lm(goal15 ~ year, data = data_before_2016))
)),
label = "Goal 15",
method = "restyle"
),
list(
args = list("y", list(
~fitted(lm(goal16 ~ year, data = data_after_2015)),
~fitted(lm(goal16 ~ year, data = data_before_2016))
)),
label = "Goal 16",
method = "restyle"
),
list(
args = list("y", list(
~fitted(lm(goal17 ~ year, data = data_after_2015)),
~fitted(lm(goal17 ~ year, data = data_before_2016))
)),
label = "Goal 17",
method = "restyle"
)
)
)
)
)
# Create a panel data object
panel_data <- plm::pdata.frame(binary2015, index = c("country", "year"))
# Run the difference-in-differences model to take into account the general evolution over the years
reg2.2 <- plm::plm(diff_overallscore ~ after2015 + year + after2015:year,
data = panel_data,
model = "within")
reg2.2.1 <- plm::plm(diff_goal1 ~ after2015 + year + after2015:year,
data = panel_data,
model = "within")
reg2.2.2 <- plm::plm(diff_goal2 ~ after2015 + year + after2015:year,
data = panel_data,
model = "within")
reg2.2.3 <- plm::plm(diff_goal3 ~ after2015 + year + after2015:year,
data = panel_data,
model = "within")
reg2.2.4 <- plm::plm(diff_goal4 ~ after2015 + year + after2015:year,
data = panel_data,
model = "within")
reg2.2.5 <- plm::plm(diff_goal5 ~ after2015 + year + after2015:year,
data = panel_data,
model = "within")
reg2.2.6 <- plm::plm(diff_goal6 ~ after2015 + year + after2015:year,
data = panel_data,
model = "within")
reg2.2.7 <- plm::plm(diff_goal7 ~ after2015 + year + after2015:year,
data = panel_data,
model = "within")
reg2.2.8 <- plm::plm(diff_goal8 ~ after2015 + year + after2015:year,
data = panel_data,
model = "within")
reg2.2.9 <- plm::plm(diff_goal9 ~ after2015 + year + after2015:year,
data = panel_data,
model = "within")
reg2.2.10 <- plm::plm(diff_goal10 ~ after2015 + year + after2015:year,
data = panel_data,
model = "within")
reg2.2.11 <- plm::plm(diff_goal11 ~ after2015 + year + after2015:year,
data = panel_data,
model = "within")
reg2.2.12 <- plm::plm(diff_goal12 ~ after2015 + year + after2015:year,
data = panel_data,
model = "within")
reg2.2.13 <- plm::plm(diff_goal13 ~ after2015 + year + after2015:year,
data = panel_data,
model = "within")
reg2.2.15 <- plm::plm(diff_goal15 ~ after2015 + year + after2015:year,
data = panel_data,
model = "within")
reg2.2.16 <- plm::plm(diff_goal16 ~ after2015 + year + after2015:year,
data = panel_data,
model = "within")
reg2.2.17 <- plm::plm(diff_goal17 ~ after2015 + year + after2015:year,
data = panel_data,
model = "within")
# Create a list of your regression models
models_list2 <- list("Overall score"=reg2.2, "Goal 1"=reg2.2.1, "Goal 2"=reg2.2.2, "Goal 3"= reg2.2.3, "Goal 4"=reg2.2.4, "Goal 5"=reg2.2.5, "Goal 6"= reg2.2.6, "Goal 7"=reg2.2.7, "Goal 8"=reg2.2.8, "Goal 9"=reg2.2.9, "Goal 10"=reg2.2.10, "Goal 11" = reg2.2.11,"Goal 12"=reg2.2.12, "Goal 13"=reg2.2.13, "Goal 15" =reg2.2.15, "Goal 16"=reg2.2.16, "Goal 17"=reg2.2.17)
coefficients_df <- map_df(models_list2, ~tidy(.x, conf.int = TRUE), .id = "Model")
install.packages('broom.mixed')
# Create a panel data object
panel_data <- plm::pdata.frame(binary2015, index = c("country", "year"))
# Run the difference-in-differences model to take into account the general evolution over the years
reg2.2 <- plm::plm(diff_overallscore ~ after2015 + year + after2015:year,
data = panel_data,
model = "within")
reg2.2.1 <- plm::plm(diff_goal1 ~ after2015 + year + after2015:year,
data = panel_data,
model = "within")
reg2.2.2 <- plm::plm(diff_goal2 ~ after2015 + year + after2015:year,
data = panel_data,
model = "within")
reg2.2.3 <- plm::plm(diff_goal3 ~ after2015 + year + after2015:year,
data = panel_data,
model = "within")
reg2.2.4 <- plm::plm(diff_goal4 ~ after2015 + year + after2015:year,
data = panel_data,
model = "within")
reg2.2.5 <- plm::plm(diff_goal5 ~ after2015 + year + after2015:year,
data = panel_data,
model = "within")
reg2.2.6 <- plm::plm(diff_goal6 ~ after2015 + year + after2015:year,
data = panel_data,
model = "within")
reg2.2.7 <- plm::plm(diff_goal7 ~ after2015 + year + after2015:year,
data = panel_data,
model = "within")
reg2.2.8 <- plm::plm(diff_goal8 ~ after2015 + year + after2015:year,
data = panel_data,
model = "within")
reg2.2.9 <- plm::plm(diff_goal9 ~ after2015 + year + after2015:year,
data = panel_data,
model = "within")
reg2.2.10 <- plm::plm(diff_goal10 ~ after2015 + year + after2015:year,
data = panel_data,
model = "within")
reg2.2.11 <- plm::plm(diff_goal11 ~ after2015 + year + after2015:year,
data = panel_data,
model = "within")
reg2.2.12 <- plm::plm(diff_goal12 ~ after2015 + year + after2015:year,
data = panel_data,
model = "within")
reg2.2.13 <- plm::plm(diff_goal13 ~ after2015 + year + after2015:year,
data = panel_data,
model = "within")
reg2.2.15 <- plm::plm(diff_goal15 ~ after2015 + year + after2015:year,
data = panel_data,
model = "within")
reg2.2.16 <- plm::plm(diff_goal16 ~ after2015 + year + after2015:year,
data = panel_data,
model = "within")
reg2.2.17 <- plm::plm(diff_goal17 ~ after2015 + year + after2015:year,
data = panel_data,
model = "within")
# Create a list of your regression models
models_list2 <- list("Overall score"=reg2.2, "Goal 1"=reg2.2.1, "Goal 2"=reg2.2.2, "Goal 3"= reg2.2.3, "Goal 4"=reg2.2.4, "Goal 5"=reg2.2.5, "Goal 6"= reg2.2.6, "Goal 7"=reg2.2.7, "Goal 8"=reg2.2.8, "Goal 9"=reg2.2.9, "Goal 10"=reg2.2.10, "Goal 11" = reg2.2.11,"Goal 12"=reg2.2.12, "Goal 13"=reg2.2.13, "Goal 15" =reg2.2.15, "Goal 16"=reg2.2.16, "Goal 17"=reg2.2.17)
coefficients_df <- map_df(models_list2, ~broom.mixed::tidy(.x, conf.int = TRUE), .id = "Model")
# Filter and display only the significant coefficients for after2015
significant_after2015 <- coefficients_df %>%
filter(term == "after2015" & p.value < 0.05)
# Use huxreg to display the filtered coefficients
huxreg(significant_after2015)
huxreg(models_list2[1:9])
huxreg(models_list2[10:17])
?huxreg
# Create a panel data object
panel_data <- plm::pdata.frame(binary2015, index = c("country", "year"))
# Run the difference-in-differences model to take into account the general evolution over the years
reg2.2 <- plm::plm(diff_overallscore ~ after2015 + year + after2015:year,
data = panel_data,
model = "within")
reg2.2.1 <- plm::plm(diff_goal1 ~ after2015 + year + after2015:year,
data = panel_data,
model = "within")
reg2.2.2 <- plm::plm(diff_goal2 ~ after2015 + year + after2015:year,
data = panel_data,
model = "within")
reg2.2.3 <- plm::plm(diff_goal3 ~ after2015 + year + after2015:year,
data = panel_data,
model = "within")
reg2.2.4 <- plm::plm(diff_goal4 ~ after2015 + year + after2015:year,
data = panel_data,
model = "within")
reg2.2.5 <- plm::plm(diff_goal5 ~ after2015 + year + after2015:year,
data = panel_data,
model = "within")
reg2.2.6 <- plm::plm(diff_goal6 ~ after2015 + year + after2015:year,
data = panel_data,
model = "within")
reg2.2.7 <- plm::plm(diff_goal7 ~ after2015 + year + after2015:year,
data = panel_data,
model = "within")
reg2.2.8 <- plm::plm(diff_goal8 ~ after2015 + year + after2015:year,
data = panel_data,
model = "within")
reg2.2.9 <- plm::plm(diff_goal9 ~ after2015 + year + after2015:year,
data = panel_data,
model = "within")
reg2.2.10 <- plm::plm(diff_goal10 ~ after2015 + year + after2015:year,
data = panel_data,
model = "within")
reg2.2.11 <- plm::plm(diff_goal11 ~ after2015 + year + after2015:year,
data = panel_data,
model = "within")
reg2.2.12 <- plm::plm(diff_goal12 ~ after2015 + year + after2015:year,
data = panel_data,
model = "within")
reg2.2.13 <- plm::plm(diff_goal13 ~ after2015 + year + after2015:year,
data = panel_data,
model = "within")
reg2.2.15 <- plm::plm(diff_goal15 ~ after2015 + year + after2015:year,
data = panel_data,
model = "within")
reg2.2.16 <- plm::plm(diff_goal16 ~ after2015 + year + after2015:year,
data = panel_data,
model = "within")
reg2.2.17 <- plm::plm(diff_goal17 ~ after2015 + year + after2015:year,
data = panel_data,
model = "within")
# Create a list of your regression models
models_list2 <- list("Overall score"=reg2.2, "Goal 1"=reg2.2.1, "Goal 2"=reg2.2.2, "Goal 3"= reg2.2.3, "Goal 4"=reg2.2.4, "Goal 5"=reg2.2.5, "Goal 6"= reg2.2.6, "Goal 7"=reg2.2.7, "Goal 8"=reg2.2.8, "Goal 9"=reg2.2.9, "Goal 10"=reg2.2.10, "Goal 11" = reg2.2.11,"Goal 12"=reg2.2.12, "Goal 13"=reg2.2.13, "Goal 15" =reg2.2.15, "Goal 16"=reg2.2.16, "Goal 17"=reg2.2.17)
huxreg(
lapply(models_list2, function(model) {
coefficients <- broom::tidy(model, conf.int = TRUE)
significant_after2015 <- coefficients[coefficients$term == "after2015" & coefficients$p.value < 0.05, ]
return(significant_after2015)
})
)
huxreg(models_list2[1:9])
huxreg(models_list2[10:17])
# Create a panel data object
panel_data <- plm::pdata.frame(binary2015, index = c("country", "year"))
# Run the difference-in-differences model to take into account the general evolution over the years
reg2.2 <- plm::plm(diff_overallscore ~ after2015 + year + after2015:year,
data = panel_data,
model = "within")
reg2.2.1 <- plm::plm(diff_goal1 ~ after2015 + year + after2015:year,
data = panel_data,
model = "within")
reg2.2.2 <- plm::plm(diff_goal2 ~ after2015 + year + after2015:year,
data = panel_data,
model = "within")
reg2.2.3 <- plm::plm(diff_goal3 ~ after2015 + year + after2015:year,
data = panel_data,
model = "within")
reg2.2.4 <- plm::plm(diff_goal4 ~ after2015 + year + after2015:year,
data = panel_data,
model = "within")
reg2.2.5 <- plm::plm(diff_goal5 ~ after2015 + year + after2015:year,
data = panel_data,
model = "within")
reg2.2.6 <- plm::plm(diff_goal6 ~ after2015 + year + after2015:year,
data = panel_data,
model = "within")
reg2.2.7 <- plm::plm(diff_goal7 ~ after2015 + year + after2015:year,
data = panel_data,
model = "within")
reg2.2.8 <- plm::plm(diff_goal8 ~ after2015 + year + after2015:year,
data = panel_data,
model = "within")
reg2.2.9 <- plm::plm(diff_goal9 ~ after2015 + year + after2015:year,
data = panel_data,
model = "within")
reg2.2.10 <- plm::plm(diff_goal10 ~ after2015 + year + after2015:year,
data = panel_data,
model = "within")
reg2.2.11 <- plm::plm(diff_goal11 ~ after2015 + year + after2015:year,
data = panel_data,
model = "within")
reg2.2.12 <- plm::plm(diff_goal12 ~ after2015 + year + after2015:year,
data = panel_data,
model = "within")
reg2.2.13 <- plm::plm(diff_goal13 ~ after2015 + year + after2015:year,
data = panel_data,
model = "within")
reg2.2.15 <- plm::plm(diff_goal15 ~ after2015 + year + after2015:year,
data = panel_data,
model = "within")
reg2.2.16 <- plm::plm(diff_goal16 ~ after2015 + year + after2015:year,
data = panel_data,
model = "within")
reg2.2.17 <- plm::plm(diff_goal17 ~ after2015 + year + after2015:year,
data = panel_data,
model = "within")
# Create a list of your regression models
models_list2 <- list("Overall score"=reg2.2, "Goal 1"=reg2.2.1, "Goal 2"=reg2.2.2, "Goal 3"= reg2.2.3, "Goal 4"=reg2.2.4, "Goal 5"=reg2.2.5, "Goal 6"= reg2.2.6, "Goal 7"=reg2.2.7, "Goal 8"=reg2.2.8, "Goal 9"=reg2.2.9, "Goal 10"=reg2.2.10, "Goal 11" = reg2.2.11,"Goal 12"=reg2.2.12, "Goal 13"=reg2.2.13, "Goal 15" =reg2.2.15, "Goal 16"=reg2.2.16, "Goal 17"=reg2.2.17)
huxreg(
lapply(models_list2, function(model) {
coefficients <- broom::tidy(model, conf.int = TRUE)
significant_after2015 <- coefficients[coefficients$term == "after2015" & coefficients$p.value < 0.05, ]
if (nrow(significant_after2015) > 0) {
return(significant_after2015)
} else {
return(NULL)  # Exclude non-significant models
}
})
)
huxreg(
lapply(models_list2, function(model) {
coefficients <- broom::tidy(model, conf.int = TRUE)
significant_after2015 <- coefficients[coefficients$term == "after2015" & coefficients$p.value < 0.05, ]
if ("after2015" %in% coefficients$term) {
return(significant_after2015)
} else {
return(NULL)  # Exclude non-significant models
}
})
)
huxreg(
lapply(models_list2, function(model) {
coefficients <- broom::tidy(model, conf.int = TRUE)
significant_after2015 <- coefficients[coefficients$p.value < 0.05, ]
if (nrow(significant_after2015) > 0) {
return(significant_after2015)
} else {
return(NULL)  # Exclude non-significant models
}
})
)
huxreg(
lapply(models_list2, function(model) {
coefficients <- broom::tidy(model, conf.int = TRUE)
significant_after2015 <- coefficients[coefficients$term == "after2015" & coefficients$p.value < 0.05, ]
if (nrow(significant_after2015) > 0) {
return(coefficients)
} else {
return(coefficients[0, ])  # Return a data frame with 0 rows to exclude the entire column
}
})
)
huxreg(
lapply(models_list2, function(model) {
coefficients <- broom::tidy(model, conf.int = TRUE)
significant_after2015 <- coefficients[coefficients$term == "after2015" & coefficients$p.value < 0.05, ]
return(significant_after2015)
})
)
significant_models <- lapply(models_list2, function(model) {
coefficients <- broom::tidy(model, conf.int = TRUE)
significant_after2015 <- coefficients[coefficients$term == "after2015" & coefficients$p.value < 0.05, ]
if (nrow(significant_after2015) > 0) {
return(model)
} else {
return(NULL)
}
})
significant_models <- lapply(models_list2, function(model) {
coefficients <- broom::tidy(model, conf.int = TRUE)
significant_after2015 <- coefficients[coefficients$term == "after2015" & coefficients$p.value < 0.05, ]
if (nrow(significant_after2015) > 0) {
return(model)
} else {
return(NULL)
}
})
# Create a panel data object
panel_data <- plm::pdata.frame(binary2015, index = c("country", "year"))
# Run the difference-in-differences model to take into account the general evolution over the years
reg2.2 <- plm::plm(diff_overallscore ~ after2015 + year + after2015:year,
data = panel_data,
model = "within")
reg2.2.1 <- plm::plm(diff_goal1 ~ after2015 + year + after2015:year,
data = panel_data,
model = "within")
reg2.2.2 <- plm::plm(diff_goal2 ~ after2015 + year + after2015:year,
data = panel_data,
model = "within")
reg2.2.3 <- plm::plm(diff_goal3 ~ after2015 + year + after2015:year,
data = panel_data,
model = "within")
reg2.2.4 <- plm::plm(diff_goal4 ~ after2015 + year + after2015:year,
data = panel_data,
model = "within")
reg2.2.5 <- plm::plm(diff_goal5 ~ after2015 + year + after2015:year,
data = panel_data,
model = "within")
reg2.2.6 <- plm::plm(diff_goal6 ~ after2015 + year + after2015:year,
data = panel_data,
model = "within")
reg2.2.7 <- plm::plm(diff_goal7 ~ after2015 + year + after2015:year,
data = panel_data,
model = "within")
reg2.2.8 <- plm::plm(diff_goal8 ~ after2015 + year + after2015:year,
data = panel_data,
model = "within")
reg2.2.9 <- plm::plm(diff_goal9 ~ after2015 + year + after2015:year,
data = panel_data,
model = "within")
reg2.2.10 <- plm::plm(diff_goal10 ~ after2015 + year + after2015:year,
data = panel_data,
model = "within")
reg2.2.11 <- plm::plm(diff_goal11 ~ after2015 + year + after2015:year,
data = panel_data,
model = "within")
reg2.2.12 <- plm::plm(diff_goal12 ~ after2015 + year + after2015:year,
data = panel_data,
model = "within")
reg2.2.13 <- plm::plm(diff_goal13 ~ after2015 + year + after2015:year,
data = panel_data,
model = "within")
reg2.2.15 <- plm::plm(diff_goal15 ~ after2015 + year + after2015:year,
data = panel_data,
model = "within")
reg2.2.16 <- plm::plm(diff_goal16 ~ after2015 + year + after2015:year,
data = panel_data,
model = "within")
reg2.2.17 <- plm::plm(diff_goal17 ~ after2015 + year + after2015:year,
data = panel_data,
model = "within")
# Create a list of your regression models
models_list2 <- list("Overall score"=reg2.2, "Goal 1"=reg2.2.1, "Goal 2"=reg2.2.2, "Goal 3"= reg2.2.3, "Goal 4"=reg2.2.4, "Goal 5"=reg2.2.5, "Goal 6"= reg2.2.6, "Goal 7"=reg2.2.7, "Goal 8"=reg2.2.8, "Goal 9"=reg2.2.9, "Goal 10"=reg2.2.10, "Goal 11" = reg2.2.11,"Goal 12"=reg2.2.12, "Goal 13"=reg2.2.13, "Goal 15" =reg2.2.15, "Goal 16"=reg2.2.16, "Goal 17"=reg2.2.17)
significant_models <- lapply(models_list2, function(model) {
coefficients <- broom::tidy(model, conf.int = TRUE)
significant_after2015 <- coefficients[coefficients$term == "after2015" & coefficients$p.value < 0.05, ]
if (nrow(significant_after2015) > 0) {
return(model)
} else {
return(NULL)
}
})
huxreg(models_list2[1:9])
huxreg(models_list2[10:17])
significant_models <- lapply(models_list2, function(model) {
coefficients <- broom::tidy(model, conf.int = TRUE)
significant_after2015 <- coefficients[coefficients$term == "after2015" & coefficients$p.value < 0.05, ]
if (nrow(significant_after2015) != 0) {
return(model)
} else {
return(NULL)
}
})
huxreg(
lapply(models_list2, function(model) {
coefficients <- broom::tidy(model, conf.int = TRUE)
significant_after2015 <- coefficients[coefficients$term == "after2015" & coefficients$p.value < 0.05, ]
return(significant_after2015)
})
)
