<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>eda</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="eda_files/libs/clipboard/clipboard.min.js"></script>
<script src="eda_files/libs/quarto-html/quarto.js"></script>
<script src="eda_files/libs/quarto-html/popper.min.js"></script>
<script src="eda_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="eda_files/libs/quarto-html/anchor.min.js"></script>
<link href="eda_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="eda_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="eda_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="eda_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="eda_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

<script src="eda_files/libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
<link href="eda_files/libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="eda_files/libs/datatables-binding-0.30/datatables.js"></script>
<script src="eda_files/libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="eda_files/libs/dt-core-1.13.4/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="eda_files/libs/dt-core-1.13.4/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="eda_files/libs/dt-core-1.13.4/js/jquery.dataTables.min.js"></script>
<link href="eda_files/libs/dt-plugin-searchhighlight-1.13.4/source.css" rel="stylesheet">
<script src="eda_files/libs/dt-plugin-searchhighlight-1.13.4/jquery.highlight.js"></script>
<script src="eda_files/libs/dt-plugin-searchhighlight-1.13.4/source.min.js"></script>
<link href="eda_files/libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="eda_files/libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">



<section id="exploratory-data-analysis" class="level1">
<h1>Exploratory data analysis</h1>
<section id="general-exploration" class="level2">
<h2 class="anchored" data-anchor-id="general-exploration">General exploration</h2>
<p>We display the distribution of the different SDG achievement scores, using boxplots to have an overview of the median, the range with most of the observations and the outliers.</p>
<div class="cell" data-layout-align="center" data-hash="eda_cache/html/unnamed-chunk-1_c07ec88f5dc295ba86105c049710fe0c">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>data_question1 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="fu">here</span>(<span class="st">"scripts"</span>,<span class="st">"data"</span>,<span class="st">"data_question1.csv"</span>))</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>data_question24 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="fu">here</span>(<span class="st">"scripts"</span>, <span class="st">"data"</span>, <span class="st">"data_question24.csv"</span>))</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>data_question2 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="fu">here</span>(<span class="st">"scripts"</span>, <span class="st">"data"</span>, <span class="st">"data_question24.csv"</span>))</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>data_question3_1 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="fu">here</span>(<span class="st">"scripts"</span>, <span class="st">"data"</span>, <span class="st">"data_question3_1.csv"</span>))</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>data_question3_2 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="fu">here</span>(<span class="st">"scripts"</span>, <span class="st">"data"</span>, <span class="st">"data_question3_2.csv"</span>))</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>data_question3_3 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="fu">here</span>(<span class="st">"scripts"</span>, <span class="st">"data"</span>, <span class="st">"data_question3_3.csv"</span>))</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>Q3<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="fu">here</span>(<span class="st">"scripts"</span>, <span class="st">"data"</span>, <span class="st">"data_question3_1.csv"</span>))</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>Q3<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="fu">here</span>(<span class="st">"scripts"</span>, <span class="st">"data"</span>, <span class="st">"data_question3_2.csv"</span>))</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>Q3<span class="fl">.3</span> <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="fu">here</span>(<span class="st">"scripts"</span>, <span class="st">"data"</span>, <span class="st">"data_question3_3.csv"</span>))</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="fu">here</span>(<span class="st">"scripts"</span>, <span class="st">"data"</span>, <span class="st">"all_Merge.csv"</span>))</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>Correlation_overall <span class="ot">&lt;-</span> data_question1 <span class="sc">%&gt;%</span> </span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>      <span class="fu">select</span>(population<span class="sc">:</span>ef_regulation)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="do">#### boxplots ####</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="co">#for goals</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="co">#dev.off()</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="co"># boxplot(Correlation_overall[2:18], </span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="co">#         las = 2,            # Makes the axis labels perpendicular to the axis</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="co">#         par(mar = c(5, 4, 4, 2) + 0.1),  # Adjusts the margins to fit all labels</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="co">#         cex.axis = 0.7,      # Reduces the size of the axis labels</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="co">#         cex.lab = 1,       # Reduces the size of the x and y labels</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="co">#         notch = TRUE,       # Specifies whether to add notches or not</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="co">#         main = "Merged goals boxplot", # Title of the boxplot</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="co">#         xlab = "Goals",  # X-axis label</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a><span class="co">#         ylab = "Score")     # Y-axis label</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a><span class="co">#boxplot per continent</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>data_Q1_Africa <span class="ot">&lt;-</span> data_question1 <span class="sc">%&gt;%</span></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(data_question1<span class="sc">$</span>continent <span class="sc">==</span> <span class="st">'Africa'</span>)</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>data_Q1_Europe <span class="ot">&lt;-</span> data_question1 <span class="sc">%&gt;%</span></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(data_question1<span class="sc">$</span>continent <span class="sc">==</span> <span class="st">'Europe'</span>)</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>data_Q1_Asia <span class="ot">&lt;-</span> data_question1 <span class="sc">%&gt;%</span></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(data_question1<span class="sc">$</span>continent <span class="sc">==</span> <span class="st">'Asia'</span>)</span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>data_Q1_Americas <span class="ot">&lt;-</span> data_question1 <span class="sc">%&gt;%</span></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(data_question1<span class="sc">$</span>continent <span class="sc">==</span> <span class="st">'Americas'</span>)</span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>data_Q1_Oceania <span class="ot">&lt;-</span> data_question1 <span class="sc">%&gt;%</span></span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(data_question1<span class="sc">$</span>continent <span class="sc">==</span> <span class="st">'Oceania'</span>)</span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a><span class="co">#Africa</span></span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>data_Q1_Africa_long <span class="ot">&lt;-</span> <span class="fu">melt</span>(data_Q1_Africa[,<span class="dv">8</span><span class="sc">:</span><span class="dv">24</span>])</span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>medians_AF <span class="ot">&lt;-</span> data_Q1_Africa_long <span class="sc">%&gt;%</span></span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(variable) <span class="sc">%&gt;%</span></span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">median_value =</span> <span class="fu">median</span>(value))</span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>medians_AF<span class="sc">$</span>color <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(medians_AF<span class="sc">$</span>median_value <span class="sc">&gt;</span> <span class="dv">75</span>, <span class="st">"lightblue"</span>, </span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">ifelse</span>(medians_AF<span class="sc">$</span>median_value <span class="sc">&lt;</span> <span class="dv">25</span>, <span class="st">"red"</span>, <span class="st">'orange'</span>))</span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a>data_Q1_Africa_long <span class="ot">&lt;-</span> data_Q1_Africa_long <span class="sc">%&gt;%</span></span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(medians_AF, <span class="at">by =</span> <span class="st">"variable"</span>)</span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a>bandwidth_nrd_AF <span class="ot">&lt;-</span> <span class="fu">bw.nrd</span>(data_Q1_Africa_long<span class="sc">$</span>value)</span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_Q1_Africa_long, <span class="fu">aes</span>(<span class="at">x =</span> variable, <span class="at">y =</span> value, <span class="at">fill =</span> color)) <span class="sc">+</span> </span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">trim =</span> <span class="cn">FALSE</span>, <span class="at">bw =</span> bandwidth_nrd_AF) <span class="sc">+</span>  </span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_identity</span>() <span class="sc">+</span></span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Africa SDG goals boxplot"</span>, <span class="at">x =</span> <span class="st">"Goals"</span>, <span class="at">y =</span> <span class="st">"Score"</span>) <span class="sc">+</span></span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width =</span> <span class="fl">0.1</span>, <span class="at">outlier.size =</span> <span class="dv">1</span>, <span class="at">fill =</span> <span class="st">'white'</span>) <span class="sc">+</span></span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">label_number</span>()) <span class="sc">+</span></span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a><span class="co">#Europe</span></span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a>data_Q1_Europe_long <span class="ot">&lt;-</span> <span class="fu">melt</span>(data_Q1_Europe[,<span class="dv">8</span><span class="sc">:</span><span class="dv">24</span>])</span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a>medians_EU <span class="ot">&lt;-</span> data_Q1_Europe_long <span class="sc">%&gt;%</span></span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(variable) <span class="sc">%&gt;%</span></span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">median_value =</span> <span class="fu">median</span>(value))</span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a>medians_EU<span class="sc">$</span>color <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(medians_EU<span class="sc">$</span>median_value <span class="sc">&gt;</span> <span class="dv">75</span>, <span class="st">"lightblue"</span>, </span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">ifelse</span>(medians_EU<span class="sc">$</span>median_value <span class="sc">&lt;</span> <span class="dv">25</span>, <span class="st">"red"</span>, <span class="st">'orange'</span>))</span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a>data_Q1_Europe_long <span class="ot">&lt;-</span> data_Q1_Europe_long <span class="sc">%&gt;%</span></span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(medians_EU, <span class="at">by =</span> <span class="st">"variable"</span>)</span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-75"><a href="#cb1-75" aria-hidden="true" tabindex="-1"></a>bandwidth_nrd_EU <span class="ot">&lt;-</span> <span class="fu">bw.nrd</span>(data_Q1_Europe_long<span class="sc">$</span>value)</span>
<span id="cb1-76"><a href="#cb1-76" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_Q1_Europe_long, <span class="fu">aes</span>(<span class="at">x =</span> variable, <span class="at">y =</span> value, <span class="at">fill =</span> color)) <span class="sc">+</span> </span>
<span id="cb1-77"><a href="#cb1-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">trim =</span> <span class="cn">FALSE</span>, <span class="at">bw =</span> bandwidth_nrd_EU) <span class="sc">+</span></span>
<span id="cb1-78"><a href="#cb1-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_identity</span>() <span class="sc">+</span></span>
<span id="cb1-79"><a href="#cb1-79" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"European SDG goals boxplot"</span>, <span class="at">x =</span> <span class="st">"Goals"</span>, <span class="at">y =</span> <span class="st">"Score"</span>) <span class="sc">+</span></span>
<span id="cb1-80"><a href="#cb1-80" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width =</span> <span class="fl">0.1</span>, <span class="at">outlier.size =</span> <span class="dv">1</span>, <span class="at">fill =</span> <span class="st">'white'</span>) <span class="sc">+</span></span>
<span id="cb1-81"><a href="#cb1-81" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">label_number</span>()) <span class="sc">+</span></span>
<span id="cb1-82"><a href="#cb1-82" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb1-83"><a href="#cb1-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span>
<span id="cb1-84"><a href="#cb1-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-85"><a href="#cb1-85" aria-hidden="true" tabindex="-1"></a><span class="co">#Asia</span></span>
<span id="cb1-86"><a href="#cb1-86" aria-hidden="true" tabindex="-1"></a>data_Q1_Asia_long <span class="ot">&lt;-</span> <span class="fu">melt</span>(data_Q1_Asia[,<span class="dv">8</span><span class="sc">:</span><span class="dv">24</span>])</span>
<span id="cb1-87"><a href="#cb1-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-88"><a href="#cb1-88" aria-hidden="true" tabindex="-1"></a>medians_AS <span class="ot">&lt;-</span> data_Q1_Asia_long <span class="sc">%&gt;%</span></span>
<span id="cb1-89"><a href="#cb1-89" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(variable) <span class="sc">%&gt;%</span></span>
<span id="cb1-90"><a href="#cb1-90" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">median_value =</span> <span class="fu">median</span>(value))</span>
<span id="cb1-91"><a href="#cb1-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-92"><a href="#cb1-92" aria-hidden="true" tabindex="-1"></a>medians_AS<span class="sc">$</span>color <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(medians_AS<span class="sc">$</span>median_value <span class="sc">&gt;</span> <span class="dv">75</span>, <span class="st">"lightblue"</span>, </span>
<span id="cb1-93"><a href="#cb1-93" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">ifelse</span>(medians_AS<span class="sc">$</span>median_value <span class="sc">&lt;</span> <span class="dv">25</span>, <span class="st">"red"</span>, <span class="st">'orange'</span>))</span>
<span id="cb1-94"><a href="#cb1-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-95"><a href="#cb1-95" aria-hidden="true" tabindex="-1"></a>data_Q1_Asia_long <span class="ot">&lt;-</span> data_Q1_Asia_long <span class="sc">%&gt;%</span></span>
<span id="cb1-96"><a href="#cb1-96" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(medians_AS, <span class="at">by =</span> <span class="st">"variable"</span>)</span>
<span id="cb1-97"><a href="#cb1-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-98"><a href="#cb1-98" aria-hidden="true" tabindex="-1"></a>bandwidth_nrd_AS <span class="ot">&lt;-</span> <span class="fu">bw.nrd</span>(data_Q1_Asia_long<span class="sc">$</span>value)</span>
<span id="cb1-99"><a href="#cb1-99" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_Q1_Asia_long, <span class="fu">aes</span>(<span class="at">x =</span> variable, <span class="at">y =</span> value, <span class="at">fill =</span> color)) <span class="sc">+</span> </span>
<span id="cb1-100"><a href="#cb1-100" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">trim =</span> <span class="cn">FALSE</span>, <span class="at">bw =</span> bandwidth_nrd_AS) <span class="sc">+</span></span>
<span id="cb1-101"><a href="#cb1-101" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_identity</span>() <span class="sc">+</span></span>
<span id="cb1-102"><a href="#cb1-102" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Asian SDG goals boxplot"</span>, <span class="at">x =</span> <span class="st">"Goals"</span>, <span class="at">y =</span> <span class="st">"Score"</span>) <span class="sc">+</span></span>
<span id="cb1-103"><a href="#cb1-103" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width =</span> <span class="fl">0.1</span>, <span class="at">outlier.size =</span> <span class="dv">1</span>, <span class="at">fill =</span> <span class="st">'white'</span>) <span class="sc">+</span></span>
<span id="cb1-104"><a href="#cb1-104" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">label_number</span>()) <span class="sc">+</span></span>
<span id="cb1-105"><a href="#cb1-105" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb1-106"><a href="#cb1-106" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span>
<span id="cb1-107"><a href="#cb1-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-108"><a href="#cb1-108" aria-hidden="true" tabindex="-1"></a><span class="co">#Americas</span></span>
<span id="cb1-109"><a href="#cb1-109" aria-hidden="true" tabindex="-1"></a>data_Q1_Americas_long <span class="ot">&lt;-</span> <span class="fu">melt</span>(data_Q1_Americas[,<span class="dv">8</span><span class="sc">:</span><span class="dv">24</span>])</span>
<span id="cb1-110"><a href="#cb1-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-111"><a href="#cb1-111" aria-hidden="true" tabindex="-1"></a>medians_AM <span class="ot">&lt;-</span> data_Q1_Americas_long <span class="sc">%&gt;%</span></span>
<span id="cb1-112"><a href="#cb1-112" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(variable) <span class="sc">%&gt;%</span></span>
<span id="cb1-113"><a href="#cb1-113" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">median_value =</span> <span class="fu">median</span>(value))</span>
<span id="cb1-114"><a href="#cb1-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-115"><a href="#cb1-115" aria-hidden="true" tabindex="-1"></a>medians_AM<span class="sc">$</span>color <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(medians_AM<span class="sc">$</span>median_value <span class="sc">&gt;</span> <span class="dv">75</span>, <span class="st">"lightblue"</span>, </span>
<span id="cb1-116"><a href="#cb1-116" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">ifelse</span>(medians_AM<span class="sc">$</span>median_value <span class="sc">&lt;</span> <span class="dv">25</span>, <span class="st">"red"</span>, <span class="st">'orange'</span>))</span>
<span id="cb1-117"><a href="#cb1-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-118"><a href="#cb1-118" aria-hidden="true" tabindex="-1"></a>data_Q1_Americas_long <span class="ot">&lt;-</span> data_Q1_Americas_long <span class="sc">%&gt;%</span></span>
<span id="cb1-119"><a href="#cb1-119" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(medians_AM, <span class="at">by =</span> <span class="st">"variable"</span>)</span>
<span id="cb1-120"><a href="#cb1-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-121"><a href="#cb1-121" aria-hidden="true" tabindex="-1"></a>bandwidth_nrd_AM <span class="ot">&lt;-</span> <span class="fu">bw.nrd</span>(data_Q1_Americas_long<span class="sc">$</span>value)</span>
<span id="cb1-122"><a href="#cb1-122" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_Q1_Americas_long, <span class="fu">aes</span>(<span class="at">x =</span> variable, <span class="at">y =</span> value, <span class="at">fill =</span> color)) <span class="sc">+</span> </span>
<span id="cb1-123"><a href="#cb1-123" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">trim =</span> <span class="cn">FALSE</span>, <span class="at">bw =</span> bandwidth_nrd_AM) <span class="sc">+</span></span>
<span id="cb1-124"><a href="#cb1-124" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_identity</span>() <span class="sc">+</span></span>
<span id="cb1-125"><a href="#cb1-125" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"American SDG goals boxplot"</span>, <span class="at">x =</span> <span class="st">"Goals"</span>, <span class="at">y =</span> <span class="st">"Score"</span>) <span class="sc">+</span></span>
<span id="cb1-126"><a href="#cb1-126" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width =</span> <span class="fl">0.1</span>, <span class="at">outlier.size =</span> <span class="dv">1</span>, <span class="at">fill =</span> <span class="st">'white'</span>) <span class="sc">+</span></span>
<span id="cb1-127"><a href="#cb1-127" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">label_number</span>()) <span class="sc">+</span></span>
<span id="cb1-128"><a href="#cb1-128" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb1-129"><a href="#cb1-129" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span>
<span id="cb1-130"><a href="#cb1-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-131"><a href="#cb1-131" aria-hidden="true" tabindex="-1"></a><span class="co">#Oceania</span></span>
<span id="cb1-132"><a href="#cb1-132" aria-hidden="true" tabindex="-1"></a>data_Q1_Oceania_long <span class="ot">&lt;-</span> <span class="fu">melt</span>(data_Q1_Oceania[,<span class="dv">8</span><span class="sc">:</span><span class="dv">24</span>])</span>
<span id="cb1-133"><a href="#cb1-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-134"><a href="#cb1-134" aria-hidden="true" tabindex="-1"></a>medians_OC <span class="ot">&lt;-</span> data_Q1_Oceania_long <span class="sc">%&gt;%</span></span>
<span id="cb1-135"><a href="#cb1-135" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(variable) <span class="sc">%&gt;%</span></span>
<span id="cb1-136"><a href="#cb1-136" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">median_value =</span> <span class="fu">median</span>(value))</span>
<span id="cb1-137"><a href="#cb1-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-138"><a href="#cb1-138" aria-hidden="true" tabindex="-1"></a>medians_OC<span class="sc">$</span>color <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(medians_OC<span class="sc">$</span>median_value <span class="sc">&gt;</span> <span class="dv">75</span>, <span class="st">"lightblue"</span>, </span>
<span id="cb1-139"><a href="#cb1-139" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">ifelse</span>(medians_OC<span class="sc">$</span>median_value <span class="sc">&lt;</span> <span class="dv">25</span>, <span class="st">"red"</span>, <span class="st">'orange'</span>))</span>
<span id="cb1-140"><a href="#cb1-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-141"><a href="#cb1-141" aria-hidden="true" tabindex="-1"></a>data_Q1_Oceania_long <span class="ot">&lt;-</span> data_Q1_Oceania_long <span class="sc">%&gt;%</span></span>
<span id="cb1-142"><a href="#cb1-142" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(medians_OC, <span class="at">by =</span> <span class="st">"variable"</span>)</span>
<span id="cb1-143"><a href="#cb1-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-144"><a href="#cb1-144" aria-hidden="true" tabindex="-1"></a>bandwidth_nrd_OC <span class="ot">&lt;-</span> <span class="fu">bw.nrd</span>(data_Q1_Oceania_long<span class="sc">$</span>value)</span>
<span id="cb1-145"><a href="#cb1-145" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_Q1_Oceania_long, <span class="fu">aes</span>(<span class="at">x =</span> variable, <span class="at">y =</span> value, <span class="at">fill =</span> color)) <span class="sc">+</span> </span>
<span id="cb1-146"><a href="#cb1-146" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">trim =</span> <span class="cn">FALSE</span>, <span class="at">bw =</span> bandwidth_nrd_OC) <span class="sc">+</span></span>
<span id="cb1-147"><a href="#cb1-147" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_identity</span>() <span class="sc">+</span></span>
<span id="cb1-148"><a href="#cb1-148" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Oceanian SDG goals boxplot"</span>, <span class="at">x =</span> <span class="st">"Goals"</span>, <span class="at">y =</span> <span class="st">"Score"</span>) <span class="sc">+</span></span>
<span id="cb1-149"><a href="#cb1-149" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width =</span> <span class="fl">0.1</span>, <span class="at">outlier.size =</span> <span class="dv">1</span>, <span class="at">fill =</span> <span class="st">'white'</span>) <span class="sc">+</span></span>
<span id="cb1-150"><a href="#cb1-150" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">label_number</span>()) <span class="sc">+</span></span>
<span id="cb1-151"><a href="#cb1-151" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb1-152"><a href="#cb1-152" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span>
<span id="cb1-153"><a href="#cb1-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-154"><a href="#cb1-154" aria-hidden="true" tabindex="-1"></a><span class="co"># Correlation_goals &lt;- melt(Correlation_overall[,2:18])</span></span>
<span id="cb1-155"><a href="#cb1-155" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot(Correlation_goals, aes(x= variable, y= value)) + </span></span>
<span id="cb1-156"><a href="#cb1-156" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_violin(trim=FALSE, fill="orange") +</span></span>
<span id="cb1-157"><a href="#cb1-157" aria-hidden="true" tabindex="-1"></a><span class="co">#   labs(title="Merged goals violin boxplot",x="Goals", y = "Distribution") +</span></span>
<span id="cb1-158"><a href="#cb1-158" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_boxplot(width=0.1, outlier.size = 1) +</span></span>
<span id="cb1-159"><a href="#cb1-159" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_y_continuous(labels = scales::label_number()) + #limits = c(0, 100)</span></span>
<span id="cb1-160"><a href="#cb1-160" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme_classic() +</span></span>
<span id="cb1-161"><a href="#cb1-161" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))</span></span>
<span id="cb1-162"><a href="#cb1-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-163"><a href="#cb1-163" aria-hidden="true" tabindex="-1"></a><span class="do">#### WHY GOING BELOW 0 TO &gt; 100 ?? SCORES ONLY FROM 0 TO 100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="eda_files/figure-html/unnamed-chunk-1-1.png" style="width:100.0%;height:100.0%" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="eda_files/figure-html/unnamed-chunk-1-2.png" style="width:100.0%;height:100.0%" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="eda_files/figure-html/unnamed-chunk-1-3.png" style="width:100.0%;height:100.0%" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="eda_files/figure-html/unnamed-chunk-1-4.png" style="width:100.0%;height:100.0%" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="eda_files/figure-html/unnamed-chunk-1-5.png" style="width:100.0%;height:100.0%" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>We see different schemes among the different goals. Indeed some are quite homogeneous with a small spread of values (e.g.&nbsp;overall score, goals 2 and 8) while others have a large spread of values (e.g.&nbsp;goals 1 and 10). Goals 1, 3, 4, 7, 9, 10 and 13 have values across all possible percentages. Goals 2, 5, 8, 13 and 17 have extreme values situated outside the 95% confidence interval. It is interesting to see that goal 8 (decent work and economic growth) is the one with smaller spread of values, whereas goal 1 (no poverty) have the higher distance between the first and the third quartile. Goal 2 (no hunger) has a tight spread of values, but with the greater amount of outliers in the smaller values, meaning hunger is similar across most countries, but when it differs it is in very bad manner.</p>
<p>We now display boxplpots for the different variables of the human freedom index, and then also for our other independent variables.</p>
<div class="cell" data-layout-align="center" data-hash="eda_cache/html/unnamed-chunk-2_621758b8a8bfc13c1c67b1a561dafe6c">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">#for Human Freedom Index scores </span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Oceania</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>data_Q1_Oceania_HFI_long <span class="ot">&lt;-</span> <span class="fu">melt</span>(data_Q1_Oceania[,<span class="dv">29</span><span class="sc">:</span><span class="dv">40</span>])</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>medians_HFI_OC <span class="ot">&lt;-</span> data_Q1_Oceania_HFI_long <span class="sc">%&gt;%</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(variable) <span class="sc">%&gt;%</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">median_value =</span> <span class="fu">median</span>(value))</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>medians_HFI_OC<span class="sc">$</span>color <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(medians_HFI_OC<span class="sc">$</span>median_value <span class="sc">&gt;</span> <span class="fl">7.5</span>, <span class="st">"lightblue"</span>, </span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">ifelse</span>(medians_HFI_OC<span class="sc">$</span>median_value <span class="sc">&lt;</span> <span class="fl">2.5</span>, <span class="st">"red"</span>, <span class="st">'orange'</span>))</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>data_Q1_Oceania_HFI_long <span class="ot">&lt;-</span> data_Q1_Oceania_HFI_long <span class="sc">%&gt;%</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(medians_HFI_OC, <span class="at">by =</span> <span class="st">"variable"</span>)</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>bandwidth_nrd_HFI_OC <span class="ot">&lt;-</span> <span class="fu">bw.nrd</span>(data_Q1_Oceania_HFI_long<span class="sc">$</span>value)</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_Q1_Oceania_HFI_long, <span class="fu">aes</span>(<span class="at">x =</span> variable, <span class="at">y =</span> value, <span class="at">fill =</span> color)) <span class="sc">+</span> </span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">trim =</span> <span class="cn">FALSE</span>, <span class="at">bw =</span> bandwidth_nrd_HFI_OC) <span class="sc">+</span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_identity</span>() <span class="sc">+</span></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Oceanian HFI Scores boxplot"</span>, <span class="at">x =</span> <span class="st">"Human Freedom Index goals"</span>, <span class="at">y =</span> <span class="st">"Score"</span>) <span class="sc">+</span></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width =</span> <span class="fl">0.1</span>, <span class="at">outlier.size =</span> <span class="dv">1</span>, <span class="at">fill =</span> <span class="st">'white'</span>) <span class="sc">+</span></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">label_number</span>()) <span class="sc">+</span></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(Correlation_overall[<span class="dv">23</span><span class="sc">:</span><span class="dv">34</span>], </span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">las =</span> <span class="dv">2</span>,            <span class="co"># Makes the axis labels perpendicular to the axis</span></span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>        <span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">7</span>, <span class="dv">5</span>, <span class="dv">2</span>, <span class="dv">1</span>)),  <span class="co"># Adjusts the margins to fit all labels</span></span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>        <span class="at">cex.axis =</span> <span class="fl">0.7</span>,      <span class="co"># Reduces the size of the axis labels</span></span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>        <span class="at">cex.lab =</span> <span class="dv">1</span>,       <span class="co"># Reduces the size of the x and y labels</span></span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">notch =</span> <span class="cn">TRUE</span>,       <span class="co"># Specifies whether to add notches or not</span></span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">"Merged Human Freedom Index scores boxplot"</span>, </span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylab =</span> <span class="st">"Score"</span>)     <span class="co"># Y-axis label</span></span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>Correlation_HFI <span class="ot">&lt;-</span> <span class="fu">melt</span>(Correlation_overall[,<span class="dv">23</span><span class="sc">:</span><span class="dv">34</span>])</span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(Correlation_HFI, <span class="fu">aes</span>(<span class="at">x=</span> variable, <span class="at">y=</span> value)) <span class="sc">+</span> </span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">trim=</span><span class="cn">FALSE</span>, <span class="at">fill=</span><span class="st">"orange"</span>)<span class="sc">+</span></span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Merged Human Freedom Index scores violin boxplot"</span>,<span class="at">x=</span><span class="st">"Variables"</span>, <span class="at">y =</span> <span class="st">"Score"</span>)<span class="sc">+</span></span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width=</span><span class="fl">0.1</span>, <span class="at">outlier.size =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">label_number</span>()) <span class="sc">+</span> <span class="co">#limits = c(0, 100)</span></span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust=</span><span class="dv">1</span>))</span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a>v1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(Correlation_overall, <span class="fu">aes</span>(<span class="at">x=</span> <span class="fu">factor</span>(<span class="dv">1</span>), <span class="at">y=</span> GDPpercapita)) <span class="sc">+</span> </span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">trim=</span><span class="cn">FALSE</span>, <span class="at">fill=</span><span class="st">"orange"</span>)<span class="sc">+</span></span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Violin plot of GDP per capita"</span>,<span class="at">x=</span><span class="st">"GDP per capita"</span>, <span class="at">y =</span> <span class="st">"Distribution"</span>)<span class="sc">+</span></span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width=</span><span class="fl">0.1</span>, <span class="at">outlier.size =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb2-51"><a href="#cb2-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">label_number</span>()) <span class="sc">+</span>  <span class="co"># Format y-axis labels</span></span>
<span id="cb2-52"><a href="#cb2-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb2-53"><a href="#cb2-53" aria-hidden="true" tabindex="-1"></a>v2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(Correlation_overall, <span class="fu">aes</span>(<span class="at">x=</span> <span class="fu">factor</span>(<span class="dv">1</span>), <span class="at">y=</span> unemployment.rate)) <span class="sc">+</span> </span>
<span id="cb2-54"><a href="#cb2-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">trim=</span><span class="cn">FALSE</span>, <span class="at">fill=</span><span class="st">"orange"</span>)<span class="sc">+</span></span>
<span id="cb2-55"><a href="#cb2-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Violin plot of unemployment rate"</span>,<span class="at">x=</span><span class="st">"Unemployment rate"</span>, <span class="at">y =</span> <span class="st">"Distribution"</span>)<span class="sc">+</span></span>
<span id="cb2-56"><a href="#cb2-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width=</span><span class="fl">0.1</span>, <span class="at">outlier.size =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb2-57"><a href="#cb2-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">label_number</span>()) <span class="sc">+</span>  <span class="co"># Format y-axis labels</span></span>
<span id="cb2-58"><a href="#cb2-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb2-59"><a href="#cb2-59" aria-hidden="true" tabindex="-1"></a>v3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(Correlation_overall, <span class="fu">aes</span>(<span class="at">x=</span> <span class="fu">factor</span>(<span class="dv">1</span>), <span class="at">y=</span> MilitaryExpenditurePercentGDP)) <span class="sc">+</span> </span>
<span id="cb2-60"><a href="#cb2-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">trim=</span><span class="cn">FALSE</span>, <span class="at">fill=</span><span class="st">"orange"</span>)<span class="sc">+</span></span>
<span id="cb2-61"><a href="#cb2-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Violin plot of military expenditure by percentage of GDP"</span>,<span class="at">x=</span><span class="st">"Military Expenditure"</span>, <span class="at">y =</span> <span class="st">"Distribution"</span>)<span class="sc">+</span></span>
<span id="cb2-62"><a href="#cb2-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width=</span><span class="fl">0.1</span>, <span class="at">outlier.size =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb2-63"><a href="#cb2-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">label_number</span>()) <span class="sc">+</span>  <span class="co"># Format y-axis labels</span></span>
<span id="cb2-64"><a href="#cb2-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb2-65"><a href="#cb2-65" aria-hidden="true" tabindex="-1"></a>v4 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(Correlation_overall, <span class="fu">aes</span>(<span class="at">x=</span> <span class="fu">factor</span>(<span class="dv">1</span>), <span class="at">y=</span> internet_usage)) <span class="sc">+</span> </span>
<span id="cb2-66"><a href="#cb2-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">trim=</span><span class="cn">FALSE</span>, <span class="at">fill=</span><span class="st">"orange"</span>)<span class="sc">+</span></span>
<span id="cb2-67"><a href="#cb2-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Violin plot of internet_usage"</span>,<span class="at">x=</span><span class="st">"internet_usage"</span>, <span class="at">y =</span> <span class="st">"Distribution"</span>)<span class="sc">+</span></span>
<span id="cb2-68"><a href="#cb2-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width=</span><span class="fl">0.1</span>, <span class="at">outlier.size =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb2-69"><a href="#cb2-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">label_number</span>()) <span class="sc">+</span>  <span class="co"># Format y-axis labels</span></span>
<span id="cb2-70"><a href="#cb2-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb2-71"><a href="#cb2-71" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(v1,v2,v3,v4, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="eda_files/figure-html/unnamed-chunk-2-1.png" style="width:100.0%;height:100.0%" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="eda_files/figure-html/unnamed-chunk-2-2.png" style="width:100.0%;height:100.0%" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="eda_files/figure-html/unnamed-chunk-2-3.png" style="width:100.0%;height:100.0%" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="eda_files/figure-html/unnamed-chunk-2-4.png" style="width:100.0%;height:100.0%" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>We now look at the variables in a summary table to have a more precise view of the numbers.</p>
<div class="cell" data-layout-align="center" data-hash="eda_cache/html/unnamed-chunk-3_00b578d17cf7f75b4267e1d1c661b874">
<div class="cell-output-display">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th">X</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">code</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">year</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">country</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">continent</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">region</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">overallscore</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">goal1</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">goal2</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">goal3</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">goal4</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">goal5</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">goal6</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">goal7</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">goal8</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">goal9</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">goal10</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">goal11</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">goal12</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">goal13</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">goal15</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">goal16</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">goal17</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Min. : 1</td>
<td style="text-align: left;">Length:3565</td>
<td style="text-align: left;">Min. :2000</td>
<td style="text-align: left;">Length:3565</td>
<td style="text-align: left;">Length:3565</td>
<td style="text-align: left;">Length:3565</td>
<td style="text-align: left;">Min. :37.4</td>
<td style="text-align: left;">Min. : 0.0</td>
<td style="text-align: left;">Min. :16.5</td>
<td style="text-align: left;">Min. : 5.9</td>
<td style="text-align: left;">Min. : 0.0</td>
<td style="text-align: left;">Min. : 3.5</td>
<td style="text-align: left;">Min. :23.3</td>
<td style="text-align: left;">Min. : 0.1</td>
<td style="text-align: left;">Min. :40.0</td>
<td style="text-align: left;">Min. : 0.3</td>
<td style="text-align: left;">Min. : 0.0</td>
<td style="text-align: left;">Min. :20.3</td>
<td style="text-align: left;">Min. :32.9</td>
<td style="text-align: left;">Min. : 0.0</td>
<td style="text-align: left;">Min. :26.0</td>
<td style="text-align: left;">Min. :27.9</td>
<td style="text-align: left;">Min. :15.1</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">1st Qu.: 892</td>
<td style="text-align: left;">Class :character</td>
<td style="text-align: left;">1st Qu.:2005</td>
<td style="text-align: left;">Class :character</td>
<td style="text-align: left;">Class :character</td>
<td style="text-align: left;">Class :character</td>
<td style="text-align: left;">1st Qu.:55.0</td>
<td style="text-align: left;">1st Qu.: 44.5</td>
<td style="text-align: left;">1st Qu.:52.6</td>
<td style="text-align: left;">1st Qu.:44.3</td>
<td style="text-align: left;">1st Qu.: 55.6</td>
<td style="text-align: left;">1st Qu.:43.2</td>
<td style="text-align: left;">1st Qu.:53.0</td>
<td style="text-align: left;">1st Qu.:41.5</td>
<td style="text-align: left;">1st Qu.:64.0</td>
<td style="text-align: left;">1st Qu.:15.5</td>
<td style="text-align: left;">1st Qu.: 35.2</td>
<td style="text-align: left;">1st Qu.:55.8</td>
<td style="text-align: left;">1st Qu.:67.9</td>
<td style="text-align: left;">1st Qu.:72.9</td>
<td style="text-align: left;">1st Qu.:55.0</td>
<td style="text-align: left;">1st Qu.:51.5</td>
<td style="text-align: left;">1st Qu.:46.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Median :1783</td>
<td style="text-align: left;">Mode :character</td>
<td style="text-align: left;">Median :2011</td>
<td style="text-align: left;">Mode :character</td>
<td style="text-align: left;">Mode :character</td>
<td style="text-align: left;">Mode :character</td>
<td style="text-align: left;">Median :65.5</td>
<td style="text-align: left;">Median : 87.4</td>
<td style="text-align: left;">Median :58.9</td>
<td style="text-align: left;">Median :70.9</td>
<td style="text-align: left;">Median : 80.6</td>
<td style="text-align: left;">Median :58.0</td>
<td style="text-align: left;">Median :65.3</td>
<td style="text-align: left;">Median :65.5</td>
<td style="text-align: left;">Median :70.2</td>
<td style="text-align: left;">Median :29.4</td>
<td style="text-align: left;">Median : 62.2</td>
<td style="text-align: left;">Median :75.3</td>
<td style="text-align: left;">Median :84.6</td>
<td style="text-align: left;">Median :90.8</td>
<td style="text-align: left;">Median :65.1</td>
<td style="text-align: left;">Median :61.4</td>
<td style="text-align: left;">Median :55.4</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Mean :1783</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">Mean :2011</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">Mean :64.0</td>
<td style="text-align: left;">Mean : 71.7</td>
<td style="text-align: left;">Mean :58.0</td>
<td style="text-align: left;">Mean :64.1</td>
<td style="text-align: left;">Mean : 72.0</td>
<td style="text-align: left;">Mean :56.0</td>
<td style="text-align: left;">Mean :65.0</td>
<td style="text-align: left;">Mean :57.9</td>
<td style="text-align: left;">Mean :70.0</td>
<td style="text-align: left;">Mean :37.5</td>
<td style="text-align: left;">Mean : 58.3</td>
<td style="text-align: left;">Mean :70.3</td>
<td style="text-align: left;">Mean :79.3</td>
<td style="text-align: left;">Mean :82.1</td>
<td style="text-align: left;">Mean :65.0</td>
<td style="text-align: left;">Mean :62.6</td>
<td style="text-align: left;">Mean :55.7</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">3rd Qu.:2674</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">3rd Qu.:2017</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">3rd Qu.:72.4</td>
<td style="text-align: left;">3rd Qu.: 98.8</td>
<td style="text-align: left;">3rd Qu.:65.3</td>
<td style="text-align: left;">3rd Qu.:81.4</td>
<td style="text-align: left;">3rd Qu.: 94.5</td>
<td style="text-align: left;">3rd Qu.:68.9</td>
<td style="text-align: left;">3rd Qu.:75.2</td>
<td style="text-align: left;">3rd Qu.:72.6</td>
<td style="text-align: left;">3rd Qu.:76.6</td>
<td style="text-align: left;">3rd Qu.:53.9</td>
<td style="text-align: left;">3rd Qu.: 81.6</td>
<td style="text-align: left;">3rd Qu.:85.1</td>
<td style="text-align: left;">3rd Qu.:94.1</td>
<td style="text-align: left;">3rd Qu.:97.2</td>
<td style="text-align: left;">3rd Qu.:74.3</td>
<td style="text-align: left;">3rd Qu.:74.6</td>
<td style="text-align: left;">3rd Qu.:65.1</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Max. :3565</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">Max. :2022</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">Max. :86.8</td>
<td style="text-align: left;">Max. :100.0</td>
<td style="text-align: left;">Max. :83.4</td>
<td style="text-align: left;">Max. :97.3</td>
<td style="text-align: left;">Max. :100.0</td>
<td style="text-align: left;">Max. :94.0</td>
<td style="text-align: left;">Max. :95.1</td>
<td style="text-align: left;">Max. :99.6</td>
<td style="text-align: left;">Max. :88.7</td>
<td style="text-align: left;">Max. :99.2</td>
<td style="text-align: left;">Max. :100.0</td>
<td style="text-align: left;">Max. :99.1</td>
<td style="text-align: left;">Max. :99.0</td>
<td style="text-align: left;">Max. :99.9</td>
<td style="text-align: left;">Max. :97.9</td>
<td style="text-align: left;">Max. :96.0</td>
<td style="text-align: left;">Max. :96.8</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA's :276</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA's :276</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="focus-on-the-influence-of-the-factors-over-the-sdg-scores" class="level2">
<h2 class="anchored" data-anchor-id="focus-on-the-influence-of-the-factors-over-the-sdg-scores">Focus on the influence of the factors over the SDG scores</h2>
<p>After importing our our cleaned data, we looked first at the correlations between our numerical variables.</p>
<div class="cell" data-layout-align="center" data-hash="eda_cache/html/unnamed-chunk-4_e7238f2954bbd4b9d3cf42296bd1538d">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="do">#### Correlations between variables ####</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>sdg_scores2 <span class="ot">&lt;-</span> data_question1[, <span class="fu">c</span>(<span class="st">'goal1'</span>, <span class="st">'goal2'</span>, <span class="st">'goal3'</span>, <span class="st">'goal4'</span>, <span class="st">'goal5'</span>, <span class="st">'goal6'</span>,</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>                      <span class="st">'goal7'</span>, <span class="st">'goal8'</span>, <span class="st">'goal9'</span>, <span class="st">'goal10'</span>, <span class="st">'goal11'</span>, <span class="st">'goal12'</span>,</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>                      <span class="st">'goal13'</span>, <span class="st">'goal15'</span>, <span class="st">'goal16'</span>, <span class="st">'goal17'</span>)]</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>Correlation_overall <span class="ot">&lt;-</span> data_question1 <span class="sc">%&gt;%</span> </span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">select</span>(population<span class="sc">:</span>ef_regulation)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="co">#before computing Pearson -&gt; logarithmic transformation may be required for some variables with high skewness</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculating skewness for each variable</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>Correlation_overall_skew <span class="ot">&lt;-</span> Correlation_overall</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>Correlation_overall_sqrt <span class="ot">&lt;-</span> Correlation_overall</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>skewness_values <span class="ot">&lt;-</span> <span class="fu">sapply</span>(Correlation_overall_skew, e1071<span class="sc">::</span>skewness)</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Identifying highly skewed variables</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>highly_skewed_vars <span class="ot">&lt;-</span> <span class="fu">names</span>(skewness_values[<span class="fu">abs</span>(skewness_values) <span class="sc">&gt;</span> <span class="dv">1</span>])</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>highly_skewed_vars_sqrt <span class="ot">&lt;-</span> <span class="fu">names</span>(skewness_values[<span class="fu">abs</span>(skewness_values) <span class="sc">&gt;</span> <span class="dv">1</span>])</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Applying logarithmic transformation</span></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>Correlation_overall_skew[highly_skewed_vars] <span class="ot">&lt;-</span> <span class="fu">lapply</span>(Correlation_overall_skew[highly_skewed_vars], <span class="cf">function</span>(x) <span class="fu">log1p</span>(x))</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a><span class="co">#applying squart root transformation</span></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>Correlation_overall_sqrt[highly_skewed_vars_sqrt] <span class="ot">&lt;-</span> <span class="fu">lapply</span>(Correlation_overall_sqrt[highly_skewed_vars_sqrt], <span class="cf">function</span>(x) <span class="fu">sqrt</span>(x))</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>new_skewness_values <span class="ot">&lt;-</span> <span class="fu">sapply</span>(Correlation_overall_skew[highly_skewed_vars], e1071<span class="sc">::</span>skewness)</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>new_skewness_values_sqrt <span class="ot">&lt;-</span> <span class="fu">sapply</span>(Correlation_overall_sqrt[highly_skewed_vars_sqrt], e1071<span class="sc">::</span>skewness)</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a><span class="co">#après transformation, il reste toujours beaucoup de variables avec un high skewness values print(new_skewness_values), print(new_skewness_values_sqrt)</span></span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>cor_matrix_log <span class="ot">&lt;-</span> <span class="fu">cor</span>(Correlation_overall_skew, <span class="at">use =</span> <span class="st">"everything"</span>)</span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>cor_matrix_sqrt <span class="ot">&lt;-</span> <span class="fu">cor</span>(Correlation_overall_sqrt, <span class="at">use =</span> <span class="st">"everything"</span>)</span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>cor_matrix_sper <span class="ot">&lt;-</span> <span class="fu">cor</span>(Correlation_overall, <span class="at">method =</span> <span class="st">"spearman"</span>, <span class="at">use =</span> <span class="st">"everything"</span>)</span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a><span class="fu">datatable</span>(cor_matrix_log, </span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a>          <span class="at">options =</span> <span class="fu">list</span>(</span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a>            <span class="at">pageLength =</span> <span class="dv">10</span>, </span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>            <span class="at">class =</span> <span class="st">"hover"</span>, </span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a>            <span class="at">searchHighlight =</span> <span class="cn">TRUE</span>,</span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a>            <span class="at">columnDefs =</span> <span class="fu">list</span>(</span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a>              <span class="fu">list</span>(<span class="at">targets =</span> <span class="st">"_all"</span>,</span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a>                   <span class="at">render =</span> <span class="fu">JS</span>(</span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"function(data, type, row, meta){"</span>,</span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"  if(type === 'display'){"</span>,</span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"    return parseFloat(data).toFixed(2)"</span>,</span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"  }"</span>,</span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"  return data;"</span>,</span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"}"</span>)))),</span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a>          <span class="at">rownames =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-836b9922ff18af62c249" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-836b9922ff18af62c249">{"x":{"filter":"none","vertical":false,"data":[[1,-0.08633278117744816,-0.05487916377164781,0.2063541962302445,-0.05989642890479693,-0.01127685591825236,-0.0463960242158199,-0.06719432463384127,-0.09425869987113251,0.09946228159606429,0.06333240925002578,-0.09608449682113582,-0.1789998966013333,0.2290575127124033,0.07884333274524699,-0.282042508479013,-0.2763245769806241,-0.1451853089094553,-0.2967140695424522,-0.100437629237225,0.08295556097987868,-0.0696786504515188,-0.2908717129168107,-0.1501770507193001,-0.3056518835207266,-0.361824387519079,-0.2712328915957977,-0.1945561406056067,-0.1411031620997867,0.0474767756427897,-0.1298856705866213,-0.1264950703947788,-0.2492470939089641,-0.2496235742493084],[-0.08633278117744816,1,0.7373546493321379,0.6755198550489347,0.9426104679920912,0.7290221560785983,0.6849049282337553,0.9046407248455857,0.9011531403269085,0.7284558871046889,0.8349130084747938,0.5621854875481495,0.8859624846113858,-0.7665386557602123,-0.4170523839578824,0.1862337283764989,0.8140572739841272,0.5720532923491378,0.1697909138416617,0.8586407684614078,0.009567746973328463,0.8048956923159956,0.6989837885951657,0.4461999866857259,0.4558435289022649,0.1719791900894227,0.3422747694128797,0.510405603238767,0.6260508976251223,-0.2129152929390958,0.7850966468431397,0.6237694703354688,0.6855501469960448,0.5480256487443572],[-0.05487916377164781,0.7373546493321379,1,0.4098097098476082,0.7340148059344347,0.609327519648026,0.3467055745409763,0.6452803908201538,0.6975420564788193,0.4670825430437641,0.5240416407452341,0.3452614592020822,0.6559565337100317,-0.5198951587756294,-0.2996084916466061,-0.01581039561378414,0.5227170378885766,0.4332505988416896,0.2341476097636653,0.6614027459685672,0.114010443476693,0.5098747598064216,0.4321408727585767,0.2741160214770913,0.2843342238810153,0.03105888128514158,0.2007047882192993,0.2983071536157981,0.3574519364287088,-0.011457151030102,0.4858034968799863,0.4171081134763703,0.5087675163904557,0.40542812927313],[0.2063541962302445,0.6755198550489347,0.4098097098476082,1,0.6401384941911159,0.5160670120536285,0.4872679606123516,0.6342156698595359,0.5753471501930886,0.5751980407050127,0.6166986892308395,0.2904720476483978,0.5478676405412457,-0.4593160287097233,-0.2400089674673597,0.04616010404090864,0.520970623992723,0.2580593162308215,0.01200437205761152,0.5809148544707651,-0.07559429170257102,0.5388814080949619,0.4271713214296465,0.3601929425557452,0.2623130707548592,0.07818757864192553,0.1647508386829324,0.3468521296836582,0.3920073269143918,-0.1558493440186455,0.5048992566108635,0.454050293616807,0.4547040764063393,0.2922078871091264],[-0.05989642890479693,0.9426104679920912,0.7340148059344347,0.6401384941911159,1,0.6904338732861147,0.6064586445508489,0.8749236747225885,0.8793055396640098,0.7022551396550516,0.8116787309892599,0.4871038138666136,0.8730181654184004,-0.7783261075952824,-0.4776871554396918,0.0256293801331682,0.77412908087877,0.4973819296084444,0.1241008937355626,0.8654746344095963,0.0247025185460879,0.7688732023242669,0.6634673797848829,0.4054596626763654,0.424271108343947,0.129493118595875,0.2887973618272187,0.4670743614380238,0.6032941030309537,-0.1510079507531602,0.7371706137949452,0.64861185208994,0.7012915250801443,0.5199282458573965],[-0.01127685591825236,0.7290221560785983,0.609327519648026,0.5160670120536285,0.6904338732861147,1,0.5887748780583699,0.6218174162583024,0.7079801814380153,0.4261258890319024,0.5089426054395275,0.1980994351597974,0.70406301572201,-0.4769469947580594,-0.2736753933976411,-0.05230732573487103,0.4751078443509389,0.3970794222350805,0.1784026957907333,0.6057554259810659,-0.01384195929139583,0.4789521058100055,0.4057878895958059,0.2295355578805141,0.2880131024596083,0.0684548145545678,0.1889326408626417,0.2825660828129923,0.4443758442167651,0.007009046202078387,0.5308454773823958,0.4269611465797554,0.5109472677449631,0.4196689115073299],[-0.0463960242158199,0.6849049282337553,0.3467055745409763,0.4872679606123516,0.6064586445508489,0.5887748780583699,1,0.6528309933943813,0.5677526551064915,0.5614889805089581,0.6562670742915713,0.1872326827136999,0.6738888476857725,-0.6129653170316793,-0.3880285414265006,0.1867371909955522,0.5380300216253127,0.4641278765217618,0.02286604425355155,0.646759577446179,-0.1466223473452548,0.6340126571903447,0.5546809673388793,0.1965549313563704,0.4315073582668339,0.2528814956084415,0.2762538123872205,0.4413805224952445,0.5949009313076822,-0.2348670552807049,0.6916938024803984,0.4931919469313338,0.4981635223003294,0.4905783256474746],[-0.06719432463384127,0.9046407248455857,0.6452803908201538,0.6342156698595359,0.8749236747225885,0.6218174162583024,0.6528309933943813,1,0.8295241617374548,0.7062195501168779,0.7925050236248212,0.4258071273280384,0.8232526739791374,-0.7736469623211278,-0.4526006534873595,0.1633259866875137,0.7554215879857329,0.4904369015843238,0.1418634433233645,0.8344198259421924,-0.05541354014348884,0.7345655235194987,0.6857623626342813,0.3559911263844701,0.5013712478583386,0.2892073013300668,0.413542467521793,0.5676435290632064,0.6859378956365141,-0.1730516969073767,0.7751662299446844,0.606564134859031,0.6785110524645286,0.5114125489799959],[-0.09425869987113251,0.9011531403269085,0.6975420564788193,0.5753471501930886,0.8793055396640098,0.7079801814380153,0.5677526551064915,0.8295241617374548,1,0.5631158056130084,0.6869901530033692,0.3822009386358858,0.8413044249249406,-0.6528341229457882,-0.3595714564968964,0.03154122309497741,0.6658606499772899,0.5138277461464653,0.237969848660625,0.7642950100734135,0.04461697914797734,0.6808174862234535,0.5824229067295281,0.3350741556417377,0.3984247361374044,0.1287794115257906,0.2948020501669747,0.4062618386522355,0.5863094112762565,-0.08009507634925075,0.6342108008321667,0.5451640272748567,0.6394778626421076,0.4286493839404159],[0.09946228159606429,0.7284558871046889,0.4670825430437641,0.5751980407050127,0.7022551396550516,0.4261258890319024,0.5614889805089581,0.7062195501168779,0.5631158056130084,1,0.7574073631989868,0.4458860200198175,0.6369430797085472,-0.709027364646735,-0.4535604917349536,0.1576203214351699,0.6560098157639194,0.2723910884067869,-0.2367112679396534,0.7115910350684859,-0.1533302060768726,0.6455424056522781,0.6481865085627301,0.4383875822439757,0.4747337324475425,0.3201589877505061,0.4240530416859288,0.6171615538570792,0.547260685416491,-0.1772888740350118,0.7286620696465649,0.5258835684489231,0.5986631010587995,0.4425331773923533],[0.06333240925002578,0.8349130084747938,0.5240416407452341,0.6166986892308395,0.8116787309892599,0.5089426054395275,0.6562670742915713,0.7925050236248212,0.6869901530033692,0.7574073631989868,1,0.5168252954291441,0.7233829152292407,-0.8366286044801718,-0.5735037289085624,0.1585616683430702,0.7720000944556006,0.443954671118061,0.03259763747462593,0.8870517199457904,0.01136148173130352,0.8913500268424193,0.7657968287265671,0.4184753286188795,0.3972250583943084,0.2007317481044934,0.3181984165531774,0.5422604833738091,0.506365308302099,-0.3209788416463257,0.8292914784587245,0.604230459966912,0.6113374846845504,0.5488461424756401],[-0.09608449682113582,0.5621854875481495,0.3452614592020822,0.2904720476483978,0.4871038138666136,0.1980994351597974,0.1872326827136999,0.4258071273280384,0.3822009386358858,0.4458860200198175,0.5168252954291441,1,0.3360452421856314,-0.5424243301533062,-0.3914523952059368,0.2525478336852702,0.5838092600974353,0.1521487027211392,-0.07317527307661434,0.4454153617869853,0.03415486659722614,0.4894637974212326,0.4681381366653793,0.492102060342311,0.12768292137973,-0.04783343854673387,0.07701493851504812,0.2408503745373891,0.1812034466371841,-0.2860257708690294,0.4359978948667263,0.2912979374321988,0.2928592935154512,0.3099478484368779],[-0.1789998966013333,0.8859624846113858,0.6559565337100317,0.5478676405412457,0.8730181654184004,0.70406301572201,0.6738888476857725,0.8232526739791374,0.8413044249249406,0.6369430797085472,0.7233829152292407,0.3360452421856314,1,-0.7197783548371623,-0.4236498844817568,0.03961698722243543,0.74119796047524,0.5138152699634368,0.1829568009256542,0.809811131885691,-0.003071251889767788,0.6927023576158938,0.6683885007158445,0.3226573707265812,0.4873538446590691,0.221396854477488,0.3317806402456716,0.4850171204210012,0.6270267704147574,-0.1766441673611752,0.7507859342291932,0.5902116398372722,0.6775310528572712,0.5523457776129758],[0.2290575127124033,-0.7665386557602123,-0.5198951587756294,-0.4593160287097233,-0.7783261075952824,-0.4769469947580594,-0.6129653170316793,-0.7736469623211278,-0.6528341229457882,-0.709027364646735,-0.8366286044801718,-0.5424243301533062,-0.7197783548371623,1,0.7175484257530975,-0.2355819087484743,-0.8180533504509013,-0.3750483632620705,-0.04395887305988982,-0.8859217512008096,0.0443134429782607,-0.7363418443171009,-0.8505426060831701,-0.4503807003579013,-0.5048234526631508,-0.3198829520136526,-0.3916862840497434,-0.6476229625724556,-0.5440882540097806,0.3009743099069987,-0.8376268336717266,-0.583096995739824,-0.6832573509845233,-0.5721099662908464],[0.07884333274524699,-0.4170523839578824,-0.2996084916466061,-0.2400089674673597,-0.4776871554396918,-0.2736753933976411,-0.3880285414265006,-0.4526006534873595,-0.3595714564968964,-0.4535604917349536,-0.5735037289085624,-0.3914523952059368,-0.4236498844817568,0.7175484257530975,1,-0.05556369989684449,-0.5269732974526092,-0.2147724535644552,0.07629704496762653,-0.6055600883980702,-0.07891125089529445,-0.4986411355587586,-0.5634086915066608,-0.2917087058443696,-0.2464305612597469,-0.1261265732567539,-0.09663793521566855,-0.3510540653920224,-0.2539673204048197,0.2139650784231244,-0.5570428944590462,-0.3462178549108087,-0.3912650671477377,-0.4193402167212474],[-0.282042508479013,0.1862337283764989,-0.01581039561378414,0.04616010404090864,0.0256293801331682,-0.05230732573487103,0.1867371909955522,0.1633259866875137,0.03154122309497741,0.1576203214351699,0.1585616683430702,0.2525478336852702,0.03961698722243543,-0.2355819087484743,-0.05556369989684449,1,0.2356713915904138,0.110508305559386,0.1614271018132305,0.1611261025763961,-0.04967772779906347,0.2353407757908363,0.2438702003863072,0.1005280100374189,0.2171936340744927,0.2455433715701811,0.2315616464467064,0.2601543331267184,0.1884668917585113,-0.2401432890903011,0.2195600583365697,0.1120206864711707,0.1360060160920526,0.1440631908270179],[-0.2763245769806241,0.8140572739841272,0.5227170378885766,0.520970623992723,0.77412908087877,0.4751078443509389,0.5380300216253127,0.7554215879857329,0.6658606499772899,0.6560098157639194,0.7720000944556006,0.5838092600974353,0.74119796047524,-0.8180533504509013,-0.5269732974526092,0.2356713915904138,1,0.4837902058479926,0.2018536897309056,0.7688950288944979,0.02046735321738524,0.6889962739587921,0.8417944889263679,0.5642448882993453,0.4784721840641359,0.2548111986741206,0.3886067680760439,0.6182638991005632,0.502129440069197,-0.3473145561294548,0.8399438175292124,0.5675605513883702,0.6449383508539788,0.5696269435397506],[-0.1451853089094553,0.5720532923491378,0.4332505988416896,0.2580593162308215,0.4973819296084444,0.3970794222350805,0.4641278765217618,0.4904369015843238,0.5138277461464653,0.2723910884067869,0.443954671118061,0.1521487027211392,0.5138152699634368,-0.3750483632620705,-0.2147724535644552,0.110508305559386,0.4837902058479926,1,0.3628237559122614,0.4565032806106809,0.1754755383738757,0.4419422943942105,0.383284958168397,0.133716589363208,0.3429722395846353,0.1691958952082157,0.2921346176111549,0.3200662892531421,0.385906161362377,-0.2567243403008126,0.4900489281700945,0.3416739091158968,0.3463792343632567,0.3188435880702382],[-0.2967140695424522,0.1697909138416617,0.2341476097636653,0.01200437205761152,0.1241008937355626,0.1784026957907333,0.02286604425355155,0.1418634433233645,0.237969848660625,-0.2367112679396534,0.03259763747462593,-0.07317527307661434,0.1829568009256542,-0.04395887305988982,0.07629704496762653,0.1614271018132305,0.2018536897309056,0.3628237559122614,1,0.1350719033627261,0.2145890684566835,0.05590551504129388,0.18366907056028,0.02636475646154061,0.1318404071216009,0.05498992045759652,0.1596223922005331,0.07738924772395749,0.09844460795238276,-0.1833909169443196,0.106145982101285,0.05387007952508938,0.1285251302266211,0.1262102847888111],[-0.100437629237225,0.8586407684614078,0.6614027459685672,0.5809148544707651,0.8654746344095963,0.6057554259810659,0.646759577446179,0.8344198259421924,0.7642950100734135,0.7115910350684859,0.8870517199457904,0.4454153617869853,0.809811131885691,-0.8859217512008096,-0.6055600883980702,0.1611261025763961,0.7688950288944979,0.4565032806106809,0.1350719033627261,1,0.005319458751612853,0.8393752433888696,0.7857019665679584,0.4070612899384107,0.4896569893635004,0.2717311060729403,0.3757159310860355,0.5858079144318927,0.5423806517442988,-0.2602949638799581,0.8094978506222458,0.6184435778134534,0.6890624436358173,0.5878411386698528],[0.08295556097987868,0.009567746973328463,0.114010443476693,-0.07559429170257102,0.0247025185460879,-0.01384195929139583,-0.1466223473452548,-0.05541354014348884,0.04461697914797734,-0.1533302060768726,0.01136148173130352,0.03415486659722614,-0.003071251889767788,0.0443134429782607,-0.07891125089529445,-0.04967772779906347,0.02046735321738524,0.1754755383738757,0.2145890684566835,0.005319458751612853,1,-0.01484742188933317,-0.02117284461113357,-0.08216229833140191,-0.3074593357057238,-0.288013099806785,-0.3089013554183697,-0.2546446321715795,-0.1726099237037034,-0.1956420610729008,-0.07633947519253312,-0.07684013796554687,-0.09586593126946144,-0.0937301525784565],[-0.0696786504515188,0.8048956923159956,0.5098747598064216,0.5388814080949619,0.7688732023242669,0.4789521058100055,0.6340126571903447,0.7345655235194987,0.6808174862234535,0.6455424056522781,0.8913500268424193,0.4894637974212326,0.6927023576158938,-0.7363418443171009,-0.4986411355587586,0.2353407757908363,0.6889962739587921,0.4419422943942105,0.05590551504129388,0.8393752433888696,-0.01484742188933317,1,0.6542254436061171,0.3921303159406748,0.3552000516664754,0.1660393538040541,0.2640556886090376,0.4292933146067106,0.4685811218726635,-0.2554405837093164,0.7124695571662718,0.5814337884940577,0.5534600229717503,0.5659653012695934],[-0.2908717129168107,0.6989837885951657,0.4321408727585767,0.4271713214296465,0.6634673797848829,0.4057878895958059,0.5546809673388793,0.6857623626342813,0.5824229067295281,0.6481865085627301,0.7657968287265671,0.4681381366653793,0.6683885007158445,-0.8505426060831701,-0.5634086915066608,0.2438702003863072,0.8417944889263679,0.383284958168397,0.18366907056028,0.7857019665679584,-0.02117284461113357,0.6542254436061171,1,0.5000432551108559,0.5940768961359914,0.4297555813255408,0.4874796421814199,0.7102686611929788,0.4984385325404077,-0.3337185349661453,0.8524433580874869,0.5378711736702063,0.6680346667913338,0.6248933415027877],[-0.1501770507193001,0.4461999866857259,0.2741160214770913,0.3601929425557452,0.4054596626763654,0.2295355578805141,0.1965549313563704,0.3559911263844701,0.3350741556417377,0.4383875822439757,0.4184753286188795,0.492102060342311,0.3226573707265812,-0.4503807003579013,-0.2917087058443696,0.1005280100374189,0.5642448882993453,0.133716589363208,0.02636475646154061,0.4070612899384107,-0.08216229833140191,0.3921303159406748,0.5000432551108559,1,0.3327022987177336,0.09101189660729328,0.1938788592895661,0.3570220204560188,0.1779412973877218,-0.2600520913880565,0.4582591215487072,0.2709138080139373,0.3632379203638232,0.2967106582790572],[-0.3056518835207266,0.4558435289022649,0.2843342238810153,0.2623130707548592,0.424271108343947,0.2880131024596083,0.4315073582668339,0.5013712478583386,0.3984247361374044,0.4747337324475425,0.3972250583943084,0.12768292137973,0.4873538446590691,-0.5048234526631508,-0.2464305612597469,0.2171936340744927,0.4784721840641359,0.3429722395846353,0.1318404071216009,0.4896569893635004,-0.3074593357057238,0.3552000516664754,0.5940768961359914,0.3327022987177336,1,0.7141454696264261,0.7511456425625084,0.7678489106004152,0.508369480086179,0.009714119942051591,0.5858822086902336,0.4486521754428955,0.6070532329050254,0.4881347690498771],[-0.361824387519079,0.1719791900894227,0.03105888128514158,0.07818757864192553,0.129493118595875,0.0684548145545678,0.2528814956084415,0.2892073013300668,0.1287794115257906,0.3201589877505061,0.2007317481044934,-0.04783343854673387,0.221396854477488,-0.3198829520136526,-0.1261265732567539,0.2455433715701811,0.2548111986741206,0.1691958952082157,0.05498992045759652,0.2717311060729403,-0.288013099806785,0.1660393538040541,0.4297555813255408,0.09101189660729328,0.7141454696264261,1,0.8394861982489171,0.7223173204776252,0.3705850368467105,0.1338603536602173,0.362080560981983,0.2598103047351399,0.4042819649832729,0.3224557491905152],[-0.2712328915957977,0.3422747694128797,0.2007047882192993,0.1647508386829324,0.2887973618272187,0.1889326408626417,0.2762538123872205,0.413542467521793,0.2948020501669747,0.4240530416859288,0.3181984165531774,0.07701493851504812,0.3317806402456716,-0.3916862840497434,-0.09663793521566855,0.2315616464467064,0.3886067680760439,0.2921346176111549,0.1596223922005331,0.3757159310860355,-0.3089013554183697,0.2640556886090376,0.4874796421814199,0.1938788592895661,0.7511456425625084,0.8394861982489171,1,0.8447013696972256,0.3986222160614151,0.1371472137892977,0.4738896902415543,0.3835285589485846,0.5091574444873022,0.3879215646762463],[-0.1945561406056067,0.510405603238767,0.2983071536157981,0.3468521296836582,0.4670743614380238,0.2825660828129923,0.4413805224952445,0.5676435290632064,0.4062618386522355,0.6171615538570792,0.5422604833738091,0.2408503745373891,0.4850171204210012,-0.6476229625724556,-0.3510540653920224,0.2601543331267184,0.6182638991005632,0.3200662892531421,0.07738924772395749,0.5858079144318927,-0.2546446321715795,0.4292933146067106,0.7102686611929788,0.3570220204560188,0.7678489106004152,0.7223173204776252,0.8447013696972256,1,0.4716430841036102,-0.09039441427454803,0.6898786304685547,0.4841214728723366,0.611966122404383,0.4713512308436184],[-0.1411031620997867,0.6260508976251223,0.3574519364287088,0.3920073269143918,0.6032941030309537,0.4443758442167651,0.5949009313076822,0.6859378956365141,0.5863094112762565,0.547260685416491,0.506365308302099,0.1812034466371841,0.6270267704147574,-0.5440882540097806,-0.2539673204048197,0.1884668917585113,0.502129440069197,0.385906161362377,0.09844460795238276,0.5423806517442988,-0.1726099237037034,0.4685811218726635,0.4984385325404077,0.1779412973877218,0.508369480086179,0.3705850368467105,0.3986222160614151,0.4716430841036102,1,-0.06989688958925648,0.5741174773924569,0.4251719340598243,0.5400144435576471,0.342375117303606],[0.0474767756427897,-0.2129152929390958,-0.011457151030102,-0.1558493440186455,-0.1510079507531602,0.007009046202078387,-0.2348670552807049,-0.1730516969073767,-0.08009507634925075,-0.1772888740350118,-0.3209788416463257,-0.2860257708690294,-0.1766441673611752,0.3009743099069987,0.2139650784231244,-0.2401432890903011,-0.3473145561294548,-0.2567243403008126,-0.1833909169443196,-0.2602949638799581,-0.1956420610729008,-0.2554405837093164,-0.3337185349661453,-0.2600520913880565,0.009714119942051591,0.1338603536602173,0.1371472137892977,-0.09039441427454803,-0.06989688958925648,1,-0.2594218474217456,-0.006807117925018338,-0.006331462976356673,-0.01925961401576486],[-0.1298856705866213,0.7850966468431397,0.4858034968799863,0.5048992566108635,0.7371706137949452,0.5308454773823958,0.6916938024803984,0.7751662299446844,0.6342108008321667,0.7286620696465649,0.8292914784587245,0.4359978948667263,0.7507859342291932,-0.8376268336717266,-0.5570428944590462,0.2195600583365697,0.8399438175292124,0.4900489281700945,0.106145982101285,0.8094978506222458,-0.07633947519253312,0.7124695571662718,0.8524433580874869,0.4582591215487072,0.5858822086902336,0.362080560981983,0.4738896902415543,0.6898786304685547,0.5741174773924569,-0.2594218474217456,1,0.6037186986966041,0.6939919896269564,0.6757878184107962],[-0.1264950703947788,0.6237694703354688,0.4171081134763703,0.454050293616807,0.64861185208994,0.4269611465797554,0.4931919469313338,0.606564134859031,0.5451640272748567,0.5258835684489231,0.604230459966912,0.2912979374321988,0.5902116398372722,-0.583096995739824,-0.3462178549108087,0.1120206864711707,0.5675605513883702,0.3416739091158968,0.05387007952508938,0.6184435778134534,-0.07684013796554687,0.5814337884940577,0.5378711736702063,0.2709138080139373,0.4486521754428955,0.2598103047351399,0.3835285589485846,0.4841214728723366,0.4251719340598243,-0.006807117925018338,0.6037186986966041,1,0.741568188008445,0.5527280111663891],[-0.2492470939089641,0.6855501469960448,0.5087675163904557,0.4547040764063393,0.7012915250801443,0.5109472677449631,0.4981635223003294,0.6785110524645286,0.6394778626421076,0.5986631010587995,0.6113374846845504,0.2928592935154512,0.6775310528572712,-0.6832573509845233,-0.3912650671477377,0.1360060160920526,0.6449383508539788,0.3463792343632567,0.1285251302266211,0.6890624436358173,-0.09586593126946144,0.5534600229717503,0.6680346667913338,0.3632379203638232,0.6070532329050254,0.4042819649832729,0.5091574444873022,0.611966122404383,0.5400144435576471,-0.006331462976356673,0.6939919896269564,0.741568188008445,1,0.628151897030831],[-0.2496235742493084,0.5480256487443572,0.40542812927313,0.2922078871091264,0.5199282458573965,0.4196689115073299,0.4905783256474746,0.5114125489799959,0.4286493839404159,0.4425331773923533,0.5488461424756401,0.3099478484368779,0.5523457776129758,-0.5721099662908464,-0.4193402167212474,0.1440631908270179,0.5696269435397506,0.3188435880702382,0.1262102847888111,0.5878411386698528,-0.0937301525784565,0.5659653012695934,0.6248933415027877,0.2967106582790572,0.4881347690498771,0.3224557491905152,0.3879215646762463,0.4713512308436184,0.342375117303606,-0.01925961401576486,0.6757878184107962,0.5527280111663891,0.628151897030831,1]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>population<\/th>\n      <th>overallscore<\/th>\n      <th>goal1<\/th>\n      <th>goal2<\/th>\n      <th>goal3<\/th>\n      <th>goal4<\/th>\n      <th>goal5<\/th>\n      <th>goal6<\/th>\n      <th>goal7<\/th>\n      <th>goal8<\/th>\n      <th>goal9<\/th>\n      <th>goal10<\/th>\n      <th>goal11<\/th>\n      <th>goal12<\/th>\n      <th>goal13<\/th>\n      <th>goal15<\/th>\n      <th>goal16<\/th>\n      <th>goal17<\/th>\n      <th>unemployment.rate<\/th>\n      <th>GDPpercapita<\/th>\n      <th>MilitaryExpenditurePercentGDP<\/th>\n      <th>internet_usage<\/th>\n      <th>pf_law<\/th>\n      <th>pf_security<\/th>\n      <th>pf_movement<\/th>\n      <th>pf_religion<\/th>\n      <th>pf_assembly<\/th>\n      <th>pf_expression<\/th>\n      <th>pf_identity<\/th>\n      <th>ef_government<\/th>\n      <th>ef_legal<\/th>\n      <th>ef_money<\/th>\n      <th>ef_trade<\/th>\n      <th>ef_regulation<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":10,"class":"hover","searchHighlight":true,"columnDefs":[{"targets":"_all","render":"function(data, type, row, meta){\n  if(type === 'display'){\n    return parseFloat(data).toFixed(2)\n  }\n  return data;\n}"},{"className":"dt-right","targets":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33]}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":["options.columnDefs.0.render"],"jsHooks":[]}</script>
</div>
</div>
<p>By doing so, we obtain a lot of positive and negative correlations. To help us to better understand and having a overall vision of the situation, we used the following heatmap.</p>
<div class="cell" data-layout-align="center" data-hash="eda_cache/html/unnamed-chunk-5_d592e67cab542428beaefcbad3fd4c82">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="do">#### Heatmap ####</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>cor_melted <span class="ot">&lt;-</span> <span class="fu">melt</span>(cor_matrix_sper)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> cor_melted, <span class="fu">aes</span>(Var1, Var2, <span class="at">fill =</span> value)) <span class="sc">+</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient2</span>(<span class="at">low =</span> <span class="st">"blue"</span>, <span class="at">high =</span> <span class="st">"red"</span>, <span class="at">mid =</span> <span class="st">"white"</span>, </span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>                       <span class="at">midpoint =</span> <span class="dv">0</span>, <span class="at">limit =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>), <span class="at">space =</span> <span class="st">"Lab"</span>, </span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>                       <span class="at">name=</span><span class="st">"Spearman</span><span class="sc">\n</span><span class="st">Correlation"</span>) <span class="sc">+</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">8</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>)) <span class="sc">+</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>() <span class="sc">+</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">''</span>, <span class="at">y =</span> <span class="st">''</span>, <span class="at">title =</span> <span class="st">'Correlation Matrix Heatmap'</span>)</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a><span class="co">#do 3 different heatmaps : goals on goals, goals on other variables except goals, variables on variables (except goals)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="eda_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>In the correlation matrix heatmap, we can notice that many goals from 1 to 11 are actually positively correlated together. On another hand, the goals 12 and 13 are have negative relationships with the majority of our variables, except between themself, whereas they are strongely correlated. In addition, we can notice another strongly correlation between personal freedom variables (pf) related to the scores given by the Human Freedom Index on movement, religion, assembly and expression.</p>
<p>In order to have an overview of the relationship between our independent variables and the SDG overall score, we make several graphs containing the Pearson correlation coefficient between the variable, the scatter plots describing the relationship between the variables, as well as the distribution of each variable.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="do">#### Spearman's correlation coeff ####</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>panel.hist <span class="ot">&lt;-</span> <span class="cf">function</span>(x, ...){ </span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  usr <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="st">"usr"</span>); <span class="fu">on.exit</span>(<span class="fu">par</span>(usr)) </span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">usr =</span> <span class="fu">c</span>(usr[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="dv">0</span>, <span class="fl">1.5</span>) ) </span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  h <span class="ot">&lt;-</span> <span class="fu">hist</span>(x, <span class="at">plot =</span> <span class="cn">FALSE</span>) </span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  breaks <span class="ot">&lt;-</span> h<span class="sc">$</span>breaks; nB <span class="ot">&lt;-</span> <span class="fu">length</span>(breaks) </span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> h<span class="sc">$</span>counts; y <span class="ot">&lt;-</span> y<span class="sc">/</span><span class="fu">max</span>(y) </span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rect</span>(breaks[<span class="sc">-</span>nB], <span class="dv">0</span>, breaks[<span class="sc">-</span><span class="dv">1</span>], y, <span class="at">col =</span> <span class="st">"lightgreen"</span>, ...)</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>panel.cor <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, <span class="at">digits =</span> <span class="dv">2</span>, <span class="at">prefix =</span> <span class="st">""</span>, cex.cor, ...){ </span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>  usr <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="st">"usr"</span>); <span class="fu">on.exit</span>(<span class="fu">par</span>(usr)) </span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">usr =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>)) </span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>  r <span class="ot">&lt;-</span> <span class="fu">cor</span>(x, y, <span class="at">method =</span> <span class="st">"spearman"</span>) </span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>  txt <span class="ot">&lt;-</span> <span class="fu">format</span>(<span class="fu">c</span>(r, <span class="fl">0.123456789</span>), <span class="at">digits =</span> digits)[<span class="dv">1</span>] </span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>  txt <span class="ot">&lt;-</span> <span class="fu">paste0</span>(prefix, txt) </span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">missing</span>(cex.cor)) cex.cor <span class="ot">&lt;-</span> <span class="fl">0.8</span><span class="sc">/</span><span class="fu">strwidth</span>(txt) </span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">text</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>, txt, <span class="at">cex =</span> cex.cor <span class="sc">*</span> r)</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a><span class="co"># # Independent variables </span></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a><span class="co"># #with log transformation</span></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a><span class="co"># pairs(Correlation_overall_skew[,c("overallscore", "unemployment.rate", "GDPpercapita", "MilitaryExpenditurePercentGDP", "internet_usage")], upper.panel=panel.cor, diag.panel=panel.hist, main="Correlation table and distribution of various variables")</span></span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a><span class="co"># #with square root transformation</span></span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a><span class="co"># pairs(Correlation_overall_sqrt[,c("overallscore", "unemployment.rate", "GDPpercapita", "MilitaryExpenditurePercentGDP", "internet_usage")], upper.panel=panel.cor, diag.panel=panel.hist, main="Correlation table and distribution of various variables")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The overall SDG achievement score is highly correlated with the percentage of people using the internet (r=.79) and GDP per capita (r=.60). The unemployement rate as well as the military expenditures in percentage of GDP per capita do not seem to play a role. However, this is only for the overall score.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co">#with log transformation</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co"># pairs(Correlation_overall_skew[,c("overallscore", "pf_law", "pf_security", "pf_movement", "pf_religion", "pf_assembly", "pf_expression", "pf_identity")], upper.panel=panel.cor, diag.panel=panel.hist, main="Correlation table and distribution of personal freedom variables")</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co"># #with square root transformation</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co"># pairs(Correlation_overall_sqrt[,c("overallscore", "pf_law", "pf_security", "pf_movement", "pf_religion", "pf_assembly", "pf_expression", "pf_identity")], upper.panel=panel.cor, diag.panel=panel.hist, main="Correlation table and distribution of personal freedom variables")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The overall SDG achievement score is highly correlated with “personal freedom: law” (p=.69) and “personal freedom: identity” (p=.62). The other dimensions of personal freedom do not seem to have important influence. Regarding the distribution of the personal freedom variables, we notice that except for law, all have right-skewed distributions meaning that most of the countries have high scores.</p>
<div class="cell" data-layout-align="center" data-hash="eda_cache/html/unnamed-chunk-8_32c7fabaebc40012f49a9371a64b1d78">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co">#with log transformation</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(Correlation_overall_skew[,<span class="fu">c</span>(<span class="st">"overallscore"</span>, <span class="st">"ef_government"</span>, <span class="st">"ef_legal"</span>, <span class="st">"ef_money"</span>, <span class="st">"ef_trade"</span>, <span class="st">"ef_regulation"</span>)], <span class="at">upper.panel=</span>panel.cor, <span class="at">diag.panel=</span>panel.hist, <span class="at">main=</span><span class="st">"Correlation table and distribution of economic freedom variables"</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co">#with square root transformation</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(Correlation_overall_sqrt[,<span class="fu">c</span>(<span class="st">"overallscore"</span>, <span class="st">"ef_government"</span>, <span class="st">"ef_legal"</span>, <span class="st">"ef_money"</span>, <span class="st">"ef_trade"</span>, <span class="st">"ef_regulation"</span>)], <span class="at">upper.panel=</span>panel.cor, <span class="at">diag.panel=</span>panel.hist, <span class="at">main=</span><span class="st">"Correlation table and distribution of economic freedom variables"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="eda_files/figure-html/unnamed-chunk-8-1.png" style="width:100.0%;height:100.0%" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>The overall SDG achievement score is highly correlated with “economical freedom: legal” (p=.77), “economical trade: legal” (p=.67) and “economical freedom: money” (p=.6), while the other dimensions of economic freedom do not seem to have important influence. Regarding the distribution of the economic freedom variables, we notice more heterogeneous distributions and scores across the various countries than for personal freedom.</p>
<div class="cell" data-layout-align="center" data-hash="eda_cache/html/unnamed-chunk-9_e6116489de944c6006dc71db8b65ade6">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="do">#### PCA ####</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co"># for goals</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>myPCA_g <span class="ot">&lt;-</span> <span class="fu">PCA</span>(data_question1[,<span class="dv">9</span><span class="sc">:</span><span class="dv">24</span>], <span class="at">graph =</span> <span class="cn">FALSE</span>)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(myPCA_g<span class="sc">$</span>ind<span class="sc">$</span>coord[, <span class="dv">1</span>], myPCA_g<span class="sc">$</span>ind<span class="sc">$</span>coord[, <span class="dv">2</span>], <span class="at">xlab =</span> <span class="st">"PC1"</span>, <span class="at">ylab =</span> <span class="st">"PC2"</span>, <span class="at">main =</span> <span class="st">"PCA Plot SDG Goals"</span>, <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">cex =</span> <span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lty =</span> <span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="at">v =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; integer(0)</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.PCA</span>(myPCA_g, <span class="at">choix =</span> <span class="st">"var"</span>, <span class="at">pch =</span> <span class="dv">10</span>, <span class="at">cex =</span> <span class="fl">0.6</span>)</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(myPCA_g)</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; PCA(X = data_question1[, 9:24], graph = FALSE) </span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Eigenvalues</span></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                        Dim.1   Dim.2   Dim.3   Dim.4   Dim.5   Dim.6</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Variance               9.837   1.406   0.963   0.820   0.718   0.513</span></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; % of var.             61.479   8.786   6.020   5.125   4.490   3.205</span></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Cumulative % of var.  61.479  70.265  76.285  81.410  85.899  89.104</span></span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                        Dim.7   Dim.8   Dim.9  Dim.10  Dim.11  Dim.12</span></span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Variance               0.352   0.328   0.264   0.195   0.147   0.134</span></span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; % of var.              2.203   2.050   1.651   1.220   0.921   0.838</span></span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Cumulative % of var.  91.307  93.357  95.009  96.228  97.149  97.987</span></span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                       Dim.13  Dim.14  Dim.15  Dim.16</span></span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Variance               0.111   0.090   0.063   0.059</span></span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; % of var.              0.692   0.559   0.395   0.367</span></span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Cumulative % of var.  98.678  99.238  99.633 100.000</span></span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Individuals (the 10 first)</span></span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;            Dist    Dim.1    ctr   cos2    Dim.2    ctr   cos2  </span></span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1      |  5.028 | -4.565  0.085  0.824 | -0.040  0.000  0.000 |</span></span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2      |  5.013 | -4.514  0.083  0.811 | -0.016  0.000  0.000 |</span></span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3      |  4.909 | -4.618  0.087  0.885 | -0.173  0.001  0.001 |</span></span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4      |  4.838 | -4.531  0.084  0.877 | -0.098  0.000  0.000 |</span></span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5      |  4.793 | -4.497  0.082  0.880 | -0.123  0.000  0.001 |</span></span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6      |  4.733 | -4.472  0.081  0.893 | -0.137  0.001  0.001 |</span></span>
<span id="cb8-39"><a href="#cb8-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7      |  4.673 | -4.252  0.074  0.828 |  0.076  0.000  0.000 |</span></span>
<span id="cb8-40"><a href="#cb8-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 8      |  4.617 | -4.162  0.070  0.813 |  0.118  0.000  0.001 |</span></span>
<span id="cb8-41"><a href="#cb8-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 9      |  4.219 | -3.781  0.058  0.803 | -0.168  0.001  0.002 |</span></span>
<span id="cb8-42"><a href="#cb8-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10     |  4.103 | -3.857  0.061  0.884 | -0.329  0.003  0.006 |</span></span>
<span id="cb8-43"><a href="#cb8-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         Dim.3    ctr   cos2  </span></span>
<span id="cb8-44"><a href="#cb8-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1       0.894  0.033  0.032 |</span></span>
<span id="cb8-45"><a href="#cb8-45" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2       0.970  0.039  0.037 |</span></span>
<span id="cb8-46"><a href="#cb8-46" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3       0.412  0.007  0.007 |</span></span>
<span id="cb8-47"><a href="#cb8-47" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4       0.545  0.012  0.013 |</span></span>
<span id="cb8-48"><a href="#cb8-48" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5       0.469  0.009  0.010 |</span></span>
<span id="cb8-49"><a href="#cb8-49" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6       0.296  0.004  0.004 |</span></span>
<span id="cb8-50"><a href="#cb8-50" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7       0.908  0.034  0.038 |</span></span>
<span id="cb8-51"><a href="#cb8-51" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 8       0.981  0.040  0.045 |</span></span>
<span id="cb8-52"><a href="#cb8-52" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 9       0.967  0.039  0.053 |</span></span>
<span id="cb8-53"><a href="#cb8-53" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10      0.363  0.005  0.008 |</span></span>
<span id="cb8-54"><a href="#cb8-54" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb8-55"><a href="#cb8-55" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Variables (the 10 first)</span></span>
<span id="cb8-56"><a href="#cb8-56" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;           Dim.1    ctr   cos2    Dim.2    ctr   cos2    Dim.3    ctr</span></span>
<span id="cb8-57"><a href="#cb8-57" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; goal1  |  0.860  7.522  0.740 |  0.210  3.127  0.044 | -0.121  1.522</span></span>
<span id="cb8-58"><a href="#cb8-58" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; goal2  |  0.668  4.531  0.446 |  0.141  1.416  0.020 | -0.097  0.983</span></span>
<span id="cb8-59"><a href="#cb8-59" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; goal3  |  0.946  9.093  0.894 |  0.155  1.708  0.024 | -0.103  1.107</span></span>
<span id="cb8-60"><a href="#cb8-60" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; goal4  |  0.859  7.505  0.738 |  0.302  6.478  0.091 |  0.005  0.003</span></span>
<span id="cb8-61"><a href="#cb8-61" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; goal5  |  0.721  5.278  0.519 |  0.064  0.288  0.004 |  0.378 14.807</span></span>
<span id="cb8-62"><a href="#cb8-62" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; goal6  |  0.918  8.569  0.843 |  0.066  0.310  0.004 |  0.046  0.224</span></span>
<span id="cb8-63"><a href="#cb8-63" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; goal7  |  0.867  7.644  0.752 |  0.285  5.787  0.081 |  0.005  0.003</span></span>
<span id="cb8-64"><a href="#cb8-64" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; goal8  |  0.782  6.224  0.612 | -0.170  2.065  0.029 | -0.129  1.723</span></span>
<span id="cb8-65"><a href="#cb8-65" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; goal9  |  0.892  8.092  0.796 | -0.150  1.610  0.023 | -0.047  0.228</span></span>
<span id="cb8-66"><a href="#cb8-66" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; goal10 |  0.542  2.981  0.293 | -0.521 19.303  0.271 | -0.345 12.366</span></span>
<span id="cb8-67"><a href="#cb8-67" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          cos2  </span></span>
<span id="cb8-68"><a href="#cb8-68" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; goal1   0.015 |</span></span>
<span id="cb8-69"><a href="#cb8-69" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; goal2   0.009 |</span></span>
<span id="cb8-70"><a href="#cb8-70" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; goal3   0.011 |</span></span>
<span id="cb8-71"><a href="#cb8-71" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; goal4   0.000 |</span></span>
<span id="cb8-72"><a href="#cb8-72" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; goal5   0.143 |</span></span>
<span id="cb8-73"><a href="#cb8-73" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; goal6   0.002 |</span></span>
<span id="cb8-74"><a href="#cb8-74" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; goal7   0.000 |</span></span>
<span id="cb8-75"><a href="#cb8-75" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; goal8   0.017 |</span></span>
<span id="cb8-76"><a href="#cb8-76" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; goal9   0.002 |</span></span>
<span id="cb8-77"><a href="#cb8-77" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; goal10  0.119 |</span></span>
<span id="cb8-78"><a href="#cb8-78" aria-hidden="true" tabindex="-1"></a>myPCA_g<span class="sc">$</span>eig</span>
<span id="cb8-79"><a href="#cb8-79" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         eigenvalue percentage of variance</span></span>
<span id="cb8-80"><a href="#cb8-80" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; comp 1      9.8366                 61.479</span></span>
<span id="cb8-81"><a href="#cb8-81" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; comp 2      1.4058                  8.786</span></span>
<span id="cb8-82"><a href="#cb8-82" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; comp 3      0.9632                  6.020</span></span>
<span id="cb8-83"><a href="#cb8-83" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; comp 4      0.8199                  5.125</span></span>
<span id="cb8-84"><a href="#cb8-84" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; comp 5      0.7183                  4.490</span></span>
<span id="cb8-85"><a href="#cb8-85" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; comp 6      0.5128                  3.205</span></span>
<span id="cb8-86"><a href="#cb8-86" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; comp 7      0.3525                  2.203</span></span>
<span id="cb8-87"><a href="#cb8-87" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; comp 8      0.3280                  2.050</span></span>
<span id="cb8-88"><a href="#cb8-88" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; comp 9      0.2642                  1.651</span></span>
<span id="cb8-89"><a href="#cb8-89" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; comp 10     0.1951                  1.220</span></span>
<span id="cb8-90"><a href="#cb8-90" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; comp 11     0.1473                  0.921</span></span>
<span id="cb8-91"><a href="#cb8-91" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; comp 12     0.1341                  0.838</span></span>
<span id="cb8-92"><a href="#cb8-92" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; comp 13     0.1106                  0.692</span></span>
<span id="cb8-93"><a href="#cb8-93" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; comp 14     0.0895                  0.559</span></span>
<span id="cb8-94"><a href="#cb8-94" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; comp 15     0.0632                  0.395</span></span>
<span id="cb8-95"><a href="#cb8-95" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; comp 16     0.0587                  0.367</span></span>
<span id="cb8-96"><a href="#cb8-96" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         cumulative percentage of variance</span></span>
<span id="cb8-97"><a href="#cb8-97" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; comp 1                               61.5</span></span>
<span id="cb8-98"><a href="#cb8-98" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; comp 2                               70.3</span></span>
<span id="cb8-99"><a href="#cb8-99" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; comp 3                               76.3</span></span>
<span id="cb8-100"><a href="#cb8-100" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; comp 4                               81.4</span></span>
<span id="cb8-101"><a href="#cb8-101" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; comp 5                               85.9</span></span>
<span id="cb8-102"><a href="#cb8-102" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; comp 6                               89.1</span></span>
<span id="cb8-103"><a href="#cb8-103" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; comp 7                               91.3</span></span>
<span id="cb8-104"><a href="#cb8-104" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; comp 8                               93.4</span></span>
<span id="cb8-105"><a href="#cb8-105" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; comp 9                               95.0</span></span>
<span id="cb8-106"><a href="#cb8-106" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; comp 10                              96.2</span></span>
<span id="cb8-107"><a href="#cb8-107" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; comp 11                              97.1</span></span>
<span id="cb8-108"><a href="#cb8-108" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; comp 12                              98.0</span></span>
<span id="cb8-109"><a href="#cb8-109" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; comp 13                              98.7</span></span>
<span id="cb8-110"><a href="#cb8-110" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; comp 14                              99.2</span></span>
<span id="cb8-111"><a href="#cb8-111" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; comp 15                              99.6</span></span>
<span id="cb8-112"><a href="#cb8-112" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; comp 16                             100.0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="eda_files/figure-html/unnamed-chunk-9-1.png" style="width:100.0%;height:100.0%" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="eda_files/figure-html/unnamed-chunk-9-2.png" style="width:100.0%;height:100.0%" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Concerning the SDG goals, we conclude that most of our variables are going along the 1st component, except the goals 10 and 15 that are rather uncorrelated with the dimension 1. In addition, as seen before, the goals 12 and 13 are negatively correlated to the other goals. With a eigenvalue bigger than 1 for the first two components, we conclude that there are only 2 dimensions to take into account, according to the Kaiser-Guttman’s rule. Nevertheless, they are explaining less than 80% of cumulated variance.</p>
<div class="cell" data-layout-align="center" data-hash="eda_cache/html/unnamed-chunk-10_64dde04dc9595e842ba5f9bb3dd70470">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co">#for HFI scores</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>myPCA_s <span class="ot">&lt;-</span> <span class="fu">PCA</span>(data_question1[,<span class="dv">29</span><span class="sc">:</span><span class="dv">40</span>], <span class="at">graph =</span> <span class="cn">FALSE</span>)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(myPCA_s<span class="sc">$</span>ind<span class="sc">$</span>coord[, <span class="dv">1</span>], myPCA_s<span class="sc">$</span>ind<span class="sc">$</span>coord[, <span class="dv">2</span>], <span class="at">xlab =</span> <span class="st">"PC1"</span>, <span class="at">ylab =</span> <span class="st">"PC2"</span>, <span class="at">main =</span> <span class="st">"PCA Plot HFI Scores"</span>, <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">cex =</span> <span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lty =</span> <span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="at">v =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; integer(0)</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.PCA</span>(myPCA_s, <span class="at">choix =</span> <span class="st">"var"</span>,<span class="at">cex =</span> <span class="fl">0.5</span>)</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(myPCA_s)</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; PCA(X = data_question1[, 29:40], graph = FALSE) </span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Eigenvalues</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                        Dim.1   Dim.2   Dim.3   Dim.4   Dim.5   Dim.6</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Variance               6.477   1.581   1.081   0.710   0.560   0.476</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; % of var.             53.979  13.171   9.010   5.920   4.666   3.966</span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Cumulative % of var.  53.979  67.150  76.160  82.080  86.746  90.713</span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                        Dim.7   Dim.8   Dim.9  Dim.10  Dim.11  Dim.12</span></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Variance               0.305   0.230   0.207   0.181   0.116   0.075</span></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; % of var.              2.545   1.914   1.724   1.512   0.970   0.623</span></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Cumulative % of var.  93.257  95.171  96.895  98.407  99.377 100.000</span></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Individuals (the 10 first)</span></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                   Dist    Dim.1    ctr   cos2    Dim.2    ctr   cos2</span></span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1             |  5.714 | -4.642  0.133  0.660 |  0.939  0.022  0.027</span></span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2             |  4.928 | -4.333  0.116  0.773 |  0.560  0.008  0.013</span></span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3             |  4.964 | -4.238  0.111  0.729 |  1.063  0.029  0.046</span></span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4             |  3.666 | -3.523  0.077  0.924 |  0.149  0.001  0.002</span></span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5             |  3.589 | -3.355  0.070  0.874 |  0.102  0.000  0.001</span></span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6             |  5.952 | -4.479  0.124  0.566 |  0.505  0.006  0.007</span></span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7             |  4.722 | -3.585  0.079  0.576 | -0.592  0.009  0.016</span></span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 8             |  4.660 | -3.610  0.081  0.600 | -0.655  0.011  0.020</span></span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 9             |  4.717 | -3.680  0.084  0.608 | -0.736  0.014  0.024</span></span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10            |  4.105 | -3.623  0.081  0.779 |  0.677  0.012  0.027</span></span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                  Dim.3    ctr   cos2  </span></span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1             |  0.942  0.033  0.027 |</span></span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2             |  0.749  0.021  0.023 |</span></span>
<span id="cb9-39"><a href="#cb9-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3             |  1.081  0.043  0.047 |</span></span>
<span id="cb9-40"><a href="#cb9-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4             |  0.471  0.008  0.017 |</span></span>
<span id="cb9-41"><a href="#cb9-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5             |  0.518  0.010  0.021 |</span></span>
<span id="cb9-42"><a href="#cb9-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6             | -2.619  0.254  0.194 |</span></span>
<span id="cb9-43"><a href="#cb9-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7             | -2.518  0.235  0.284 |</span></span>
<span id="cb9-44"><a href="#cb9-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 8             | -2.430  0.218  0.272 |</span></span>
<span id="cb9-45"><a href="#cb9-45" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 9             | -2.639  0.258  0.313 |</span></span>
<span id="cb9-46"><a href="#cb9-46" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10            | -1.023  0.039  0.062 |</span></span>
<span id="cb9-47"><a href="#cb9-47" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-48"><a href="#cb9-48" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Variables (the 10 first)</span></span>
<span id="cb9-49"><a href="#cb9-49" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                  Dim.1    ctr   cos2    Dim.2    ctr   cos2    Dim.3</span></span>
<span id="cb9-50"><a href="#cb9-50" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; pf_law        |  0.856 11.301  0.732 | -0.311  6.109  0.097 | -0.118</span></span>
<span id="cb9-51"><a href="#cb9-51" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; pf_security   |  0.547  4.627  0.300 | -0.465 13.663  0.216 | -0.203</span></span>
<span id="cb9-52"><a href="#cb9-52" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; pf_movement   |  0.828 10.572  0.685 |  0.291  5.367  0.085 | -0.140</span></span>
<span id="cb9-53"><a href="#cb9-53" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; pf_religion   |  0.705  7.668  0.497 |  0.554 19.445  0.307 | -0.275</span></span>
<span id="cb9-54"><a href="#cb9-54" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; pf_assembly   |  0.820 10.391  0.673 |  0.444 12.492  0.197 | -0.196</span></span>
<span id="cb9-55"><a href="#cb9-55" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; pf_expression |  0.879 11.918  0.772 |  0.214  2.907  0.046 | -0.248</span></span>
<span id="cb9-56"><a href="#cb9-56" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; pf_identity   |  0.645  6.423  0.416 |  0.007  0.003  0.000 |  0.087</span></span>
<span id="cb9-57"><a href="#cb9-57" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ef_government | -0.122  0.228  0.015 |  0.684 29.606  0.468 |  0.573</span></span>
<span id="cb9-58"><a href="#cb9-58" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ef_legal      |  0.862 11.459  0.742 | -0.309  6.060  0.096 |  0.037</span></span>
<span id="cb9-59"><a href="#cb9-59" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ef_money      |  0.692  7.401  0.479 | -0.157  1.559  0.025 |  0.487</span></span>
<span id="cb9-60"><a href="#cb9-60" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                  ctr   cos2  </span></span>
<span id="cb9-61"><a href="#cb9-61" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; pf_law         1.277  0.014 |</span></span>
<span id="cb9-62"><a href="#cb9-62" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; pf_security    3.823  0.041 |</span></span>
<span id="cb9-63"><a href="#cb9-63" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; pf_movement    1.804  0.020 |</span></span>
<span id="cb9-64"><a href="#cb9-64" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; pf_religion    6.988  0.076 |</span></span>
<span id="cb9-65"><a href="#cb9-65" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; pf_assembly    3.561  0.038 |</span></span>
<span id="cb9-66"><a href="#cb9-66" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; pf_expression  5.707  0.062 |</span></span>
<span id="cb9-67"><a href="#cb9-67" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; pf_identity    0.692  0.007 |</span></span>
<span id="cb9-68"><a href="#cb9-68" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ef_government 30.323  0.328 |</span></span>
<span id="cb9-69"><a href="#cb9-69" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ef_legal       0.126  0.001 |</span></span>
<span id="cb9-70"><a href="#cb9-70" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ef_money      21.925  0.237 |</span></span>
<span id="cb9-71"><a href="#cb9-71" aria-hidden="true" tabindex="-1"></a>myPCA_s<span class="sc">$</span>eig</span>
<span id="cb9-72"><a href="#cb9-72" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         eigenvalue percentage of variance</span></span>
<span id="cb9-73"><a href="#cb9-73" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; comp 1      6.4775                 53.979</span></span>
<span id="cb9-74"><a href="#cb9-74" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; comp 2      1.5806                 13.171</span></span>
<span id="cb9-75"><a href="#cb9-75" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; comp 3      1.0812                  9.010</span></span>
<span id="cb9-76"><a href="#cb9-76" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; comp 4      0.7104                  5.920</span></span>
<span id="cb9-77"><a href="#cb9-77" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; comp 5      0.5599                  4.666</span></span>
<span id="cb9-78"><a href="#cb9-78" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; comp 6      0.4760                  3.966</span></span>
<span id="cb9-79"><a href="#cb9-79" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; comp 7      0.3054                  2.545</span></span>
<span id="cb9-80"><a href="#cb9-80" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; comp 8      0.2297                  1.914</span></span>
<span id="cb9-81"><a href="#cb9-81" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; comp 9      0.2068                  1.724</span></span>
<span id="cb9-82"><a href="#cb9-82" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; comp 10     0.1814                  1.512</span></span>
<span id="cb9-83"><a href="#cb9-83" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; comp 11     0.1164                  0.970</span></span>
<span id="cb9-84"><a href="#cb9-84" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; comp 12     0.0748                  0.623</span></span>
<span id="cb9-85"><a href="#cb9-85" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         cumulative percentage of variance</span></span>
<span id="cb9-86"><a href="#cb9-86" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; comp 1                               54.0</span></span>
<span id="cb9-87"><a href="#cb9-87" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; comp 2                               67.2</span></span>
<span id="cb9-88"><a href="#cb9-88" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; comp 3                               76.2</span></span>
<span id="cb9-89"><a href="#cb9-89" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; comp 4                               82.1</span></span>
<span id="cb9-90"><a href="#cb9-90" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; comp 5                               86.7</span></span>
<span id="cb9-91"><a href="#cb9-91" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; comp 6                               90.7</span></span>
<span id="cb9-92"><a href="#cb9-92" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; comp 7                               93.3</span></span>
<span id="cb9-93"><a href="#cb9-93" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; comp 8                               95.2</span></span>
<span id="cb9-94"><a href="#cb9-94" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; comp 9                               96.9</span></span>
<span id="cb9-95"><a href="#cb9-95" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; comp 10                              98.4</span></span>
<span id="cb9-96"><a href="#cb9-96" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; comp 11                              99.4</span></span>
<span id="cb9-97"><a href="#cb9-97" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; comp 12                             100.0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="eda_files/figure-html/unnamed-chunk-10-1.png" style="width:100.0%;height:100.0%" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="eda_files/figure-html/unnamed-chunk-10-2.png" style="width:100.0%;height:100.0%" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Now concerning the Human Freedom Index scores, most of the variables are positively correlated to the dimension 1, slightly less for the PF religion and security, and finaly the EF government variable is uncorrelated to the dimension 1. With a eigenvalue bigger than 1 for the three first components, we conclude that there are 3 dimensions to take into account. Nevertheless, again, they are explaining less than 80% of cumulated variance.</p>
<div class="cell" data-layout-align="center" data-hash="eda_cache/html/unnamed-chunk-11_7e11920c0ebeba6365b65ba6dbfdd5c8">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="do">#### Kmean clustering ####</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>data1_scaled <span class="ot">&lt;-</span> <span class="fu">scale</span>(Correlation_overall)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(data1_scaled) <span class="ot">&lt;-</span> <span class="fu">seq_along</span>(<span class="fu">row.names</span>(data1_scaled))</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_nbclust</span>(data1_scaled, kmeans, <span class="at">method=</span><span class="st">"wss"</span>)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>kmean <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(data1_scaled, <span class="dv">7</span>, <span class="at">nstart =</span> <span class="dv">25</span>)</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(kmean)</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; K-means clustering with 7 clusters of sizes 649, 328, 415, 417, 362, 286, 42</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Cluster means:</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   population overallscore  goal1    goal2   goal3  goal4   goal5</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1    -0.1175     -1.36318 -1.449 -0.81472 -1.3936 -1.385 -0.8789</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2    -0.0541      0.17641  0.544  0.00762  0.2521  0.149 -0.3879</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3    -0.2228      0.90857  0.782  0.66143  0.8405  0.795  0.4841</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4    -0.0441     -0.00632  0.188  0.17283  0.1959  0.371  0.1977</span></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5    -0.0600      1.23573  0.801  0.88135  1.1750  0.849  1.1963</span></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6    -0.2757      0.07437  0.277 -0.56992 -0.1056  0.133 -0.0352</span></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7     7.2721     -0.38531 -0.247  0.56278 -0.0921  0.469 -0.2078</span></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     goal6  goal7   goal8  goal9 goal10 goal11 goal12  goal13  goal15</span></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 -1.2223 -1.384 -0.8171 -0.981 -0.415 -1.345  0.957  0.7707  0.0747</span></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 -0.1950  0.295 -0.3245 -0.115  0.383  0.195  0.279 -0.0591 -0.5520</span></span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3  0.8673  0.800  0.7735  0.695  0.636  0.771 -0.716 -0.4075  0.6050</span></span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4  0.1533  0.275 -0.0246 -0.394 -0.955  0.237  0.380  0.5083 -0.6663</span></span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5  1.3303  0.855  1.4579  1.716  1.020  1.061 -1.788 -1.6815  0.4901</span></span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6 -0.0731  0.183 -0.7134 -0.268 -0.202  0.131  0.150  0.2447  0.1412</span></span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7 -0.6498 -0.172  0.0534  0.128 -0.800 -0.754  0.725  0.3586 -1.3909</span></span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   goal16   goal17 unemployment.rate GDPpercapita</span></span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 -1.013 -0.88702           -0.4506       -0.614</span></span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 -0.101  0.25031           -0.0371       -0.316</span></span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3  0.795 -0.00349            0.2777        0.252</span></span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 -0.517 -0.07079           -0.3422       -0.435</span></span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5  1.524  0.85550           -0.3224        2.003</span></span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6  0.187  0.91913            1.6081       -0.438</span></span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7 -0.684 -1.14336           -0.2663       -0.497</span></span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   MilitaryExpenditurePercentGDP internet_usage pf_law pf_security</span></span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1                        -0.131        -0.9411 -0.832     -0.4806</span></span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2                         0.879        -0.0108 -0.490     -0.0541</span></span>
<span id="cb10-38"><a href="#cb10-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3                         0.108         0.6929  0.802      0.7241</span></span>
<span id="cb10-39"><a href="#cb10-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4                        -0.517        -0.2850 -0.543     -0.7438</span></span>
<span id="cb10-40"><a href="#cb10-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5                        -0.314         1.3701  1.602      0.9262</span></span>
<span id="cb10-41"><a href="#cb10-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6                         0.226        -0.1110  0.141      0.0120</span></span>
<span id="cb10-42"><a href="#cb10-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7                         0.403        -0.4433 -0.626      0.0151</span></span>
<span id="cb10-43"><a href="#cb10-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   pf_movement pf_religion pf_assembly pf_expression pf_identity</span></span>
<span id="cb10-44"><a href="#cb10-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1      -0.605      -0.165      -0.490       -0.5657      -0.932</span></span>
<span id="cb10-45"><a href="#cb10-45" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2      -1.148      -1.736      -1.515       -1.2681      -0.653</span></span>
<span id="cb10-46"><a href="#cb10-46" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3       0.658       0.546       0.703        0.7639       0.750</span></span>
<span id="cb10-47"><a href="#cb10-47" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4       0.316       0.427       0.325        0.0394       0.304</span></span>
<span id="cb10-48"><a href="#cb10-48" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5       0.908       0.748       0.918        1.3118       0.879</span></span>
<span id="cb10-49"><a href="#cb10-49" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6       0.326       0.309       0.397        0.0165       0.197</span></span>
<span id="cb10-50"><a href="#cb10-50" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7      -1.378      -2.071      -1.379       -0.7129       0.156</span></span>
<span id="cb10-51"><a href="#cb10-51" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   ef_government ef_legal ef_money ef_trade ef_regulation</span></span>
<span id="cb10-52"><a href="#cb10-52" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1        0.0485  -0.9672  -0.9082  -1.0115        -0.727</span></span>
<span id="cb10-53"><a href="#cb10-53" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2       -0.1659  -0.4117  -0.2798  -0.4079        -0.274</span></span>
<span id="cb10-54"><a href="#cb10-54" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3       -0.2337   0.6501   0.7269   0.8652         0.362</span></span>
<span id="cb10-55"><a href="#cb10-55" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4        0.9587  -0.3821   0.1523   0.1605        -0.238</span></span>
<span id="cb10-56"><a href="#cb10-56" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5       -0.7281   1.7424   0.9840   1.0330         1.105</span></span>
<span id="cb10-57"><a href="#cb10-57" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6        0.0255   0.0860  -0.0965   0.0753         0.495</span></span>
<span id="cb10-58"><a href="#cb10-58" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7       -0.5607  -0.0729  -0.2994  -0.7427        -0.731</span></span>
<span id="cb10-59"><a href="#cb10-59" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb10-60"><a href="#cb10-60" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Clustering vector:</span></span>
<span id="cb10-61"><a href="#cb10-61" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 6 6 6 6 6 6 6 6 6 6</span></span>
<span id="cb10-62"><a href="#cb10-62" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   [32] 6 6 6 6 6 6 6 6 3 3 6 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2</span></span>
<span id="cb10-63"><a href="#cb10-63" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   [63] 2 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 3 3 4 4 6 6 6 6 6 6 6 6 6</span></span>
<span id="cb10-64"><a href="#cb10-64" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   [94] 2 6 6 6 6 6 6 6 6 6 3 3 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5</span></span>
<span id="cb10-65"><a href="#cb10-65" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [125] 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 2 2 2 2 2 2 2 2</span></span>
<span id="cb10-66"><a href="#cb10-66" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [156] 2 2 2 2 2 2 2 2 2 2 2 2 2 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1</span></span>
<span id="cb10-67"><a href="#cb10-67" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [187] 1 1 1 5 3 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 1 1 1 1 1 1 1</span></span>
<span id="cb10-68"><a href="#cb10-68" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [218] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1</span></span>
<span id="cb10-69"><a href="#cb10-69" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [249] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 2 2 2 6 6 6 6 6 6</span></span>
<span id="cb10-70"><a href="#cb10-70" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [280] 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6</span></span>
<span id="cb10-71"><a href="#cb10-71" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [311] 6 6 6 6 6 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4</span></span>
<span id="cb10-72"><a href="#cb10-72" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [342] 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6</span></span>
<span id="cb10-73"><a href="#cb10-73" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [373] 6 6 6 6 6 6 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 5 5 5 5</span></span>
<span id="cb10-74"><a href="#cb10-74" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [404] 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5</span></span>
<span id="cb10-75"><a href="#cb10-75" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [435] 5 5 5 5 5 5 5 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 7 7 7</span></span>
<span id="cb10-76"><a href="#cb10-76" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [466] 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 1 1 1 1 1 1 1 1 1 1 1 1 1</span></span>
<span id="cb10-77"><a href="#cb10-77" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [497] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1</span></span>
<span id="cb10-78"><a href="#cb10-78" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [528] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 4 4 4 4 4 4 4 4 4 4 4 4</span></span>
<span id="cb10-79"><a href="#cb10-79" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [559] 4 4 4 4 4 4 4 4 4 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3</span></span>
<span id="cb10-80"><a href="#cb10-80" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [590] 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 5 5 3 5 5 5 5 5 5 5 5 5 5 5</span></span>
<span id="cb10-81"><a href="#cb10-81" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [621] 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5</span></span>
<span id="cb10-82"><a href="#cb10-82" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [652] 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 2 2 2 2 2 2 2 2 2 2</span></span>
<span id="cb10-83"><a href="#cb10-83" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [683] 2 2 2 2 2 2 2 2 2 2 2 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4</span></span>
<span id="cb10-84"><a href="#cb10-84" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [714] 4 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 3 3 3 3 3 3 3 3 3</span></span>
<span id="cb10-85"><a href="#cb10-85" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [745] 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 5 5 5 5 5</span></span>
<span id="cb10-86"><a href="#cb10-86" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [776] 5 5 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 5 5 5 5 5 5 5 5</span></span>
<span id="cb10-87"><a href="#cb10-87" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [807] 5 5 5 5 5 5 5 5 5 5 5 5 5 6 6 6 6 6 6 6 2 2 2 2 2 2 2 6 6 6 6</span></span>
<span id="cb10-88"><a href="#cb10-88" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [838] 6 6 6 3 3 3 3 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 1 1 1 1 1 1 1</span></span>
<span id="cb10-89"><a href="#cb10-89" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [869] 1 6 6 6 6 6 6 6 6 6 6 6 6 6 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5</span></span>
<span id="cb10-90"><a href="#cb10-90" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [900] 5 5 5 5 4 4 4 4 6 6 6 6 6 6 6 6 6 6 6 6 6 6 3 3 3 1 1 1 1 1 1</span></span>
<span id="cb10-91"><a href="#cb10-91" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [931] 1 4 4 4 4 4 4 4 4 4 4 4 4 4 4 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3</span></span>
<span id="cb10-92"><a href="#cb10-92" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [962] 3 3 3 3 3 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4</span></span>
<span id="cb10-93"><a href="#cb10-93" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [993] 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3</span></span>
<span id="cb10-94"><a href="#cb10-94" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1024] 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 4 4 4 4</span></span>
<span id="cb10-95"><a href="#cb10-95" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1055] 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 2 7 7 7 7 7 7 7 7 7 7 7 7 7 7</span></span>
<span id="cb10-96"><a href="#cb10-96" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1086] 7 7 7 7 7 7 7 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 2 2 2</span></span>
<span id="cb10-97"><a href="#cb10-97" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1117] 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 3 3 3 3 3 3 3 3 3 3 3 3 3</span></span>
<span id="cb10-98"><a href="#cb10-98" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1148] 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 4 4</span></span>
<span id="cb10-99"><a href="#cb10-99" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1179] 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 2 2 2 2 2 2 2 2 2 2 2 2</span></span>
<span id="cb10-100"><a href="#cb10-100" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1210] 2 2 2 2 2 2 2 2 2 5 3 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 4</span></span>
<span id="cb10-101"><a href="#cb10-101" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1241] 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 1 1 1 1 1 1 1 1 1 1 1</span></span>
<span id="cb10-102"><a href="#cb10-102" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1272] 1 1 1 4 4 1 4 4 4 4 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 4 2 2</span></span>
<span id="cb10-103"><a href="#cb10-103" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1303] 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 2 2 2 4 2 2 2 2 2 2</span></span>
<span id="cb10-104"><a href="#cb10-104" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1334] 2 2 2 2 2 4 4 4 4 4 4 1 1 1 1 1 1 1 1 1 1 1 1 1 6 6 6 6 6 6 6</span></span>
<span id="cb10-105"><a href="#cb10-105" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1365] 6 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 5 5 5 5 5 5 5 5 5</span></span>
<span id="cb10-106"><a href="#cb10-106" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1396] 5 5 5 5 5 5 5 5 5 5 5 5 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3</span></span>
<span id="cb10-107"><a href="#cb10-107" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1427] 3 3 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 4 4 4 4 6 6 6 6</span></span>
<span id="cb10-108"><a href="#cb10-108" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1458] 6 6 6 6 6 6 6 6 3 3 3 3 3 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1</span></span>
<span id="cb10-109"><a href="#cb10-109" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1489] 1 1 1 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 6 6 6 6 6 6 6</span></span>
<span id="cb10-110"><a href="#cb10-110" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1520] 6 6 6 6 6 6 6 6 6 6 6 6 6 6 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1</span></span>
<span id="cb10-111"><a href="#cb10-111" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1551] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 2 2 2 2 2 2 2 6 6 6 6 6 6</span></span>
<span id="cb10-112"><a href="#cb10-112" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1582] 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6</span></span>
<span id="cb10-113"><a href="#cb10-113" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1613] 6 6 6 6 6 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1</span></span>
<span id="cb10-114"><a href="#cb10-114" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1644] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4</span></span>
<span id="cb10-115"><a href="#cb10-115" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1675] 4 4 4 4 4 4 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 2 2 2 2</span></span>
<span id="cb10-116"><a href="#cb10-116" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1706] 2 2 2 2 2 2 2 2 2 2 2 2 2 2 4 4 2 6 6 6 6 6 6 6 6 6 6 6 6 6 6</span></span>
<span id="cb10-117"><a href="#cb10-117" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1737] 6 6 6 6 6 6 6 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1</span></span>
<span id="cb10-118"><a href="#cb10-118" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1768] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 4 4 4 4 4 4 4 4 4 4 4 4 4</span></span>
<span id="cb10-119"><a href="#cb10-119" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1799] 4 4 4 4 4 2 2 2 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5</span></span>
<span id="cb10-120"><a href="#cb10-120" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1830] 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 1 1 1 1 1 1 1 1 1 1 1 1</span></span>
<span id="cb10-121"><a href="#cb10-121" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1861] 1 1 4 4 4 6 6 4 6 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 4</span></span>
<span id="cb10-122"><a href="#cb10-122" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1892] 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4</span></span>
<span id="cb10-123"><a href="#cb10-123" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1923] 4 4 4 4 4 4 4 4 4 4 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1</span></span>
<span id="cb10-124"><a href="#cb10-124" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1954] 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3</span></span>
<span id="cb10-125"><a href="#cb10-125" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1985] 3 3 3 3 3 3 3 3 3 3 3 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4</span></span>
<span id="cb10-126"><a href="#cb10-126" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [2016] 4 4 4 4 4 4 4 4 3 3 3 3 3 3 3 3 3 3 3 3 3 3 2 2 2 2 2 2 2 2 2</span></span>
<span id="cb10-127"><a href="#cb10-127" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [2047] 2 2 2 2 2 2 2 2 2 2 2 2 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 2 2 2 2</span></span>
<span id="cb10-128"><a href="#cb10-128" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [2078] 2 2 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 4 1 1 1 1 1 1 1 1 1</span></span>
<span id="cb10-129"><a href="#cb10-129" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [2109] 1 1 1 1 1 1 1 1 1 1 1 1 1 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4</span></span>
<span id="cb10-130"><a href="#cb10-130" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [2140] 4 4 4 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 3 3 3 3 3 3 3 3 3 3 3</span></span>
<span id="cb10-131"><a href="#cb10-131" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [2171] 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3</span></span>
<span id="cb10-132"><a href="#cb10-132" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [2202] 3 5 5 3 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 1 1 1 1 1 1</span></span>
<span id="cb10-133"><a href="#cb10-133" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [2233] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1</span></span>
<span id="cb10-134"><a href="#cb10-134" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [2264] 1 1 1 1 1 4 4 4 4 4 4 4 4 4 4 4 4 4 4 2 2 2 2 2 4 2 2 2 2 2 2</span></span>
<span id="cb10-135"><a href="#cb10-135" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [2295] 2 2 2 2 2 2 6 6 6 6 6 6 6 6 6 2 2 2 2 2 2 2 2 2 2 6 2 2 2 2 2</span></span>
<span id="cb10-136"><a href="#cb10-136" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [2326] 2 2 2 2 2 2 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1</span></span>
<span id="cb10-137"><a href="#cb10-137" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [2357] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 6 6 6 6 6 3 3 3 3 3 3 3 3 3</span></span>
<span id="cb10-138"><a href="#cb10-138" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [2388] 3 3 3 3 3 3 3 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 2 2 2</span></span>
<span id="cb10-139"><a href="#cb10-139" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [2419] 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 6 6 6 6 6 6 6 6 6 6 6 6 6</span></span>
<span id="cb10-140"><a href="#cb10-140" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [2450] 6 6 6 6 6 6 6 6 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1</span></span>
<span id="cb10-141"><a href="#cb10-141" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [2481] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1</span></span>
<span id="cb10-142"><a href="#cb10-142" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb10-143"><a href="#cb10-143" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Within cluster sum of squares by cluster:</span></span>
<span id="cb10-144"><a href="#cb10-144" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 10371  5910  4023  4976  2844  4594   750</span></span>
<span id="cb10-145"><a href="#cb10-145" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  (between_SS / total_SS =  60.6 %)</span></span>
<span id="cb10-146"><a href="#cb10-146" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb10-147"><a href="#cb10-147" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Available components:</span></span>
<span id="cb10-148"><a href="#cb10-148" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb10-149"><a href="#cb10-149" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] "cluster"      "centers"      "totss"        "withinss"    </span></span>
<span id="cb10-150"><a href="#cb10-150" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [5] "tot.withinss" "betweenss"    "size"         "iter"        </span></span>
<span id="cb10-151"><a href="#cb10-151" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [9] "ifault"</span></span>
<span id="cb10-152"><a href="#cb10-152" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_cluster</span>(kmean, <span class="at">data=</span>data1_scaled, <span class="at">repel=</span><span class="cn">FALSE</span>, <span class="at">depth =</span><span class="cn">NULL</span>, <span class="at">ellipse.type =</span> <span class="st">"norm"</span>, <span class="at">labelsize =</span> <span class="dv">0</span>, <span class="at">pointsize =</span> <span class="fl">0.5</span>)</span>
<span id="cb10-153"><a href="#cb10-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-154"><a href="#cb10-154" aria-hidden="true" tabindex="-1"></a><span class="do">### NOW CLUSTERING BY COUNTRY? AND TAKE MEAN OF EVERY VARIABLE ON EVERY CONCERNED YEAR?</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="eda_files/figure-html/unnamed-chunk-11-1.png" style="width:100.0%;height:100.0%" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="eda_files/figure-html/unnamed-chunk-11-2.png" style="width:100.0%;height:100.0%" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Due to the large number of data, the visualization of the clusters using the kmean method is not really relevant. In addition, by clustering our data, we are trying to get group that differ from eachother but with little variation of the observations within the same cluster. Here, only 60.6% of the variance is explained by the variation between clusters. This is not enough.</p>
</section>
<section id="focus-on-the-influence-of-events-over-the-sdg-scores" class="level2">
<h2 class="anchored" data-anchor-id="focus-on-the-influence-of-events-over-the-sdg-scores">Focus on the influence of events over the SDG scores</h2>
<p>In order to have an overview of the relationship between the different events variables and the SDG overall score, we make several graphs containing the Pearson correlation coefficient between the variable, the scatter plots describing the relationship between the variables, as well as the distribution of each variable.</p>
<div class="cell" data-layout-align="center" data-hash="eda_cache/html/unnamed-chunk-12_fc215ee28bbf48616ceff8df6251f8b6">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>lower.panel <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, ...){</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(x, y, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">col =</span> <span class="st">"black"</span>, <span class="at">cex =</span> <span class="fl">0.2</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>evaluateCorrelationStars <span class="ot">&lt;-</span> <span class="cf">function</span>(correlation) {</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">abs</span>(correlation) <span class="sc">&gt;=</span> <span class="fl">0.7</span>) {</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="st">"*****"</span>)  <span class="co"># Strong correlation: 5 stars</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (<span class="fu">abs</span>(correlation) <span class="sc">&gt;=</span> <span class="fl">0.5</span>) {</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="st">"****"</span>)   <span class="co"># Moderate correlation: 4 stars</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (<span class="fu">abs</span>(correlation) <span class="sc">&gt;=</span> <span class="fl">0.3</span>) {</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="st">"***"</span>)    <span class="co"># Fair correlation: 3 stars</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (<span class="fu">abs</span>(correlation) <span class="sc">&gt;=</span> <span class="fl">0.1</span>) {</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="st">"**"</span>)     <span class="co"># Weak correlation: 2 stars</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="st">"*"</span>)      <span class="co"># Very weak correlation: 1 star</span></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a><span class="co"># panel.cor function with stars alongside correlation coefficients</span></span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>panel.cor_stars <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, <span class="at">digits =</span> <span class="dv">2</span>, <span class="at">prefix =</span> <span class="st">""</span>, cex.cor, ...) {</span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>  usr <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="st">"usr"</span>); <span class="fu">on.exit</span>(<span class="fu">par</span>(usr)) </span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">usr =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>)) </span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>  r <span class="ot">&lt;-</span> <span class="fu">cor</span>(x, y)</span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>  stars <span class="ot">&lt;-</span> <span class="fu">evaluateCorrelationStars</span>(r)</span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>  txt <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="fu">format</span>(<span class="fu">c</span>(r, <span class="fl">0.123456789</span>), <span class="at">digits =</span> digits)[<span class="dv">1</span>], <span class="st">" "</span>, stars)</span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">missing</span>(cex.cor)) cex.cor <span class="ot">&lt;-</span> <span class="fl">0.5</span><span class="sc">/</span><span class="fu">strwidth</span>(txt)</span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">text</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>, txt, <span class="at">cex =</span> cex.cor)</span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(data_question3_1[, <span class="fu">c</span>(<span class="st">"overallscore"</span>, <span class="st">"total_affected"</span>, <span class="st">"total_deaths"</span>)], <span class="at">upper.panel =</span> panel.cor_stars,<span class="at">diag.panel =</span> panel.hist,<span class="at">lower.panel =</span> lower.panel, <span class="at">main =</span> <span class="st">"Correlation table and distribution of Disaster variables"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="eda_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>The different variables used to materialize the impact of climate disasters do not seem to have important influence on the overall score, but we will further explore for the different SDGs, since we believe that such disasters have a specific influence on some SDGs.</p>
<div class="cell" data-layout-align="center" data-hash="eda_cache/html/unnamed-chunk-13_6c996b4eadef27a8153fd26bd27b4766">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>lower.panel <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, ...){</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(x, y, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">col =</span> <span class="st">"black"</span>, <span class="at">cex =</span> <span class="fl">0.2</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>evaluateCorrelationStars <span class="ot">&lt;-</span> <span class="cf">function</span>(correlation) {</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">abs</span>(correlation) <span class="sc">&gt;=</span> <span class="fl">0.7</span>) {</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="st">"*****"</span>)  </span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (<span class="fu">abs</span>(correlation) <span class="sc">&gt;=</span> <span class="fl">0.5</span>) {</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="st">"****"</span>)</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (<span class="fu">abs</span>(correlation) <span class="sc">&gt;=</span> <span class="fl">0.3</span>) {</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="st">"***"</span>) </span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (<span class="fu">abs</span>(correlation) <span class="sc">&gt;=</span> <span class="fl">0.1</span>) {</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="st">"**"</span>)</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="st">"*"</span>)</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a><span class="co"># panel.cor function with stars alongside correlation coefficients</span></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>panel.cor_stars <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, <span class="at">digits =</span> <span class="dv">2</span>, <span class="at">prefix =</span> <span class="st">""</span>, cex.cor, ...) {</span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>  usr <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="st">"usr"</span>); <span class="fu">on.exit</span>(<span class="fu">par</span>(usr)) </span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">usr =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>)) </span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>  r <span class="ot">&lt;-</span> <span class="fu">cor</span>(x, y)</span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>  stars <span class="ot">&lt;-</span> <span class="fu">evaluateCorrelationStars</span>(r)</span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>  txt <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="fu">format</span>(<span class="fu">c</span>(r, <span class="fl">0.123456789</span>), <span class="at">digits =</span> digits)[<span class="dv">1</span>], <span class="st">" "</span>, stars)</span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">missing</span>(cex.cor)) cex.cor <span class="ot">&lt;-</span> <span class="fl">0.8</span><span class="sc">/</span><span class="fu">strwidth</span>(txt)</span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">text</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>, txt, <span class="at">cex =</span> cex.cor)</span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(data_question3_2[,<span class="fu">c</span>(<span class="st">"overallscore"</span>, <span class="st">"cases_per_million"</span>, <span class="st">"deaths_per_million"</span>, <span class="st">"stringency"</span>)], <span class="at">upper.panel =</span> panel.cor_stars, <span class="at">diag.panel=</span>panel.hist, <span class="at">lower.panel =</span> lower.panel,<span class="at">main=</span><span class="st">"Correlation table and distribution of COVID variables"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="eda_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>The different variables used to materialize the impact of COVID19 do not seem to have important influence on the overall score, but we will further explore for the different SDGs, since we believe that COVID19 had a specific influence on some SDGs, for instance “good health and well-being” or “decent work and economic growth”.</p>
<div class="cell" data-layout-align="center" data-hash="eda_cache/html/unnamed-chunk-14_9d8ca4ec0482cda4a1f19e849b661a43">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>lower.panel <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, ...){</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(x, y, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">col =</span> <span class="st">"black"</span>, <span class="at">cex =</span> <span class="fl">0.5</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>evaluateCorrelationStars <span class="ot">&lt;-</span> <span class="cf">function</span>(correlation) {</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">abs</span>(correlation) <span class="sc">&gt;=</span> <span class="fl">0.7</span>) {</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="st">"*****"</span>) </span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (<span class="fu">abs</span>(correlation) <span class="sc">&gt;=</span> <span class="fl">0.5</span>) {</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="st">"****"</span>)</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (<span class="fu">abs</span>(correlation) <span class="sc">&gt;=</span> <span class="fl">0.3</span>) {</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="st">"***"</span>) </span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (<span class="fu">abs</span>(correlation) <span class="sc">&gt;=</span> <span class="fl">0.1</span>) {</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="st">"**"</span>)</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="st">"*"</span>)</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a><span class="co"># panel.cor function with stars alongside correlation coefficients</span></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>panel.cor_stars <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, <span class="at">digits =</span> <span class="dv">2</span>, <span class="at">prefix =</span> <span class="st">""</span>, cex.cor, ...) {</span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>  usr <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="st">"usr"</span>); <span class="fu">on.exit</span>(<span class="fu">par</span>(usr)) </span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">usr =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>)) </span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>  r <span class="ot">&lt;-</span> <span class="fu">cor</span>(x, y)</span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>  stars <span class="ot">&lt;-</span> <span class="fu">evaluateCorrelationStars</span>(r)</span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>  txt <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="fu">format</span>(<span class="fu">c</span>(r, <span class="fl">0.123456789</span>), <span class="at">digits =</span> digits)[<span class="dv">1</span>], <span class="st">" "</span>, stars)</span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">missing</span>(cex.cor)) cex.cor <span class="ot">&lt;-</span> <span class="fl">0.8</span><span class="sc">/</span><span class="fu">strwidth</span>(txt)</span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">text</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>, txt, <span class="at">cex =</span> cex.cor)</span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(data_question3_3[,<span class="fu">c</span>(<span class="st">"overallscore"</span>, <span class="st">"ongoing"</span>, <span class="st">"sum_deaths"</span>, <span class="st">"pop_affected"</span>, <span class="st">"area_affected"</span>, <span class="st">"maxintensity"</span>)], <span class="at">upper.panel =</span> panel.cor_stars, <span class="at">diag.panel=</span>panel.hist, <span class="at">lower.panel =</span> lower.panel, <span class="at">main=</span><span class="st">"Correlation table and distribution of conflicts variables"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="eda_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>The different variables used to materialize the impact of conflicts do not seem to have important influence on the overall score, but we will further explore for the different SDGs, since we believe that conflicts have a specific influence on some SDGs.</p>
<p>To explore our data on events such as disasters, covid-19 and conflicts we have to first see which countries are the most touched by these. To do so, we made time-series analysis on this three events each time depending on different variables.</p>
<div class="cell" data-layout-align="center" data-hash="eda_cache/html/unnamed-chunk-15_edf8e38e20014d79e95924703219522d">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Converted 'year' column to date format</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>Q3<span class="fl">.1</span><span class="sc">$</span>year <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="fu">as.character</span>(Q3<span class="fl">.1</span><span class="sc">$</span>year), <span class="at">format =</span> <span class="st">"%Y"</span>)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>Q3<span class="fl">.2</span><span class="sc">$</span>year <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="fu">as.character</span>(Q3<span class="fl">.2</span><span class="sc">$</span>year), <span class="at">format =</span> <span class="st">"%Y"</span>)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>Q3<span class="fl">.3</span><span class="sc">$</span>year <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="fu">as.character</span>(Q3<span class="fl">.3</span><span class="sc">$</span>year), <span class="at">format =</span> <span class="st">"%Y"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>These is our time-analysis concerning the COVID-19 cases per million by region between end 2018 and 2022.</p>
<div class="cell" data-layout-align="center" data-hash="eda_cache/html/unnamed-chunk-16_509fd9138bcb03693949510476572821">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>covid_filtered <span class="ot">&lt;-</span> Q3<span class="fl">.2</span>[Q3<span class="fl">.2</span><span class="sc">$</span>year <span class="sc">&gt;=</span> <span class="fu">as.Date</span>(<span class="st">"2018-12-12"</span>), ]</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> covid_filtered, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> cases_per_million, <span class="at">group =</span> region, <span class="at">color =</span> region)) <span class="sc">+</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"loess"</span>,  <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">span =</span> <span class="fl">0.8</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Trend of COVID-19 Cases per Million Over Time"</span>,</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Year"</span>, <span class="at">y =</span> <span class="st">"Cases per Million"</span>) <span class="sc">+</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> region, <span class="at">ncol =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>( <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">size =</span> <span class="dv">8</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">8</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">b =</span> <span class="dv">20</span>), <span class="at">hjust =</span> <span class="fl">0.5</span>, </span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">vjust =</span> <span class="dv">8</span>, <span class="at">lineheight =</span> <span class="dv">2</span>),</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">strip.text =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">panel.spacing =</span> <span class="fu">unit</span>(<span class="fl">0.5</span>, <span class="st">"lines"</span>)</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="sc">+</span></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="eda_files/figure-html/unnamed-chunk-16-1.png" style="width:100.0%;height:100.0%" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>These is our time-analysis concerning the COVID-19 deaths per million per region between end 2018 and 2022</p>
<div class="cell" data-layout-align="center" data-hash="eda_cache/html/unnamed-chunk-17_23aa6cc99adfab112cf7b67d99209f16">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> covid_filtered, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> deaths_per_million, <span class="at">group =</span> region, <span class="at">color =</span> region)) <span class="sc">+</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"loess"</span>,  <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">span =</span> <span class="fl">0.8</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Trend of COVID-19 Deaths per Million Over Time"</span>, <span class="at">x =</span> <span class="st">"Year"</span>, <span class="at">y =</span> <span class="st">"Deaths per Million"</span>) <span class="sc">+</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> region, <span class="at">nrow =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>( <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">size =</span> <span class="dv">8</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">8</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">b =</span> <span class="dv">20</span>), <span class="at">hjust =</span> <span class="fl">0.5</span>, </span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">vjust =</span> <span class="dv">8</span>, <span class="at">lineheight =</span> <span class="dv">2</span>),</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">strip.text =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">panel.spacing =</span> <span class="fu">unit</span>(<span class="fl">0.5</span>, <span class="st">"lines"</span>)</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="sc">+</span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">nlin =</span> <span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="eda_files/figure-html/unnamed-chunk-17-1.png" style="width:100.0%;height:100.0%" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>These is our time-analysis concerning the COVID-19 stringency per region between end 2018 and 2022</p>
<div class="cell" data-layout-align="center" data-hash="eda_cache/html/unnamed-chunk-18_4f963b31416bc23f6255e05bdc7ec4b2">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> covid_filtered, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> stringency, <span class="at">group =</span> region, </span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">color =</span> region)) <span class="sc">+</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"loess"</span>,  <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">span =</span> <span class="fl">0.7</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Trend of COVID-19 Stringency Over Time"</span>, <span class="at">x =</span> <span class="st">"Year"</span>, <span class="at">y =</span> <span class="st">"Stringency"</span>) <span class="sc">+</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> region, <span class="at">nrow =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>( <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">size =</span> <span class="dv">8</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">8</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">b =</span> <span class="dv">20</span>), <span class="at">hjust =</span> <span class="fl">0.5</span>, </span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">vjust =</span> <span class="dv">8</span>, <span class="at">lineheight =</span> <span class="dv">2</span>),</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">strip.text =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">panel.spacing =</span> <span class="fu">unit</span>(<span class="fl">0.5</span>, <span class="st">"lines"</span>)</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"right"</span>) <span class="sc">+</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">ncol =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="eda_files/figure-html/unnamed-chunk-18-1.png" style="width:100.0%;height:100.0%" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>These is our time-analysis concerning climatic disasters with total affected per region</p>
<div class="cell" data-layout-align="center" data-hash="eda_cache/html/unnamed-chunk-19_e29f3f6a257fe6007cf3c418cd90b99b">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>Q3<span class="fl">.1</span>[<span class="fu">is.na</span>(Q3<span class="fl">.1</span>)] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> Q3<span class="fl">.1</span>, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> total_affected, <span class="at">group =</span> region, <span class="at">color =</span> region)) <span class="sc">+</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"loess"</span>,  <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">span =</span> <span class="fl">0.7</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Trend of Total Affected from Climatic Disasters Over Time"</span>, <span class="at">x =</span> <span class="st">"Year"</span>, <span class="at">y =</span> <span class="st">"Total Affected"</span>) <span class="sc">+</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> region, <span class="at">nrow =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>( <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">size =</span> <span class="dv">8</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">8</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">b =</span> <span class="dv">20</span>), <span class="at">hjust =</span> <span class="fl">0.5</span>, </span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">vjust =</span> <span class="dv">8</span>, <span class="at">lineheight =</span> <span class="dv">2</span>),</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">strip.text =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">panel.spacing =</span> <span class="fu">unit</span>(<span class="fl">0.5</span>, <span class="st">"lines"</span>)</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"right"</span>) <span class="sc">+</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">ncol =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="eda_files/figure-html/unnamed-chunk-19-1.png" style="width:100.0%;height:100.0%" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>These is our time-analysis concerning conflicts deaths per region between 2000 and 2016</p>
<div class="cell" data-layout-align="center" data-hash="eda_cache/html/unnamed-chunk-20_fbf02c23f6684f2a7fc7527608e2532a">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>conflicts_filtered <span class="ot">&lt;-</span> Q3<span class="fl">.3</span>[Q3<span class="fl">.3</span><span class="sc">$</span>year <span class="sc">&gt;=</span> <span class="fu">as.Date</span>(<span class="st">"2000-01-01"</span>) <span class="sc">&amp;</span> Q3<span class="fl">.3</span><span class="sc">$</span>year <span class="sc">&lt;=</span> <span class="fu">as.Date</span>(<span class="st">"2016-12-31"</span>), ]</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> conflicts_filtered, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> sum_deaths, <span class="at">group =</span> region, <span class="at">color =</span> region)) <span class="sc">+</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"loess"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">span =</span> <span class="fl">0.3</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span>  <span class="co"># Using loess smoothing method</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Trend of Deaths by Conflicts Over Time"</span>, <span class="at">x =</span> <span class="st">"Year"</span>, <span class="at">y =</span> <span class="st">"Sum Deaths"</span>) <span class="sc">+</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> region, <span class="at">nrow =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>( <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">size =</span> <span class="dv">8</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">8</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">b =</span> <span class="dv">20</span>), <span class="at">hjust =</span> <span class="fl">0.5</span>, </span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">vjust =</span> <span class="dv">8</span>, <span class="at">lineheight =</span> <span class="dv">2</span>),</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">strip.text =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">panel.spacing =</span> <span class="fu">unit</span>(<span class="fl">0.5</span>, <span class="st">"lines"</span>)</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"right"</span>) <span class="sc">+</span></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">ncol =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="eda_files/figure-html/unnamed-chunk-20-1.png" style="width:100.0%;height:100.0%" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>We can see that the regions’ the most affected by the conflicts are : Middle east and north Africa, Sub-Saharan Africa, South Asia, then less America &amp; the Caribbean and Eastern Europe</p>
<p>These is our time-analysis concerning conflicts affected population per region between 2000 and 2016</p>
<div class="cell" data-layout-align="center" data-hash="eda_cache/html/unnamed-chunk-21_0ae9e7af966677a7fab9472a9c38e818">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> conflicts_filtered, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> pop_affected, <span class="at">group =</span> region, <span class="at">color =</span> region)) <span class="sc">+</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"loess"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">span =</span> <span class="fl">0.3</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span>  <span class="co"># Using loess smoothing method</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Trend of Population Affected by Conflicts Over Time"</span>, <span class="at">x =</span> <span class="st">"Year"</span>, <span class="at">y =</span> <span class="st">"pop_affected"</span>) <span class="sc">+</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> region, <span class="at">nrow =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>( <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">size =</span> <span class="dv">8</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">8</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">b =</span> <span class="dv">20</span>), <span class="at">hjust =</span> <span class="fl">0.5</span>, </span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">vjust =</span> <span class="dv">8</span>, <span class="at">lineheight =</span> <span class="dv">2</span>),</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">strip.text =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">panel.spacing =</span> <span class="fu">unit</span>(<span class="fl">0.5</span>, <span class="st">"lines"</span>)</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"right"</span>) <span class="sc">+</span></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">ncol =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="eda_files/figure-html/unnamed-chunk-21-1.png" style="width:100.0%;height:100.0%" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>We can see that the regions’ the most affected by the conflicts are : Middle east and north Africa, Sub-Saharan Africa, South Asia, America &amp; the Caribbean, Eastern Europe and sometimes Caucasus and Central Asia</p>
<p>Now that we could visualize which regions are the most impacted by these three events we can do correlations analysis per region to see if this events have indeed an impact on the evolution of SDG goals.</p>
<p>Here we want to analyse the correlation between the climate disasters and the SDG goals in South and East Asia.</p>
<div class="cell" data-layout-align="center" data-hash="eda_cache/html/unnamed-chunk-22_698e8b81ad9f40c8aa5f550c7ecc0f79">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>Q3<span class="fl">.1</span>[<span class="fu">is.na</span>(Q3<span class="fl">.1</span>)] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>south_east_asia_data <span class="ot">&lt;-</span> Q3<span class="fl">.1</span>[Q3<span class="fl">.1</span><span class="sc">$</span>region <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"South Asia"</span>, <span class="st">"East Asia"</span>), ]</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>relevant_columns <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"goal1"</span>, <span class="st">"goal2"</span>, <span class="st">"goal3"</span>, <span class="st">"goal4"</span>, <span class="st">"goal5"</span>, <span class="st">"goal6"</span>, <span class="st">"goal7"</span>, <span class="st">"goal8"</span>, <span class="st">"goal9"</span>, <span class="st">"goal10"</span>, <span class="st">"goal11"</span>, <span class="st">"goal12"</span>, <span class="st">"goal13"</span>, <span class="st">"goal15"</span>, <span class="st">"goal16"</span>, <span class="st">"total_affected"</span>, <span class="st">"no_homeless"</span>)</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>correlation_matrix_disaster_Asia <span class="ot">&lt;-</span> <span class="fu">cor</span>(south_east_asia_data[, relevant_columns], <span class="at">use =</span> <span class="st">"complete.obs"</span>)</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(correlation_matrix_disaster_Asia)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">goal1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">goal2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">goal3</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">goal4</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">goal5</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">goal6</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">goal7</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">goal8</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">goal9</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">goal10</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">goal11</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">goal12</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">goal13</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">goal15</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">goal16</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">total_affected</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">no_homeless</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">goal1</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">-0.026</td>
<td style="text-align: right;">0.322</td>
<td style="text-align: right;">0.394</td>
<td style="text-align: right;">0.186</td>
<td style="text-align: right;">0.358</td>
<td style="text-align: right;">0.402</td>
<td style="text-align: right;">0.537</td>
<td style="text-align: right;">0.203</td>
<td style="text-align: right;">0.577</td>
<td style="text-align: right;">0.170</td>
<td style="text-align: right;">-0.035</td>
<td style="text-align: right;">-0.073</td>
<td style="text-align: right;">0.450</td>
<td style="text-align: right;">0.125</td>
<td style="text-align: right;">-0.040</td>
<td style="text-align: right;">-0.050</td>
</tr>
<tr class="even">
<td style="text-align: left;">goal2</td>
<td style="text-align: right;">-0.026</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.647</td>
<td style="text-align: right;">0.505</td>
<td style="text-align: right;">0.573</td>
<td style="text-align: right;">0.547</td>
<td style="text-align: right;">0.512</td>
<td style="text-align: right;">0.548</td>
<td style="text-align: right;">0.679</td>
<td style="text-align: right;">-0.205</td>
<td style="text-align: right;">0.520</td>
<td style="text-align: right;">-0.302</td>
<td style="text-align: right;">-0.321</td>
<td style="text-align: right;">-0.280</td>
<td style="text-align: right;">0.474</td>
<td style="text-align: right;">0.099</td>
<td style="text-align: right;">-0.076</td>
</tr>
<tr class="odd">
<td style="text-align: left;">goal3</td>
<td style="text-align: right;">0.322</td>
<td style="text-align: right;">0.647</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.789</td>
<td style="text-align: right;">0.588</td>
<td style="text-align: right;">0.703</td>
<td style="text-align: right;">0.826</td>
<td style="text-align: right;">0.806</td>
<td style="text-align: right;">0.864</td>
<td style="text-align: right;">-0.170</td>
<td style="text-align: right;">0.804</td>
<td style="text-align: right;">-0.747</td>
<td style="text-align: right;">-0.725</td>
<td style="text-align: right;">-0.212</td>
<td style="text-align: right;">0.719</td>
<td style="text-align: right;">-0.017</td>
<td style="text-align: right;">-0.105</td>
</tr>
<tr class="even">
<td style="text-align: left;">goal4</td>
<td style="text-align: right;">0.394</td>
<td style="text-align: right;">0.505</td>
<td style="text-align: right;">0.789</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.605</td>
<td style="text-align: right;">0.497</td>
<td style="text-align: right;">0.630</td>
<td style="text-align: right;">0.610</td>
<td style="text-align: right;">0.656</td>
<td style="text-align: right;">-0.080</td>
<td style="text-align: right;">0.455</td>
<td style="text-align: right;">-0.580</td>
<td style="text-align: right;">-0.604</td>
<td style="text-align: right;">-0.103</td>
<td style="text-align: right;">0.373</td>
<td style="text-align: right;">0.093</td>
<td style="text-align: right;">-0.014</td>
</tr>
<tr class="odd">
<td style="text-align: left;">goal5</td>
<td style="text-align: right;">0.186</td>
<td style="text-align: right;">0.573</td>
<td style="text-align: right;">0.588</td>
<td style="text-align: right;">0.605</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.563</td>
<td style="text-align: right;">0.451</td>
<td style="text-align: right;">0.453</td>
<td style="text-align: right;">0.427</td>
<td style="text-align: right;">-0.100</td>
<td style="text-align: right;">0.529</td>
<td style="text-align: right;">-0.404</td>
<td style="text-align: right;">-0.450</td>
<td style="text-align: right;">-0.205</td>
<td style="text-align: right;">0.347</td>
<td style="text-align: right;">0.055</td>
<td style="text-align: right;">-0.152</td>
</tr>
<tr class="even">
<td style="text-align: left;">goal6</td>
<td style="text-align: right;">0.358</td>
<td style="text-align: right;">0.547</td>
<td style="text-align: right;">0.703</td>
<td style="text-align: right;">0.497</td>
<td style="text-align: right;">0.563</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.667</td>
<td style="text-align: right;">0.625</td>
<td style="text-align: right;">0.693</td>
<td style="text-align: right;">-0.006</td>
<td style="text-align: right;">0.655</td>
<td style="text-align: right;">-0.578</td>
<td style="text-align: right;">-0.542</td>
<td style="text-align: right;">-0.135</td>
<td style="text-align: right;">0.582</td>
<td style="text-align: right;">-0.128</td>
<td style="text-align: right;">-0.207</td>
</tr>
<tr class="odd">
<td style="text-align: left;">goal7</td>
<td style="text-align: right;">0.402</td>
<td style="text-align: right;">0.512</td>
<td style="text-align: right;">0.826</td>
<td style="text-align: right;">0.630</td>
<td style="text-align: right;">0.451</td>
<td style="text-align: right;">0.667</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.702</td>
<td style="text-align: right;">0.760</td>
<td style="text-align: right;">-0.084</td>
<td style="text-align: right;">0.809</td>
<td style="text-align: right;">-0.536</td>
<td style="text-align: right;">-0.487</td>
<td style="text-align: right;">-0.208</td>
<td style="text-align: right;">0.548</td>
<td style="text-align: right;">-0.024</td>
<td style="text-align: right;">-0.060</td>
</tr>
<tr class="even">
<td style="text-align: left;">goal8</td>
<td style="text-align: right;">0.537</td>
<td style="text-align: right;">0.548</td>
<td style="text-align: right;">0.806</td>
<td style="text-align: right;">0.610</td>
<td style="text-align: right;">0.453</td>
<td style="text-align: right;">0.625</td>
<td style="text-align: right;">0.702</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.741</td>
<td style="text-align: right;">0.189</td>
<td style="text-align: right;">0.642</td>
<td style="text-align: right;">-0.576</td>
<td style="text-align: right;">-0.563</td>
<td style="text-align: right;">-0.033</td>
<td style="text-align: right;">0.639</td>
<td style="text-align: right;">-0.012</td>
<td style="text-align: right;">-0.090</td>
</tr>
<tr class="odd">
<td style="text-align: left;">goal9</td>
<td style="text-align: right;">0.203</td>
<td style="text-align: right;">0.679</td>
<td style="text-align: right;">0.864</td>
<td style="text-align: right;">0.656</td>
<td style="text-align: right;">0.427</td>
<td style="text-align: right;">0.693</td>
<td style="text-align: right;">0.760</td>
<td style="text-align: right;">0.741</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">-0.115</td>
<td style="text-align: right;">0.671</td>
<td style="text-align: right;">-0.733</td>
<td style="text-align: right;">-0.730</td>
<td style="text-align: right;">-0.220</td>
<td style="text-align: right;">0.660</td>
<td style="text-align: right;">0.011</td>
<td style="text-align: right;">-0.067</td>
</tr>
<tr class="even">
<td style="text-align: left;">goal10</td>
<td style="text-align: right;">0.577</td>
<td style="text-align: right;">-0.205</td>
<td style="text-align: right;">-0.170</td>
<td style="text-align: right;">-0.080</td>
<td style="text-align: right;">-0.100</td>
<td style="text-align: right;">-0.006</td>
<td style="text-align: right;">-0.084</td>
<td style="text-align: right;">0.189</td>
<td style="text-align: right;">-0.115</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">-0.306</td>
<td style="text-align: right;">0.182</td>
<td style="text-align: right;">0.158</td>
<td style="text-align: right;">0.608</td>
<td style="text-align: right;">-0.033</td>
<td style="text-align: right;">-0.150</td>
<td style="text-align: right;">-0.038</td>
</tr>
<tr class="odd">
<td style="text-align: left;">goal11</td>
<td style="text-align: right;">0.170</td>
<td style="text-align: right;">0.520</td>
<td style="text-align: right;">0.804</td>
<td style="text-align: right;">0.455</td>
<td style="text-align: right;">0.529</td>
<td style="text-align: right;">0.655</td>
<td style="text-align: right;">0.809</td>
<td style="text-align: right;">0.642</td>
<td style="text-align: right;">0.671</td>
<td style="text-align: right;">-0.306</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">-0.631</td>
<td style="text-align: right;">-0.557</td>
<td style="text-align: right;">-0.354</td>
<td style="text-align: right;">0.695</td>
<td style="text-align: right;">-0.123</td>
<td style="text-align: right;">-0.154</td>
</tr>
<tr class="even">
<td style="text-align: left;">goal12</td>
<td style="text-align: right;">-0.035</td>
<td style="text-align: right;">-0.302</td>
<td style="text-align: right;">-0.747</td>
<td style="text-align: right;">-0.580</td>
<td style="text-align: right;">-0.404</td>
<td style="text-align: right;">-0.578</td>
<td style="text-align: right;">-0.536</td>
<td style="text-align: right;">-0.576</td>
<td style="text-align: right;">-0.733</td>
<td style="text-align: right;">0.182</td>
<td style="text-align: right;">-0.631</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.959</td>
<td style="text-align: right;">0.139</td>
<td style="text-align: right;">-0.732</td>
<td style="text-align: right;">0.112</td>
<td style="text-align: right;">0.116</td>
</tr>
<tr class="odd">
<td style="text-align: left;">goal13</td>
<td style="text-align: right;">-0.073</td>
<td style="text-align: right;">-0.321</td>
<td style="text-align: right;">-0.725</td>
<td style="text-align: right;">-0.604</td>
<td style="text-align: right;">-0.450</td>
<td style="text-align: right;">-0.542</td>
<td style="text-align: right;">-0.487</td>
<td style="text-align: right;">-0.563</td>
<td style="text-align: right;">-0.730</td>
<td style="text-align: right;">0.158</td>
<td style="text-align: right;">-0.557</td>
<td style="text-align: right;">0.959</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.069</td>
<td style="text-align: right;">-0.671</td>
<td style="text-align: right;">0.055</td>
<td style="text-align: right;">0.096</td>
</tr>
<tr class="even">
<td style="text-align: left;">goal15</td>
<td style="text-align: right;">0.450</td>
<td style="text-align: right;">-0.280</td>
<td style="text-align: right;">-0.212</td>
<td style="text-align: right;">-0.103</td>
<td style="text-align: right;">-0.205</td>
<td style="text-align: right;">-0.135</td>
<td style="text-align: right;">-0.208</td>
<td style="text-align: right;">-0.033</td>
<td style="text-align: right;">-0.220</td>
<td style="text-align: right;">0.608</td>
<td style="text-align: right;">-0.354</td>
<td style="text-align: right;">0.139</td>
<td style="text-align: right;">0.069</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.022</td>
<td style="text-align: right;">-0.071</td>
<td style="text-align: right;">-0.022</td>
</tr>
<tr class="odd">
<td style="text-align: left;">goal16</td>
<td style="text-align: right;">0.125</td>
<td style="text-align: right;">0.474</td>
<td style="text-align: right;">0.719</td>
<td style="text-align: right;">0.373</td>
<td style="text-align: right;">0.347</td>
<td style="text-align: right;">0.582</td>
<td style="text-align: right;">0.548</td>
<td style="text-align: right;">0.639</td>
<td style="text-align: right;">0.660</td>
<td style="text-align: right;">-0.033</td>
<td style="text-align: right;">0.695</td>
<td style="text-align: right;">-0.732</td>
<td style="text-align: right;">-0.671</td>
<td style="text-align: right;">0.022</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">-0.146</td>
<td style="text-align: right;">-0.130</td>
</tr>
<tr class="even">
<td style="text-align: left;">total_affected</td>
<td style="text-align: right;">-0.040</td>
<td style="text-align: right;">0.099</td>
<td style="text-align: right;">-0.017</td>
<td style="text-align: right;">0.093</td>
<td style="text-align: right;">0.055</td>
<td style="text-align: right;">-0.128</td>
<td style="text-align: right;">-0.024</td>
<td style="text-align: right;">-0.012</td>
<td style="text-align: right;">0.011</td>
<td style="text-align: right;">-0.150</td>
<td style="text-align: right;">-0.123</td>
<td style="text-align: right;">0.112</td>
<td style="text-align: right;">0.055</td>
<td style="text-align: right;">-0.071</td>
<td style="text-align: right;">-0.146</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.147</td>
</tr>
<tr class="odd">
<td style="text-align: left;">no_homeless</td>
<td style="text-align: right;">-0.050</td>
<td style="text-align: right;">-0.076</td>
<td style="text-align: right;">-0.105</td>
<td style="text-align: right;">-0.014</td>
<td style="text-align: right;">-0.152</td>
<td style="text-align: right;">-0.207</td>
<td style="text-align: right;">-0.060</td>
<td style="text-align: right;">-0.090</td>
<td style="text-align: right;">-0.067</td>
<td style="text-align: right;">-0.038</td>
<td style="text-align: right;">-0.154</td>
<td style="text-align: right;">0.116</td>
<td style="text-align: right;">0.096</td>
<td style="text-align: right;">-0.022</td>
<td style="text-align: right;">-0.130</td>
<td style="text-align: right;">0.147</td>
<td style="text-align: right;">1.000</td>
</tr>
</tbody>
</table>


</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>cor_melted <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">as.table</span>(correlation_matrix_disaster_Asia))</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(cor_melted) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Variable1"</span>, <span class="st">"Variable2"</span>, <span class="st">"Correlation"</span>)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> cor_melted, <span class="fu">aes</span>(Variable1, Variable2, <span class="at">fill =</span> Correlation)) <span class="sc">+</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient2</span>(<span class="at">low =</span> <span class="st">"blue"</span>, <span class="at">high =</span> <span class="st">"red"</span>, <span class="at">mid =</span> <span class="st">"white"</span>,</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>                       <span class="at">midpoint =</span> <span class="dv">0</span>, <span class="at">limit =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>), <span class="at">space =</span> <span class="st">"Lab"</span>,</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>                       <span class="at">name =</span> <span class="st">"Correlation"</span>) <span class="sc">+</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">8</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>)) <span class="sc">+</span></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>() <span class="sc">+</span></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">''</span>, <span class="at">y =</span> <span class="st">''</span>,</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">'Correlation between the climate disasters and the SDG goals in South and East Asia'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="eda_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>We conclude that climate disasters do not really have a big impact on SDG goals.</p>
<p>Here we want to analyse the correlation between the Covid-19 and the SDG goals only during Covid time.</p>
<div class="cell" data-layout-align="center" data-hash="eda_cache/html/unnamed-chunk-23_716f35c9a2238dd92f744680839752e7">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>covid_filtered <span class="ot">&lt;-</span> Q3<span class="fl">.2</span>[Q3<span class="fl">.2</span><span class="sc">$</span>year <span class="sc">&gt;=</span> <span class="fu">as.Date</span>(<span class="st">"2019-01-01"</span>), ]</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>relevant_columns <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"goal1"</span>, <span class="st">"goal2"</span>, <span class="st">"goal3"</span>, <span class="st">"goal4"</span>, <span class="st">"goal5"</span>, <span class="st">"goal6"</span>, <span class="st">"goal7"</span>, <span class="st">"goal8"</span>, <span class="st">"goal9"</span>, <span class="st">"goal10"</span>, <span class="st">"goal11"</span>, <span class="st">"goal12"</span>, <span class="st">"goal13"</span>, <span class="st">"goal15"</span>, <span class="st">"goal16"</span>, <span class="st">"stringency"</span>, <span class="st">"cases_per_million"</span>, <span class="st">"deaths_per_million"</span>)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Subset data with relevant columns for correlation analysis</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>relevant_data <span class="ot">&lt;-</span> covid_filtered[, relevant_columns]</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>correlation_matrix_Covid <span class="ot">&lt;-</span> <span class="fu">cor</span>(relevant_data, <span class="at">use =</span> <span class="st">"complete.obs"</span>)</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(correlation_matrix_Covid)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">goal1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">goal2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">goal3</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">goal4</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">goal5</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">goal6</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">goal7</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">goal8</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">goal9</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">goal10</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">goal11</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">goal12</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">goal13</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">goal15</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">goal16</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">stringency</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">cases_per_million</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">deaths_per_million</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">goal1</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.534</td>
<td style="text-align: right;">0.867</td>
<td style="text-align: right;">0.777</td>
<td style="text-align: right;">0.445</td>
<td style="text-align: right;">0.763</td>
<td style="text-align: right;">0.798</td>
<td style="text-align: right;">0.584</td>
<td style="text-align: right;">0.781</td>
<td style="text-align: right;">0.497</td>
<td style="text-align: right;">0.727</td>
<td style="text-align: right;">-0.648</td>
<td style="text-align: right;">-0.553</td>
<td style="text-align: right;">0.099</td>
<td style="text-align: right;">0.714</td>
<td style="text-align: right;">0.056</td>
<td style="text-align: right;">0.341</td>
<td style="text-align: right;">0.361</td>
</tr>
<tr class="even">
<td style="text-align: left;">goal2</td>
<td style="text-align: right;">0.534</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.560</td>
<td style="text-align: right;">0.541</td>
<td style="text-align: right;">0.469</td>
<td style="text-align: right;">0.605</td>
<td style="text-align: right;">0.469</td>
<td style="text-align: right;">0.636</td>
<td style="text-align: right;">0.569</td>
<td style="text-align: right;">0.240</td>
<td style="text-align: right;">0.463</td>
<td style="text-align: right;">-0.353</td>
<td style="text-align: right;">-0.284</td>
<td style="text-align: right;">0.122</td>
<td style="text-align: right;">0.451</td>
<td style="text-align: right;">0.088</td>
<td style="text-align: right;">0.206</td>
<td style="text-align: right;">0.242</td>
</tr>
<tr class="odd">
<td style="text-align: left;">goal3</td>
<td style="text-align: right;">0.867</td>
<td style="text-align: right;">0.560</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.829</td>
<td style="text-align: right;">0.641</td>
<td style="text-align: right;">0.836</td>
<td style="text-align: right;">0.845</td>
<td style="text-align: right;">0.693</td>
<td style="text-align: right;">0.881</td>
<td style="text-align: right;">0.456</td>
<td style="text-align: right;">0.828</td>
<td style="text-align: right;">-0.789</td>
<td style="text-align: right;">-0.669</td>
<td style="text-align: right;">0.152</td>
<td style="text-align: right;">0.825</td>
<td style="text-align: right;">0.040</td>
<td style="text-align: right;">0.412</td>
<td style="text-align: right;">0.373</td>
</tr>
<tr class="even">
<td style="text-align: left;">goal4</td>
<td style="text-align: right;">0.777</td>
<td style="text-align: right;">0.541</td>
<td style="text-align: right;">0.829</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.656</td>
<td style="text-align: right;">0.764</td>
<td style="text-align: right;">0.803</td>
<td style="text-align: right;">0.596</td>
<td style="text-align: right;">0.773</td>
<td style="text-align: right;">0.309</td>
<td style="text-align: right;">0.758</td>
<td style="text-align: right;">-0.655</td>
<td style="text-align: right;">-0.558</td>
<td style="text-align: right;">0.058</td>
<td style="text-align: right;">0.674</td>
<td style="text-align: right;">0.113</td>
<td style="text-align: right;">0.349</td>
<td style="text-align: right;">0.339</td>
</tr>
<tr class="odd">
<td style="text-align: left;">goal5</td>
<td style="text-align: right;">0.445</td>
<td style="text-align: right;">0.469</td>
<td style="text-align: right;">0.641</td>
<td style="text-align: right;">0.656</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.663</td>
<td style="text-align: right;">0.606</td>
<td style="text-align: right;">0.587</td>
<td style="text-align: right;">0.645</td>
<td style="text-align: right;">0.098</td>
<td style="text-align: right;">0.690</td>
<td style="text-align: right;">-0.653</td>
<td style="text-align: right;">-0.564</td>
<td style="text-align: right;">0.203</td>
<td style="text-align: right;">0.628</td>
<td style="text-align: right;">0.060</td>
<td style="text-align: right;">0.330</td>
<td style="text-align: right;">0.261</td>
</tr>
<tr class="even">
<td style="text-align: left;">goal6</td>
<td style="text-align: right;">0.763</td>
<td style="text-align: right;">0.605</td>
<td style="text-align: right;">0.836</td>
<td style="text-align: right;">0.764</td>
<td style="text-align: right;">0.663</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.765</td>
<td style="text-align: right;">0.711</td>
<td style="text-align: right;">0.811</td>
<td style="text-align: right;">0.366</td>
<td style="text-align: right;">0.766</td>
<td style="text-align: right;">-0.727</td>
<td style="text-align: right;">-0.583</td>
<td style="text-align: right;">0.262</td>
<td style="text-align: right;">0.729</td>
<td style="text-align: right;">0.069</td>
<td style="text-align: right;">0.389</td>
<td style="text-align: right;">0.398</td>
</tr>
<tr class="odd">
<td style="text-align: left;">goal7</td>
<td style="text-align: right;">0.798</td>
<td style="text-align: right;">0.469</td>
<td style="text-align: right;">0.845</td>
<td style="text-align: right;">0.803</td>
<td style="text-align: right;">0.606</td>
<td style="text-align: right;">0.765</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.556</td>
<td style="text-align: right;">0.740</td>
<td style="text-align: right;">0.323</td>
<td style="text-align: right;">0.793</td>
<td style="text-align: right;">-0.654</td>
<td style="text-align: right;">-0.494</td>
<td style="text-align: right;">0.123</td>
<td style="text-align: right;">0.697</td>
<td style="text-align: right;">0.055</td>
<td style="text-align: right;">0.340</td>
<td style="text-align: right;">0.374</td>
</tr>
<tr class="even">
<td style="text-align: left;">goal8</td>
<td style="text-align: right;">0.584</td>
<td style="text-align: right;">0.636</td>
<td style="text-align: right;">0.693</td>
<td style="text-align: right;">0.596</td>
<td style="text-align: right;">0.587</td>
<td style="text-align: right;">0.711</td>
<td style="text-align: right;">0.556</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.695</td>
<td style="text-align: right;">0.387</td>
<td style="text-align: right;">0.587</td>
<td style="text-align: right;">-0.635</td>
<td style="text-align: right;">-0.556</td>
<td style="text-align: right;">0.283</td>
<td style="text-align: right;">0.627</td>
<td style="text-align: right;">0.024</td>
<td style="text-align: right;">0.356</td>
<td style="text-align: right;">0.278</td>
</tr>
<tr class="odd">
<td style="text-align: left;">goal9</td>
<td style="text-align: right;">0.781</td>
<td style="text-align: right;">0.569</td>
<td style="text-align: right;">0.881</td>
<td style="text-align: right;">0.773</td>
<td style="text-align: right;">0.645</td>
<td style="text-align: right;">0.811</td>
<td style="text-align: right;">0.740</td>
<td style="text-align: right;">0.695</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.462</td>
<td style="text-align: right;">0.753</td>
<td style="text-align: right;">-0.857</td>
<td style="text-align: right;">-0.760</td>
<td style="text-align: right;">0.189</td>
<td style="text-align: right;">0.819</td>
<td style="text-align: right;">0.074</td>
<td style="text-align: right;">0.460</td>
<td style="text-align: right;">0.353</td>
</tr>
<tr class="even">
<td style="text-align: left;">goal10</td>
<td style="text-align: right;">0.497</td>
<td style="text-align: right;">0.240</td>
<td style="text-align: right;">0.456</td>
<td style="text-align: right;">0.309</td>
<td style="text-align: right;">0.098</td>
<td style="text-align: right;">0.366</td>
<td style="text-align: right;">0.323</td>
<td style="text-align: right;">0.387</td>
<td style="text-align: right;">0.462</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.281</td>
<td style="text-align: right;">-0.496</td>
<td style="text-align: right;">-0.469</td>
<td style="text-align: right;">0.215</td>
<td style="text-align: right;">0.519</td>
<td style="text-align: right;">-0.030</td>
<td style="text-align: right;">0.262</td>
<td style="text-align: right;">0.142</td>
</tr>
<tr class="odd">
<td style="text-align: left;">goal11</td>
<td style="text-align: right;">0.727</td>
<td style="text-align: right;">0.463</td>
<td style="text-align: right;">0.828</td>
<td style="text-align: right;">0.758</td>
<td style="text-align: right;">0.690</td>
<td style="text-align: right;">0.766</td>
<td style="text-align: right;">0.793</td>
<td style="text-align: right;">0.587</td>
<td style="text-align: right;">0.753</td>
<td style="text-align: right;">0.281</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">-0.696</td>
<td style="text-align: right;">-0.576</td>
<td style="text-align: right;">0.089</td>
<td style="text-align: right;">0.764</td>
<td style="text-align: right;">0.037</td>
<td style="text-align: right;">0.345</td>
<td style="text-align: right;">0.328</td>
</tr>
<tr class="even">
<td style="text-align: left;">goal12</td>
<td style="text-align: right;">-0.648</td>
<td style="text-align: right;">-0.353</td>
<td style="text-align: right;">-0.789</td>
<td style="text-align: right;">-0.655</td>
<td style="text-align: right;">-0.653</td>
<td style="text-align: right;">-0.727</td>
<td style="text-align: right;">-0.654</td>
<td style="text-align: right;">-0.635</td>
<td style="text-align: right;">-0.857</td>
<td style="text-align: right;">-0.496</td>
<td style="text-align: right;">-0.696</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.876</td>
<td style="text-align: right;">-0.316</td>
<td style="text-align: right;">-0.825</td>
<td style="text-align: right;">0.013</td>
<td style="text-align: right;">-0.466</td>
<td style="text-align: right;">-0.292</td>
</tr>
<tr class="odd">
<td style="text-align: left;">goal13</td>
<td style="text-align: right;">-0.553</td>
<td style="text-align: right;">-0.284</td>
<td style="text-align: right;">-0.669</td>
<td style="text-align: right;">-0.558</td>
<td style="text-align: right;">-0.564</td>
<td style="text-align: right;">-0.583</td>
<td style="text-align: right;">-0.494</td>
<td style="text-align: right;">-0.556</td>
<td style="text-align: right;">-0.760</td>
<td style="text-align: right;">-0.469</td>
<td style="text-align: right;">-0.576</td>
<td style="text-align: right;">0.876</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">-0.205</td>
<td style="text-align: right;">-0.682</td>
<td style="text-align: right;">-0.018</td>
<td style="text-align: right;">-0.364</td>
<td style="text-align: right;">-0.166</td>
</tr>
<tr class="even">
<td style="text-align: left;">goal15</td>
<td style="text-align: right;">0.099</td>
<td style="text-align: right;">0.122</td>
<td style="text-align: right;">0.152</td>
<td style="text-align: right;">0.058</td>
<td style="text-align: right;">0.203</td>
<td style="text-align: right;">0.262</td>
<td style="text-align: right;">0.123</td>
<td style="text-align: right;">0.283</td>
<td style="text-align: right;">0.189</td>
<td style="text-align: right;">0.215</td>
<td style="text-align: right;">0.089</td>
<td style="text-align: right;">-0.316</td>
<td style="text-align: right;">-0.205</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.303</td>
<td style="text-align: right;">-0.068</td>
<td style="text-align: right;">0.169</td>
<td style="text-align: right;">0.223</td>
</tr>
<tr class="odd">
<td style="text-align: left;">goal16</td>
<td style="text-align: right;">0.714</td>
<td style="text-align: right;">0.451</td>
<td style="text-align: right;">0.825</td>
<td style="text-align: right;">0.674</td>
<td style="text-align: right;">0.628</td>
<td style="text-align: right;">0.729</td>
<td style="text-align: right;">0.697</td>
<td style="text-align: right;">0.627</td>
<td style="text-align: right;">0.819</td>
<td style="text-align: right;">0.519</td>
<td style="text-align: right;">0.764</td>
<td style="text-align: right;">-0.825</td>
<td style="text-align: right;">-0.682</td>
<td style="text-align: right;">0.303</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">-0.023</td>
<td style="text-align: right;">0.425</td>
<td style="text-align: right;">0.316</td>
</tr>
<tr class="even">
<td style="text-align: left;">stringency</td>
<td style="text-align: right;">0.056</td>
<td style="text-align: right;">0.088</td>
<td style="text-align: right;">0.040</td>
<td style="text-align: right;">0.113</td>
<td style="text-align: right;">0.060</td>
<td style="text-align: right;">0.069</td>
<td style="text-align: right;">0.055</td>
<td style="text-align: right;">0.024</td>
<td style="text-align: right;">0.074</td>
<td style="text-align: right;">-0.030</td>
<td style="text-align: right;">0.037</td>
<td style="text-align: right;">0.013</td>
<td style="text-align: right;">-0.018</td>
<td style="text-align: right;">-0.068</td>
<td style="text-align: right;">-0.023</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.041</td>
<td style="text-align: right;">0.336</td>
</tr>
<tr class="odd">
<td style="text-align: left;">cases_per_million</td>
<td style="text-align: right;">0.341</td>
<td style="text-align: right;">0.206</td>
<td style="text-align: right;">0.412</td>
<td style="text-align: right;">0.349</td>
<td style="text-align: right;">0.330</td>
<td style="text-align: right;">0.389</td>
<td style="text-align: right;">0.340</td>
<td style="text-align: right;">0.356</td>
<td style="text-align: right;">0.460</td>
<td style="text-align: right;">0.262</td>
<td style="text-align: right;">0.345</td>
<td style="text-align: right;">-0.466</td>
<td style="text-align: right;">-0.364</td>
<td style="text-align: right;">0.169</td>
<td style="text-align: right;">0.425</td>
<td style="text-align: right;">0.041</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.416</td>
</tr>
<tr class="even">
<td style="text-align: left;">deaths_per_million</td>
<td style="text-align: right;">0.361</td>
<td style="text-align: right;">0.242</td>
<td style="text-align: right;">0.373</td>
<td style="text-align: right;">0.339</td>
<td style="text-align: right;">0.261</td>
<td style="text-align: right;">0.398</td>
<td style="text-align: right;">0.374</td>
<td style="text-align: right;">0.278</td>
<td style="text-align: right;">0.353</td>
<td style="text-align: right;">0.142</td>
<td style="text-align: right;">0.328</td>
<td style="text-align: right;">-0.292</td>
<td style="text-align: right;">-0.166</td>
<td style="text-align: right;">0.223</td>
<td style="text-align: right;">0.316</td>
<td style="text-align: right;">0.336</td>
<td style="text-align: right;">0.416</td>
<td style="text-align: right;">1.000</td>
</tr>
</tbody>
</table>


</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>cor_melted <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">as.table</span>(correlation_matrix_Covid))</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(cor_melted) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Variable1"</span>, <span class="st">"Variable2"</span>, <span class="st">"Correlation"</span>)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> cor_melted, <span class="fu">aes</span>(Variable1, Variable2, <span class="at">fill =</span> Correlation)) <span class="sc">+</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient2</span>(<span class="at">low =</span> <span class="st">"blue"</span>, <span class="at">high =</span> <span class="st">"red"</span>, <span class="at">mid =</span> <span class="st">"white"</span>,</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>                       <span class="at">midpoint =</span> <span class="dv">0</span>, <span class="at">limit =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>), <span class="at">space =</span> <span class="st">"Lab"</span>,</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>                       <span class="at">name =</span> <span class="st">"Correlation"</span>) <span class="sc">+</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">8</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>)) <span class="sc">+</span></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>() <span class="sc">+</span></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">''</span>, <span class="at">y =</span> <span class="st">''</span>,</span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">'Correlation between COVID and the SDG goals'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="eda_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>Same conclusion, really weird.</p>
<p>Here we want to analyse the correlation between conflicts deaths and the SDG goals only for the Middle East &amp; North Africa, Sub-Saharan Africa, South Asia, Latin America &amp; the Caribbean and Eastern Europe regions.</p>
<div class="cell" data-layout-align="center" data-hash="eda_cache/html/unnamed-chunk-24_66ed21821badaaa479ae6014042ec721">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter data for specific regions</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>selected_regions <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Middle East &amp; North Africa"</span>, <span class="st">"Sub-Saharan Africa"</span>, <span class="st">"South Asia"</span>, <span class="st">"Latin America &amp; the Caribbean"</span>, <span class="st">"Eastern Europe"</span>)</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>conflicts_selected <span class="ot">&lt;-</span> Q3<span class="fl">.3</span>[Q3<span class="fl">.3</span><span class="sc">$</span>region <span class="sc">%in%</span> selected_regions, ]</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Select relevant columns for the correlation analysis</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>relevant_columns <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"goal1"</span>, <span class="st">"goal2"</span>, <span class="st">"goal3"</span>, <span class="st">"goal4"</span>, <span class="st">"goal5"</span>, <span class="st">"goal6"</span>, <span class="st">"goal7"</span>, <span class="st">"goal8"</span>, <span class="st">"goal9"</span>, <span class="st">"goal10"</span>, <span class="st">"goal11"</span>, <span class="st">"goal12"</span>, <span class="st">"goal13"</span>, <span class="st">"goal15"</span>, <span class="st">"goal16"</span>, <span class="st">"sum_deaths"</span>)</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute correlation matrix for the selected regions</span></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>correlation_matrix_Conflicts_Deaths <span class="ot">&lt;-</span> <span class="fu">cor</span>(conflicts_selected[, relevant_columns], <span class="at">use =</span> <span class="st">"complete.obs"</span>)</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a><span class="co"># View the correlation matrix</span></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(correlation_matrix_Conflicts_Deaths)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">goal1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">goal2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">goal3</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">goal4</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">goal5</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">goal6</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">goal7</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">goal8</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">goal9</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">goal10</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">goal11</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">goal12</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">goal13</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">goal15</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">goal16</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">sum_deaths</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">goal1</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.476</td>
<td style="text-align: right;">0.910</td>
<td style="text-align: right;">0.791</td>
<td style="text-align: right;">0.406</td>
<td style="text-align: right;">0.799</td>
<td style="text-align: right;">0.865</td>
<td style="text-align: right;">0.546</td>
<td style="text-align: right;">0.723</td>
<td style="text-align: right;">0.272</td>
<td style="text-align: right;">0.783</td>
<td style="text-align: right;">-0.730</td>
<td style="text-align: right;">-0.594</td>
<td style="text-align: right;">0.039</td>
<td style="text-align: right;">0.613</td>
<td style="text-align: right;">-0.095</td>
</tr>
<tr class="even">
<td style="text-align: left;">goal2</td>
<td style="text-align: right;">0.476</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.544</td>
<td style="text-align: right;">0.531</td>
<td style="text-align: right;">0.540</td>
<td style="text-align: right;">0.638</td>
<td style="text-align: right;">0.531</td>
<td style="text-align: right;">0.571</td>
<td style="text-align: right;">0.530</td>
<td style="text-align: right;">0.102</td>
<td style="text-align: right;">0.475</td>
<td style="text-align: right;">-0.376</td>
<td style="text-align: right;">-0.322</td>
<td style="text-align: right;">0.154</td>
<td style="text-align: right;">0.430</td>
<td style="text-align: right;">-0.173</td>
</tr>
<tr class="odd">
<td style="text-align: left;">goal3</td>
<td style="text-align: right;">0.910</td>
<td style="text-align: right;">0.544</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.814</td>
<td style="text-align: right;">0.507</td>
<td style="text-align: right;">0.832</td>
<td style="text-align: right;">0.876</td>
<td style="text-align: right;">0.596</td>
<td style="text-align: right;">0.768</td>
<td style="text-align: right;">0.223</td>
<td style="text-align: right;">0.828</td>
<td style="text-align: right;">-0.745</td>
<td style="text-align: right;">-0.587</td>
<td style="text-align: right;">0.014</td>
<td style="text-align: right;">0.666</td>
<td style="text-align: right;">-0.117</td>
</tr>
<tr class="even">
<td style="text-align: left;">goal4</td>
<td style="text-align: right;">0.791</td>
<td style="text-align: right;">0.531</td>
<td style="text-align: right;">0.814</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.645</td>
<td style="text-align: right;">0.748</td>
<td style="text-align: right;">0.808</td>
<td style="text-align: right;">0.536</td>
<td style="text-align: right;">0.696</td>
<td style="text-align: right;">0.089</td>
<td style="text-align: right;">0.768</td>
<td style="text-align: right;">-0.667</td>
<td style="text-align: right;">-0.533</td>
<td style="text-align: right;">0.007</td>
<td style="text-align: right;">0.496</td>
<td style="text-align: right;">-0.101</td>
</tr>
<tr class="odd">
<td style="text-align: left;">goal5</td>
<td style="text-align: right;">0.406</td>
<td style="text-align: right;">0.540</td>
<td style="text-align: right;">0.507</td>
<td style="text-align: right;">0.645</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.587</td>
<td style="text-align: right;">0.539</td>
<td style="text-align: right;">0.454</td>
<td style="text-align: right;">0.516</td>
<td style="text-align: right;">-0.178</td>
<td style="text-align: right;">0.620</td>
<td style="text-align: right;">-0.464</td>
<td style="text-align: right;">-0.351</td>
<td style="text-align: right;">0.191</td>
<td style="text-align: right;">0.384</td>
<td style="text-align: right;">-0.162</td>
</tr>
<tr class="even">
<td style="text-align: left;">goal6</td>
<td style="text-align: right;">0.799</td>
<td style="text-align: right;">0.638</td>
<td style="text-align: right;">0.832</td>
<td style="text-align: right;">0.748</td>
<td style="text-align: right;">0.587</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.812</td>
<td style="text-align: right;">0.670</td>
<td style="text-align: right;">0.734</td>
<td style="text-align: right;">0.137</td>
<td style="text-align: right;">0.788</td>
<td style="text-align: right;">-0.711</td>
<td style="text-align: right;">-0.529</td>
<td style="text-align: right;">0.187</td>
<td style="text-align: right;">0.599</td>
<td style="text-align: right;">-0.166</td>
</tr>
<tr class="odd">
<td style="text-align: left;">goal7</td>
<td style="text-align: right;">0.865</td>
<td style="text-align: right;">0.531</td>
<td style="text-align: right;">0.876</td>
<td style="text-align: right;">0.808</td>
<td style="text-align: right;">0.539</td>
<td style="text-align: right;">0.812</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.539</td>
<td style="text-align: right;">0.720</td>
<td style="text-align: right;">0.152</td>
<td style="text-align: right;">0.841</td>
<td style="text-align: right;">-0.704</td>
<td style="text-align: right;">-0.531</td>
<td style="text-align: right;">0.039</td>
<td style="text-align: right;">0.566</td>
<td style="text-align: right;">-0.094</td>
</tr>
<tr class="even">
<td style="text-align: left;">goal8</td>
<td style="text-align: right;">0.546</td>
<td style="text-align: right;">0.571</td>
<td style="text-align: right;">0.596</td>
<td style="text-align: right;">0.536</td>
<td style="text-align: right;">0.454</td>
<td style="text-align: right;">0.670</td>
<td style="text-align: right;">0.539</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.609</td>
<td style="text-align: right;">0.209</td>
<td style="text-align: right;">0.542</td>
<td style="text-align: right;">-0.519</td>
<td style="text-align: right;">-0.389</td>
<td style="text-align: right;">0.181</td>
<td style="text-align: right;">0.462</td>
<td style="text-align: right;">-0.102</td>
</tr>
<tr class="odd">
<td style="text-align: left;">goal9</td>
<td style="text-align: right;">0.723</td>
<td style="text-align: right;">0.530</td>
<td style="text-align: right;">0.768</td>
<td style="text-align: right;">0.696</td>
<td style="text-align: right;">0.516</td>
<td style="text-align: right;">0.734</td>
<td style="text-align: right;">0.720</td>
<td style="text-align: right;">0.609</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.300</td>
<td style="text-align: right;">0.698</td>
<td style="text-align: right;">-0.759</td>
<td style="text-align: right;">-0.689</td>
<td style="text-align: right;">0.137</td>
<td style="text-align: right;">0.591</td>
<td style="text-align: right;">-0.077</td>
</tr>
<tr class="even">
<td style="text-align: left;">goal10</td>
<td style="text-align: right;">0.272</td>
<td style="text-align: right;">0.102</td>
<td style="text-align: right;">0.223</td>
<td style="text-align: right;">0.089</td>
<td style="text-align: right;">-0.178</td>
<td style="text-align: right;">0.137</td>
<td style="text-align: right;">0.152</td>
<td style="text-align: right;">0.209</td>
<td style="text-align: right;">0.300</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.035</td>
<td style="text-align: right;">-0.297</td>
<td style="text-align: right;">-0.299</td>
<td style="text-align: right;">0.118</td>
<td style="text-align: right;">0.275</td>
<td style="text-align: right;">0.078</td>
</tr>
<tr class="odd">
<td style="text-align: left;">goal11</td>
<td style="text-align: right;">0.783</td>
<td style="text-align: right;">0.475</td>
<td style="text-align: right;">0.828</td>
<td style="text-align: right;">0.768</td>
<td style="text-align: right;">0.620</td>
<td style="text-align: right;">0.788</td>
<td style="text-align: right;">0.841</td>
<td style="text-align: right;">0.542</td>
<td style="text-align: right;">0.698</td>
<td style="text-align: right;">0.035</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">-0.729</td>
<td style="text-align: right;">-0.570</td>
<td style="text-align: right;">0.031</td>
<td style="text-align: right;">0.656</td>
<td style="text-align: right;">-0.155</td>
</tr>
<tr class="even">
<td style="text-align: left;">goal12</td>
<td style="text-align: right;">-0.730</td>
<td style="text-align: right;">-0.376</td>
<td style="text-align: right;">-0.745</td>
<td style="text-align: right;">-0.667</td>
<td style="text-align: right;">-0.464</td>
<td style="text-align: right;">-0.711</td>
<td style="text-align: right;">-0.704</td>
<td style="text-align: right;">-0.519</td>
<td style="text-align: right;">-0.759</td>
<td style="text-align: right;">-0.297</td>
<td style="text-align: right;">-0.729</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.865</td>
<td style="text-align: right;">-0.170</td>
<td style="text-align: right;">-0.666</td>
<td style="text-align: right;">0.122</td>
</tr>
<tr class="odd">
<td style="text-align: left;">goal13</td>
<td style="text-align: right;">-0.594</td>
<td style="text-align: right;">-0.322</td>
<td style="text-align: right;">-0.587</td>
<td style="text-align: right;">-0.533</td>
<td style="text-align: right;">-0.351</td>
<td style="text-align: right;">-0.529</td>
<td style="text-align: right;">-0.531</td>
<td style="text-align: right;">-0.389</td>
<td style="text-align: right;">-0.689</td>
<td style="text-align: right;">-0.299</td>
<td style="text-align: right;">-0.570</td>
<td style="text-align: right;">0.865</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">-0.150</td>
<td style="text-align: right;">-0.493</td>
<td style="text-align: right;">0.079</td>
</tr>
<tr class="even">
<td style="text-align: left;">goal15</td>
<td style="text-align: right;">0.039</td>
<td style="text-align: right;">0.154</td>
<td style="text-align: right;">0.014</td>
<td style="text-align: right;">0.007</td>
<td style="text-align: right;">0.191</td>
<td style="text-align: right;">0.187</td>
<td style="text-align: right;">0.039</td>
<td style="text-align: right;">0.181</td>
<td style="text-align: right;">0.137</td>
<td style="text-align: right;">0.118</td>
<td style="text-align: right;">0.031</td>
<td style="text-align: right;">-0.170</td>
<td style="text-align: right;">-0.150</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.191</td>
<td style="text-align: right;">-0.063</td>
</tr>
<tr class="odd">
<td style="text-align: left;">goal16</td>
<td style="text-align: right;">0.613</td>
<td style="text-align: right;">0.430</td>
<td style="text-align: right;">0.666</td>
<td style="text-align: right;">0.496</td>
<td style="text-align: right;">0.384</td>
<td style="text-align: right;">0.599</td>
<td style="text-align: right;">0.566</td>
<td style="text-align: right;">0.462</td>
<td style="text-align: right;">0.591</td>
<td style="text-align: right;">0.275</td>
<td style="text-align: right;">0.656</td>
<td style="text-align: right;">-0.666</td>
<td style="text-align: right;">-0.493</td>
<td style="text-align: right;">0.191</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">-0.162</td>
</tr>
<tr class="even">
<td style="text-align: left;">sum_deaths</td>
<td style="text-align: right;">-0.095</td>
<td style="text-align: right;">-0.173</td>
<td style="text-align: right;">-0.117</td>
<td style="text-align: right;">-0.101</td>
<td style="text-align: right;">-0.162</td>
<td style="text-align: right;">-0.166</td>
<td style="text-align: right;">-0.094</td>
<td style="text-align: right;">-0.102</td>
<td style="text-align: right;">-0.077</td>
<td style="text-align: right;">0.078</td>
<td style="text-align: right;">-0.155</td>
<td style="text-align: right;">0.122</td>
<td style="text-align: right;">0.079</td>
<td style="text-align: right;">-0.063</td>
<td style="text-align: right;">-0.162</td>
<td style="text-align: right;">1.000</td>
</tr>
</tbody>
</table>


</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Melt the correlation matrix for ggplot2</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>cor_melted <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">as.table</span>(correlation_matrix_Conflicts_Deaths))</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(cor_melted) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Variable1"</span>, <span class="st">"Variable2"</span>, <span class="st">"Correlation"</span>)</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the heatmap</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> cor_melted, <span class="fu">aes</span>(Variable1, Variable2, <span class="at">fill =</span> Correlation)) <span class="sc">+</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient2</span>(<span class="at">low =</span> <span class="st">"blue"</span>, <span class="at">high =</span> <span class="st">"red"</span>, <span class="at">mid =</span> <span class="st">"white"</span>,</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>                       <span class="at">midpoint =</span> <span class="dv">0</span>, <span class="at">limit =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>), <span class="at">space =</span> <span class="st">"Lab"</span>,</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>                       <span class="at">name =</span> <span class="st">"Correlation"</span>) <span class="sc">+</span></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">8</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>)) <span class="sc">+</span></span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>() <span class="sc">+</span></span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">''</span>, <span class="at">y =</span> <span class="st">''</span>,</span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">'Correlation between Conflicts deaths and the SDG goals'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="eda_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>Finally, we want to analyse the correlation between conflicts affected population and the SDG goals only for the Middle East &amp; North Africa, Sub-Saharan Africa, South Asia, Latin America &amp; the Caribbean, Eastern Europe regions and Caucasus and Central Asia.</p>
<div class="cell" data-layout-align="center" data-hash="eda_cache/html/unnamed-chunk-25_5e840974677e867cdee05540fb710493">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter data for specific regions (pop_affected)</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>selected_regions <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Middle East &amp; North Africa"</span>, <span class="st">"Sub-Saharan Africa"</span>, <span class="st">"South Asia"</span>, <span class="st">"Latin America &amp; the Caribbean"</span>, <span class="st">"Eastern Europe"</span>,<span class="st">"Caucasus and Central Asia"</span>)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>conflicts_selected <span class="ot">&lt;-</span> Q3<span class="fl">.3</span>[Q3<span class="fl">.3</span><span class="sc">$</span>region <span class="sc">%in%</span> selected_regions, ]</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Select relevant columns for the correlation analysis</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>relevant_columns <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"goal1"</span>, <span class="st">"goal2"</span>, <span class="st">"goal3"</span>, <span class="st">"goal4"</span>, <span class="st">"goal5"</span>, <span class="st">"goal6"</span>, <span class="st">"goal7"</span>, <span class="st">"goal8"</span>, <span class="st">"goal9"</span>, <span class="st">"goal10"</span>, <span class="st">"goal11"</span>, <span class="st">"goal12"</span>, <span class="st">"goal13"</span>, <span class="st">"goal15"</span>, <span class="st">"goal16"</span>, <span class="st">"pop_affected"</span>)</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute correlation matrix for the selected regions</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>correlation_matrix_Conflicts_Pop_Affected <span class="ot">&lt;-</span> <span class="fu">cor</span>(conflicts_selected[, relevant_columns], <span class="at">use =</span> <span class="st">"complete.obs"</span>)</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a><span class="co"># View the correlation matrix</span></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(correlation_matrix_Conflicts_Pop_Affected)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">goal1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">goal2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">goal3</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">goal4</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">goal5</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">goal6</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">goal7</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">goal8</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">goal9</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">goal10</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">goal11</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">goal12</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">goal13</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">goal15</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">goal16</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">pop_affected</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">goal1</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.476</td>
<td style="text-align: right;">0.910</td>
<td style="text-align: right;">0.791</td>
<td style="text-align: right;">0.406</td>
<td style="text-align: right;">0.799</td>
<td style="text-align: right;">0.865</td>
<td style="text-align: right;">0.546</td>
<td style="text-align: right;">0.723</td>
<td style="text-align: right;">0.272</td>
<td style="text-align: right;">0.783</td>
<td style="text-align: right;">-0.730</td>
<td style="text-align: right;">-0.594</td>
<td style="text-align: right;">0.039</td>
<td style="text-align: right;">0.613</td>
<td style="text-align: right;">-0.066</td>
</tr>
<tr class="even">
<td style="text-align: left;">goal2</td>
<td style="text-align: right;">0.476</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.544</td>
<td style="text-align: right;">0.531</td>
<td style="text-align: right;">0.540</td>
<td style="text-align: right;">0.638</td>
<td style="text-align: right;">0.531</td>
<td style="text-align: right;">0.571</td>
<td style="text-align: right;">0.530</td>
<td style="text-align: right;">0.102</td>
<td style="text-align: right;">0.475</td>
<td style="text-align: right;">-0.376</td>
<td style="text-align: right;">-0.322</td>
<td style="text-align: right;">0.154</td>
<td style="text-align: right;">0.430</td>
<td style="text-align: right;">-0.083</td>
</tr>
<tr class="odd">
<td style="text-align: left;">goal3</td>
<td style="text-align: right;">0.910</td>
<td style="text-align: right;">0.544</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.814</td>
<td style="text-align: right;">0.507</td>
<td style="text-align: right;">0.832</td>
<td style="text-align: right;">0.876</td>
<td style="text-align: right;">0.596</td>
<td style="text-align: right;">0.768</td>
<td style="text-align: right;">0.223</td>
<td style="text-align: right;">0.828</td>
<td style="text-align: right;">-0.745</td>
<td style="text-align: right;">-0.587</td>
<td style="text-align: right;">0.014</td>
<td style="text-align: right;">0.666</td>
<td style="text-align: right;">-0.058</td>
</tr>
<tr class="even">
<td style="text-align: left;">goal4</td>
<td style="text-align: right;">0.791</td>
<td style="text-align: right;">0.531</td>
<td style="text-align: right;">0.814</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.645</td>
<td style="text-align: right;">0.748</td>
<td style="text-align: right;">0.808</td>
<td style="text-align: right;">0.536</td>
<td style="text-align: right;">0.696</td>
<td style="text-align: right;">0.089</td>
<td style="text-align: right;">0.768</td>
<td style="text-align: right;">-0.667</td>
<td style="text-align: right;">-0.533</td>
<td style="text-align: right;">0.007</td>
<td style="text-align: right;">0.496</td>
<td style="text-align: right;">-0.030</td>
</tr>
<tr class="odd">
<td style="text-align: left;">goal5</td>
<td style="text-align: right;">0.406</td>
<td style="text-align: right;">0.540</td>
<td style="text-align: right;">0.507</td>
<td style="text-align: right;">0.645</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.587</td>
<td style="text-align: right;">0.539</td>
<td style="text-align: right;">0.454</td>
<td style="text-align: right;">0.516</td>
<td style="text-align: right;">-0.178</td>
<td style="text-align: right;">0.620</td>
<td style="text-align: right;">-0.464</td>
<td style="text-align: right;">-0.351</td>
<td style="text-align: right;">0.191</td>
<td style="text-align: right;">0.384</td>
<td style="text-align: right;">-0.152</td>
</tr>
<tr class="even">
<td style="text-align: left;">goal6</td>
<td style="text-align: right;">0.799</td>
<td style="text-align: right;">0.638</td>
<td style="text-align: right;">0.832</td>
<td style="text-align: right;">0.748</td>
<td style="text-align: right;">0.587</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.812</td>
<td style="text-align: right;">0.670</td>
<td style="text-align: right;">0.734</td>
<td style="text-align: right;">0.137</td>
<td style="text-align: right;">0.788</td>
<td style="text-align: right;">-0.711</td>
<td style="text-align: right;">-0.529</td>
<td style="text-align: right;">0.187</td>
<td style="text-align: right;">0.599</td>
<td style="text-align: right;">-0.106</td>
</tr>
<tr class="odd">
<td style="text-align: left;">goal7</td>
<td style="text-align: right;">0.865</td>
<td style="text-align: right;">0.531</td>
<td style="text-align: right;">0.876</td>
<td style="text-align: right;">0.808</td>
<td style="text-align: right;">0.539</td>
<td style="text-align: right;">0.812</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.539</td>
<td style="text-align: right;">0.720</td>
<td style="text-align: right;">0.152</td>
<td style="text-align: right;">0.841</td>
<td style="text-align: right;">-0.704</td>
<td style="text-align: right;">-0.531</td>
<td style="text-align: right;">0.039</td>
<td style="text-align: right;">0.566</td>
<td style="text-align: right;">-0.071</td>
</tr>
<tr class="even">
<td style="text-align: left;">goal8</td>
<td style="text-align: right;">0.546</td>
<td style="text-align: right;">0.571</td>
<td style="text-align: right;">0.596</td>
<td style="text-align: right;">0.536</td>
<td style="text-align: right;">0.454</td>
<td style="text-align: right;">0.670</td>
<td style="text-align: right;">0.539</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.609</td>
<td style="text-align: right;">0.209</td>
<td style="text-align: right;">0.542</td>
<td style="text-align: right;">-0.519</td>
<td style="text-align: right;">-0.389</td>
<td style="text-align: right;">0.181</td>
<td style="text-align: right;">0.462</td>
<td style="text-align: right;">-0.099</td>
</tr>
<tr class="odd">
<td style="text-align: left;">goal9</td>
<td style="text-align: right;">0.723</td>
<td style="text-align: right;">0.530</td>
<td style="text-align: right;">0.768</td>
<td style="text-align: right;">0.696</td>
<td style="text-align: right;">0.516</td>
<td style="text-align: right;">0.734</td>
<td style="text-align: right;">0.720</td>
<td style="text-align: right;">0.609</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.300</td>
<td style="text-align: right;">0.698</td>
<td style="text-align: right;">-0.759</td>
<td style="text-align: right;">-0.689</td>
<td style="text-align: right;">0.137</td>
<td style="text-align: right;">0.591</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">goal10</td>
<td style="text-align: right;">0.272</td>
<td style="text-align: right;">0.102</td>
<td style="text-align: right;">0.223</td>
<td style="text-align: right;">0.089</td>
<td style="text-align: right;">-0.178</td>
<td style="text-align: right;">0.137</td>
<td style="text-align: right;">0.152</td>
<td style="text-align: right;">0.209</td>
<td style="text-align: right;">0.300</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.035</td>
<td style="text-align: right;">-0.297</td>
<td style="text-align: right;">-0.299</td>
<td style="text-align: right;">0.118</td>
<td style="text-align: right;">0.275</td>
<td style="text-align: right;">0.074</td>
</tr>
<tr class="odd">
<td style="text-align: left;">goal11</td>
<td style="text-align: right;">0.783</td>
<td style="text-align: right;">0.475</td>
<td style="text-align: right;">0.828</td>
<td style="text-align: right;">0.768</td>
<td style="text-align: right;">0.620</td>
<td style="text-align: right;">0.788</td>
<td style="text-align: right;">0.841</td>
<td style="text-align: right;">0.542</td>
<td style="text-align: right;">0.698</td>
<td style="text-align: right;">0.035</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">-0.729</td>
<td style="text-align: right;">-0.570</td>
<td style="text-align: right;">0.031</td>
<td style="text-align: right;">0.656</td>
<td style="text-align: right;">-0.103</td>
</tr>
<tr class="even">
<td style="text-align: left;">goal12</td>
<td style="text-align: right;">-0.730</td>
<td style="text-align: right;">-0.376</td>
<td style="text-align: right;">-0.745</td>
<td style="text-align: right;">-0.667</td>
<td style="text-align: right;">-0.464</td>
<td style="text-align: right;">-0.711</td>
<td style="text-align: right;">-0.704</td>
<td style="text-align: right;">-0.519</td>
<td style="text-align: right;">-0.759</td>
<td style="text-align: right;">-0.297</td>
<td style="text-align: right;">-0.729</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.865</td>
<td style="text-align: right;">-0.170</td>
<td style="text-align: right;">-0.666</td>
<td style="text-align: right;">0.107</td>
</tr>
<tr class="odd">
<td style="text-align: left;">goal13</td>
<td style="text-align: right;">-0.594</td>
<td style="text-align: right;">-0.322</td>
<td style="text-align: right;">-0.587</td>
<td style="text-align: right;">-0.533</td>
<td style="text-align: right;">-0.351</td>
<td style="text-align: right;">-0.529</td>
<td style="text-align: right;">-0.531</td>
<td style="text-align: right;">-0.389</td>
<td style="text-align: right;">-0.689</td>
<td style="text-align: right;">-0.299</td>
<td style="text-align: right;">-0.570</td>
<td style="text-align: right;">0.865</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">-0.150</td>
<td style="text-align: right;">-0.493</td>
<td style="text-align: right;">0.021</td>
</tr>
<tr class="even">
<td style="text-align: left;">goal15</td>
<td style="text-align: right;">0.039</td>
<td style="text-align: right;">0.154</td>
<td style="text-align: right;">0.014</td>
<td style="text-align: right;">0.007</td>
<td style="text-align: right;">0.191</td>
<td style="text-align: right;">0.187</td>
<td style="text-align: right;">0.039</td>
<td style="text-align: right;">0.181</td>
<td style="text-align: right;">0.137</td>
<td style="text-align: right;">0.118</td>
<td style="text-align: right;">0.031</td>
<td style="text-align: right;">-0.170</td>
<td style="text-align: right;">-0.150</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.191</td>
<td style="text-align: right;">-0.108</td>
</tr>
<tr class="odd">
<td style="text-align: left;">goal16</td>
<td style="text-align: right;">0.613</td>
<td style="text-align: right;">0.430</td>
<td style="text-align: right;">0.666</td>
<td style="text-align: right;">0.496</td>
<td style="text-align: right;">0.384</td>
<td style="text-align: right;">0.599</td>
<td style="text-align: right;">0.566</td>
<td style="text-align: right;">0.462</td>
<td style="text-align: right;">0.591</td>
<td style="text-align: right;">0.275</td>
<td style="text-align: right;">0.656</td>
<td style="text-align: right;">-0.666</td>
<td style="text-align: right;">-0.493</td>
<td style="text-align: right;">0.191</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">-0.099</td>
</tr>
<tr class="even">
<td style="text-align: left;">pop_affected</td>
<td style="text-align: right;">-0.066</td>
<td style="text-align: right;">-0.083</td>
<td style="text-align: right;">-0.058</td>
<td style="text-align: right;">-0.030</td>
<td style="text-align: right;">-0.152</td>
<td style="text-align: right;">-0.106</td>
<td style="text-align: right;">-0.071</td>
<td style="text-align: right;">-0.099</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.074</td>
<td style="text-align: right;">-0.103</td>
<td style="text-align: right;">0.107</td>
<td style="text-align: right;">0.021</td>
<td style="text-align: right;">-0.108</td>
<td style="text-align: right;">-0.099</td>
<td style="text-align: right;">1.000</td>
</tr>
</tbody>
</table>


</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Melt the correlation matrix for ggplot2</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>cor_melted <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">as.table</span>(correlation_matrix_Conflicts_Pop_Affected))</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(cor_melted) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Variable1"</span>, <span class="st">"Variable2"</span>, <span class="st">"Correlation"</span>)</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the heatmap</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> cor_melted, <span class="fu">aes</span>(Variable1, Variable2, <span class="at">fill =</span> Correlation)) <span class="sc">+</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient2</span>(<span class="at">low =</span> <span class="st">"blue"</span>, <span class="at">high =</span> <span class="st">"red"</span>, <span class="at">mid =</span> <span class="st">"white"</span>,</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>                       <span class="at">midpoint =</span> <span class="dv">0</span>, <span class="at">limit =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>), <span class="at">space =</span> <span class="st">"Lab"</span>,</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>                       <span class="at">name =</span> <span class="st">"Correlation"</span>) <span class="sc">+</span></span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">8</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>)) <span class="sc">+</span></span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>() <span class="sc">+</span></span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">''</span>, <span class="at">y =</span> <span class="st">''</span>,</span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">'Correlation between Conflicts Affected Population and the SDG goals'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="eda_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>