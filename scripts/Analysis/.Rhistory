label = "Goal 12",
method = "restyle"
),
list(
args = list("y", list(
~fitted(lm(goal13 ~ year, data = data_after_2015)),
~fitted(lm(goal13 ~ year, data = data_before_2016))
)),
label = "Goal 13",
method = "restyle"
),
list(
args = list("y", list(
~fitted(lm(goal15 ~ year, data = data_after_2015)),
~fitted(lm(goal15 ~ year, data = data_before_2016))
)),
label = "Goal 15",
method = "restyle"
),
list(
args = list("y", list(
~fitted(lm(goal16 ~ year, data = data_after_2015)),
~fitted(lm(goal16 ~ year, data = data_before_2016))
)),
label = "Goal 16",
method = "restyle"
),
list(
args = list("y", list(
~fitted(lm(goal17 ~ year, data = data_after_2015)),
~fitted(lm(goal17 ~ year, data = data_before_2016))
)),
label = "Goal 17",
method = "restyle"
)
)
)
)
)
graph1
View(binary2015)
binary2015 <- data_question2 %>%
group_by(code) %>%
mutate(across(5:21, ~ . - lag(.), .names = "diff_{.col}"))
View(data_question2)
# Create a new column (binary variable) with value 1 if the year is after 2015 and zero otherwise.
binary2015 <- binary2015 %>%
mutate(after2015 = ifelse(year > 2015, 1, 0)) %>%
filter(as.numeric(year)>=2009)
binary2015 <- data_question2 %>%
arrange(code, year) %>%
group_by(code) %>%
mutate(across(5:21, ~ . - lag(., order_by = year), .names = "diff_{.col}"))
binary2015 <- data_question2 %>%
arrange(code, year) %>%
group_by(code) %>%
mutate(across(6:22, ~ . - lag(., order_by = year), .names = "diff_{.col}"))
binary2015 <- data_question2 %>%
arrange(code, year) %>%
group_by(code) %>%
mutate(across(5:21, ~ . - lag(., order_by = year), .names = "diff_{.col}"))
binary2015 <- data_question2 %>%
arrange(code, year) %>%
group_by(code) %>%
mutate(across(5:21, ~ . - lag(.), .names = "diff_{.col}"))
### Question 2 analysis ###
data_question2 <- read.csv(here("scripts","data","data_question24.csv"))
View(data_question2)
# Filter data
data_after_2015 <- filter(binary2015, as.numeric(year) >= 2015)
data_before_2016 <- filter(binary2015, as.numeric(year) <= 2015)
View(data_after_2015)
graph1 <- plot_ly() %>%
add_trace(data = data_after_2015, x = ~as.numeric(year), y = ~fitted(lm(overallscore ~ year, data = data_after_2015)), type = 'scatter', mode = 'lines', line = list(color = 'blue'), name = "After 2015") %>%
add_trace(data = data_before_2016, x = ~as.numeric(year), y = ~fitted(lm(overallscore ~ year, data = data_before_2016)), type = 'scatter', mode = 'lines', line = list(color = 'red'), name = "Before 2015") %>%
layout(title = "Different patterns across SDGs before and after 2015",
xaxis = list(title = "Year"),
yaxis = list(title = "SDG achievement score", range = c(30, 85)),
shapes = list(
list(
type = 'line',
x0 = 2015,
x1 = 2015,
y0 = 0,
y1 = 1,
yref = 'paper',
line = list(color = 'grey', width = 2, dash = 'dot')
)
),
updatemenus = list(
list(
buttons = list(
list(
args = list("y", list(
~fitted(lm(overallscore ~ year, data = data_after_2015)),
~fitted(lm(overallscore ~ year, data = data_before_2016))
)),
label = "Overall score",
method = "restyle"
),
list(
args = list("y", list(
~fitted(lm(goal1 ~ year, data = data_after_2015)),
~fitted(lm(goal1 ~ year, data = data_before_2016))
)),
label = "Goal 1",
method = "restyle"
),
list(
args = list("y", list(
~fitted(lm(goal2 ~ year, data = data_after_2015)),
~fitted(lm(goal2 ~ year, data = data_before_2016))
)),
label = "Goal 2",
method = "restyle"
),
list(
args = list("y", list(
~fitted(lm(goal3 ~ year, data = data_after_2015)),
~fitted(lm(goal3 ~ year, data = data_before_2016))
)),
label = "Goal 3",
method = "restyle"
),
list(
args = list("y", list(
~fitted(lm(goal4 ~ year, data = data_after_2015)),
~fitted(lm(goal4 ~ year, data = data_before_2016))
)),
label = "Goal 4",
method = "restyle"
),
list(
args = list("y", list(
~fitted(lm(goal5 ~ year, data = data_after_2015)),
~fitted(lm(goal5 ~ year, data = data_before_2016))
)),
label = "Goal 5",
method = "restyle"
),
list(
args = list("y", list(
~fitted(lm(goal6 ~ year, data = data_after_2015)),
~fitted(lm(goal6 ~ year, data = data_before_2016))
)),
label = "Goal 6",
method = "restyle"
),
list(
args = list("y", list(
~fitted(lm(goal7 ~ year, data = data_after_2015)),
~fitted(lm(goal7 ~ year, data = data_before_2016))
)),
label = "Goal 7",
method = "restyle"
),
list(
args = list("y", list(
~fitted(lm(goal8 ~ year, data = data_after_2015)),
~fitted(lm(goal8 ~ year, data = data_before_2016))
)),
label = "Goal 8",
method = "restyle"
),
list(
args = list("y", list(
~fitted(lm(goal9 ~ year, data = data_after_2015)),
~fitted(lm(goal9 ~ year, data = data_before_2016))
)),
label = "Goal 9",
method = "restyle"
),
list(
args = list("y", list(
~fitted(lm(goal10 ~ year, data = data_after_2015)),
~fitted(lm(goal10 ~ year, data = data_before_2016))
)),
label = "Goal 10",
method = "restyle"
),
list(
args = list("y", list(
~fitted(lm(goal11 ~ year, data = data_after_2015)),
~fitted(lm(goal11 ~ year, data = data_before_2016))
)),
label = "Goal 11",
method = "restyle"
),
list(
args = list("y", list(
~fitted(lm(goal12 ~ year, data = data_after_2015)),
~fitted(lm(goal12 ~ year, data = data_before_2016))
)),
label = "Goal 12",
method = "restyle"
),
list(
args = list("y", list(
~fitted(lm(goal13 ~ year, data = data_after_2015)),
~fitted(lm(goal13 ~ year, data = data_before_2016))
)),
label = "Goal 13",
method = "restyle"
),
list(
args = list("y", list(
~fitted(lm(goal15 ~ year, data = data_after_2015)),
~fitted(lm(goal15 ~ year, data = data_before_2016))
)),
label = "Goal 15",
method = "restyle"
),
list(
args = list("y", list(
~fitted(lm(goal16 ~ year, data = data_after_2015)),
~fitted(lm(goal16 ~ year, data = data_before_2016))
)),
label = "Goal 16",
method = "restyle"
),
list(
args = list("y", list(
~fitted(lm(goal17 ~ year, data = data_after_2015)),
~fitted(lm(goal17 ~ year, data = data_before_2016))
)),
label = "Goal 17",
method = "restyle"
)
)
)
)
)
graph1
graph1 <- plot_ly() %>%
add_trace(
data = data_after_2015,
x = ~year,
y = ~fitted(lm(overallscore ~ year, data = data_after_2015)),
type = 'scatter',
mode = 'lines',
line = list(color = 'blue'),
name = "After 2015"
) %>%
add_trace(
data = data_before_2016,
x = ~year,
y = ~fitted(lm(overallscore ~ year, data = data_before_2016)),
type = 'scatter',
mode = 'lines',
line = list(color = 'red'),
name = "Before 2015"
) %>%
layout(
title = "Different patterns across SDGs before and after 2015",
xaxis = list(title = "Year"),
yaxis = list(title = "SDG achievement score", range = c(30, 85)),
shapes = list(
list(
type = 'line',
x0 = 2015,
x1 = 2015,
y0 = 0,
y1 = 1,
yref = 'paper',
line = list(color = 'grey', width = 2, dash = 'dot')
)
),
updatemenus = list(
list(
buttons = list(
list(
args = list("y", list(
~fitted(lm(overallscore ~ year, data = data_after_2015)),
~fitted(lm(overallscore ~ year, data = data_before_2016))
)),
label = "Overall score",
method = "restyle"
),
# ... (other goal-specific buttons)
)
)
)
)
graph1 <- plot_ly() %>%
add_trace(
data = data_after_2015,
x = ~year,
y = ~fitted(lm(overallscore ~ year, data = data_after_2015)),
type = 'scatter',
mode = 'lines',
line = list(color = 'blue'),
name = "After 2015"
) %>%
add_trace(
data = data_before_2016,
x = ~year,
y = ~fitted(lm(overallscore ~ year, data = data_before_2016)),
type = 'scatter',
mode = 'lines',
line = list(color = 'red'),
name = "Before 2015"
) %>%
layout(
title = "Different patterns across SDGs before and after 2015",
xaxis = list(title = "Year"),
yaxis = list(title = "SDG achievement score", range = c(30, 85)),
shapes = list(
list(
type = 'line',
x0 = 2015,
x1 = 2015,
y0 = 0,
y1 = 1,
yref = 'paper',
line = list(color = 'grey', width = 2, dash = 'dot')
)
),
updatemenus = list(
list(
buttons = list(
list(
args = list("y", list(
~fitted(lm(overallscore ~ year, data = data_after_2015)),
~fitted(lm(overallscore ~ year, data = data_before_2016))
)),
label = "Overall score",
method = "restyle"
)
# ... (other goal-specific buttons)
)
)
)
)
graph1
graph1 <- plot_ly() %>%
add_trace(
data = data_after_2015,
x = ~year,
y = ~fitted(lm(overallscore ~ year, data = data_after_2015)),
type = 'scatter',
mode = 'lines',
line = list(color = 'blue'),
name = "After 2015"
) %>%
add_trace(
data = data_before_2016,
x = ~year,
y = ~fitted(lm(overallscore ~ year, data = data_before_2016)),
type = 'scatter',
mode = 'lines',
line = list(color = 'red'),
name = "Before 2015"
) %>%
layout(
title = "Different patterns across SDGs before and after 2015",
xaxis = list(title = "Year"),
yaxis = list(title = "SDG achievement score", range = c(30, 85)),
shapes = list(
list(
type = 'line',
x0 = 2015,
x1 = 2015,
y0 = 0,
y1 = 1,
yref = 'paper',
line = list(color = 'grey', width = 2, dash = 'dot')
)
),
updatemenus = list(
list(
buttons = list(
list(
args = list("y", list(
~fitted(lm(overallscore ~ year, data = data_after_2015)),
~fitted(lm(overallscore ~ year, data = data_before_2016))
)),
label = "Overall score",
method = "restyle"
),
list(
args = list("y", list(
~fitted(lm(goal1 ~ year, data = data_after_2015)),
~fitted(lm(goal1 ~ year, data = data_before_2016))
)),
label = "Goal 1",
method = "restyle"
),
list(
args = list("y", list(
~fitted(lm(goal2 ~ year, data = data_after_2015)),
~fitted(lm(goal2 ~ year, data = data_before_2016))
)),
label = "Goal 2",
method = "restyle"
),
list(
args = list("y", list(
~fitted(lm(goal3 ~ year, data = data_after_2015)),
~fitted(lm(goal3 ~ year, data = data_before_2016))
)),
label = "Goal 3",
method = "restyle"
),
list(
args = list("y", list(
~fitted(lm(goal4 ~ year, data = data_after_2015)),
~fitted(lm(goal4 ~ year, data = data_before_2016))
)),
label = "Goal 4",
method = "restyle"
),
list(
args = list("y", list(
~fitted(lm(goal5 ~ year, data = data_after_2015)),
~fitted(lm(goal5 ~ year, data = data_before_2016))
)),
label = "Goal 5",
method = "restyle"
),
list(
args = list("y", list(
~fitted(lm(goal6 ~ year, data = data_after_2015)),
~fitted(lm(goal6 ~ year, data = data_before_2016))
)),
label = "Goal 6",
method = "restyle"
),
list(
args = list("y", list(
~fitted(lm(goal7 ~ year, data = data_after_2015)),
~fitted(lm(goal7 ~ year, data = data_before_2016))
)),
label = "Goal 7",
method = "restyle"
),
list(
args = list("y", list(
~fitted(lm(goal8 ~ year, data = data_after_2015)),
~fitted(lm(goal8 ~ year, data = data_before_2016))
)),
label = "Goal 8",
method = "restyle"
),
list(
args = list("y", list(
~fitted(lm(goal9 ~ year, data = data_after_2015)),
~fitted(lm(goal9 ~ year, data = data_before_2016))
)),
label = "Goal 9",
method = "restyle"
),
list(
args = list("y", list(
~fitted(lm(goal10 ~ year, data = data_after_2015)),
~fitted(lm(goal10 ~ year, data = data_before_2016))
)),
label = "Goal 10",
method = "restyle"
),
list(
args = list("y", list(
~fitted(lm(goal11 ~ year, data = data_after_2015)),
~fitted(lm(goal11 ~ year, data = data_before_2016))
)),
label = "Goal 11",
method = "restyle"
),
list(
args = list("y", list(
~fitted(lm(goal12 ~ year, data = data_after_2015)),
~fitted(lm(goal12 ~ year, data = data_before_2016))
)),
label = "Goal 12",
method = "restyle"
),
list(
args = list("y", list(
~fitted(lm(goal13 ~ year, data = data_after_2015)),
~fitted(lm(goal13 ~ year, data = data_before_2016))
)),
label = "Goal 13",
method = "restyle"
),
list(
args = list("y", list(
~fitted(lm(goal15 ~ year, data = data_after_2015)),
~fitted(lm(goal15 ~ year, data = data_before_2016))
)),
label = "Goal 15",
method = "restyle"
),
list(
args = list("y", list(
~fitted(lm(goal16 ~ year, data = data_after_2015)),
~fitted(lm(goal16 ~ year, data = data_before_2016))
)),
label = "Goal 16",
method = "restyle"
),
list(
args = list("y", list(
~fitted(lm(goal17 ~ year, data = data_after_2015)),
~fitted(lm(goal17 ~ year, data = data_before_2016))
)),
label = "Goal 17",
method = "restyle"
)
)
)
)
)
graph1
